[{"filePath":"/Users/taytemiz/Desktop/Lumiso/eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/jest.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/App.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/__mocks__/fileMock.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/__mocks__/styleMock.cjs","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ActivitySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/AddLeadDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/AddPaymentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/AppSidebar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/CalendarTimePicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ClientDetailsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ClientDetailsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/CreateWorkflowSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/CrmDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/DateRangePicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/DeadSimpleSessionBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/DynamicLeadFormFields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EditLeadDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EditPaymentDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EditSessionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EnhancedAddLeadDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EnhancedEditLeadDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EnhancedSessionsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/EntityHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ExitGuidanceModeButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/FilterBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/GlobalSearch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/GuidedStepProgress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/KanbanSettingsSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LanguageSwitcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/Layout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadActivitySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadFieldDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadFieldValuesDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadFieldsList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadFieldsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadInitials.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadStatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/LeadStatusesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/MobileStickyNav.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/NewServiceDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/NewSessionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/NewSessionDialogForProject.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/OfflineBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/OnboardingModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/PackagesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/PerformanceMonitor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProfessionalKanbanCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectActivitySection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectDepositDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectKanbanBoard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectPaymentsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectServicesQuickEditDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectServicesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectSheetPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectSheetView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectStagePipeline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectStatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectStatusesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectTodoList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectTodoListEnhanced.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectTypeSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectTypesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProjectsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ProtectedRoute.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ReminderCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/RestartGuidedModeButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/RoutePrefetcher.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SampleDataModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ScheduleSessionDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ServiceInventorySelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ServicePicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ServiceSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ServicesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionFormFields.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionGallery.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionSchedulingSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionSheetView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionStatusBadge.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionStatusesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionTypesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SessionsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SettingsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/SimpleProjectTypeSelect.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/TimeSlotPicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/TimezoneSelector.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/TruncatedTextWithTooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/UnifiedActivityArea.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/UnifiedClientDetails.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/UserMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ViewProjectDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/WeeklySchedulePreview.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":592,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":592,"endColumn":25}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo } from \"react\";\nimport {\n  addDays,\n  differenceInCalendarDays,\n  format,\n  parseISO,\n  startOfWeek,\n} from \"date-fns\";\nimport { useFormsTranslation } from \"@/hooks/useTypedTranslation\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\";\n\nconst MINUTES_IN_DAY = 24 * 60;\nconst PIXELS_PER_MINUTE = 0.9;\nconst MIN_BLOCK_HEIGHT = 36;\nconst MIN_VIEW_RANGE = 6 * 60;\nconst DEFAULT_DRAFT_DURATION = 60;\n\nexport interface WeeklyScheduleSession {\n  id: string;\n  session_date?: string | null;\n  session_time?: string | null;\n  duration_minutes?: number | null;\n  session_type_name?: string | null;\n  lead_name?: string | null;\n  project_name?: string | null;\n}\n\ninterface WeeklySchedulePreviewProps {\n  sessions: WeeklyScheduleSession[];\n  referenceDate: Date;\n  selectedDate?: Date;\n  selectedTime?: string;\n  selectedDurationMinutes?: number | null;\n  locale?: string;\n  showDraftSelection?: boolean;\n}\n\ninterface PositionedSession extends WeeklyScheduleSession {\n  startMinutes: number;\n  endMinutes: number;\n  columnIndex: number;\n  columnCount: number;\n  dayIndex: number;\n}\n\nconst formatTimeLabel = (minutes: number, locale: string) => {\n  const hours = Math.floor(minutes / 60);\n  const mins = minutes % 60;\n  const reference = new Date();\n  reference.setHours(hours, mins, 0, 0);\n  return new Intl.DateTimeFormat(locale, {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n  }).format(reference);\n};\n\nconst formatDurationLabel = (\n  minutes: number,\n  translate: (key: string, options?: Record<string, unknown>) => string\n) => {\n  const roundedMinutes = Math.max(Math.round(minutes), 0);\n  const hours = Math.floor(roundedMinutes / 60);\n  const remainingMinutes = roundedMinutes % 60;\n  const parts: string[] = [];\n\n  if (hours > 0) {\n    const unitKey =\n      hours === 1 ? \"sessionTypes.units.hour\" : \"sessionTypes.units.hours\";\n    parts.push(`${hours} ${translate(unitKey)}`);\n  }\n\n  if (remainingMinutes > 0 || parts.length === 0) {\n    const unitKey =\n      remainingMinutes === 1\n        ? \"sessionTypes.units.minute\"\n        : \"sessionTypes.units.minutes\";\n    parts.push(`${remainingMinutes} ${translate(unitKey)}`);\n  }\n\n  return parts.join(\" \");\n};\n\nconst parseTimeToMinutes = (time?: string | null): number | null => {\n  if (!time) return null;\n  const [hours, minutes] = time.split(\":\").map((part) => Number(part) || 0);\n  if (Number.isNaN(hours) || Number.isNaN(minutes)) return null;\n  return hours * 60 + minutes;\n};\n\nconst buildDayLayout = (\n  sessions: Array<WeeklyScheduleSession & { startMinutes: number; endMinutes: number }>\n): PositionedSession[] => {\n  const sorted = [...sessions].sort(\n    (a, b) => a.startMinutes - b.startMinutes || a.endMinutes - b.endMinutes\n  );\n\n  const active: Array<{\n    columnIndex: number;\n    endMinutes: number;\n    positioned: PositionedSession;\n  }> = [];\n  const positioned: PositionedSession[] = [];\n\n  sorted.forEach((session) => {\n    const { startMinutes, endMinutes } = session;\n\n    for (let i = active.length - 1; i >= 0; i -= 1) {\n      if (active[i].endMinutes <= startMinutes) {\n        active.splice(i, 1);\n      }\n    }\n\n    const usedColumns = new Set(active.map((item) => item.columnIndex));\n    let columnIndex = 0;\n    while (usedColumns.has(columnIndex)) {\n      columnIndex += 1;\n    }\n\n    const positionedSession: PositionedSession = {\n      ...session,\n      columnIndex,\n      columnCount: 1,\n      id: session.id,\n      dayIndex: 0,\n    };\n\n    active.push({ columnIndex, endMinutes, positioned: positionedSession });\n    active.sort((a, b) => a.endMinutes - b.endMinutes);\n\n    const overlapColumns = active.length;\n    active.forEach((item) => {\n      item.positioned.columnCount = Math.max(item.positioned.columnCount, overlapColumns);\n    });\n\n    positioned.push(positionedSession);\n  });\n\n  return positioned;\n};\n\nconst clampRange = (start: number, end: number): { start: number; end: number } => {\n  let rangeStart = Math.max(0, start);\n  let rangeEnd = Math.min(MINUTES_IN_DAY, end);\n  if (rangeEnd <= rangeStart) {\n    rangeStart = 9 * 60;\n    rangeEnd = rangeStart + MIN_VIEW_RANGE;\n  }\n  if (rangeEnd - rangeStart < MIN_VIEW_RANGE) {\n    const deficit = MIN_VIEW_RANGE - (rangeEnd - rangeStart);\n    const adjustStart = Math.max(0, rangeStart - deficit / 2);\n    const adjustEnd = Math.min(MINUTES_IN_DAY, adjustStart + MIN_VIEW_RANGE);\n    rangeStart = Math.max(0, adjustEnd - MIN_VIEW_RANGE);\n    rangeEnd = adjustEnd;\n  }\n  return { start: rangeStart, end: rangeEnd };\n};\n\nexport const WeeklySchedulePreview = ({\n  sessions,\n  referenceDate,\n  selectedDate,\n  selectedTime,\n  selectedDurationMinutes,\n  showDraftSelection = true,\n  locale = typeof navigator !== \"undefined\" ? navigator.language : \"en-US\",\n}: WeeklySchedulePreviewProps) => {\n  const { t } = useFormsTranslation();\n\n  const weekStart = useMemo(\n    () => startOfWeek(referenceDate, { weekStartsOn: 1 }),\n    [referenceDate]\n  );\n\n  const selectedDayIndex = useMemo(() => {\n    if (!selectedDate) return null;\n    return differenceInCalendarDays(selectedDate, weekStart);\n  }, [selectedDate, weekStart]);\n\n  const draftStartMinutes = useMemo(\n    () => parseTimeToMinutes(selectedTime),\n    [selectedTime]\n  );\n\n  const draftDurationMinutes = useMemo(() => {\n    if (typeof selectedDurationMinutes === \"number\" && selectedDurationMinutes > 0) {\n      return Math.min(selectedDurationMinutes, MINUTES_IN_DAY);\n    }\n    return DEFAULT_DRAFT_DURATION;\n  }, [selectedDurationMinutes]);\n\n  const isDraftWithinWeek =\n    selectedDayIndex !== null &&\n    selectedDayIndex >= 0 &&\n    selectedDayIndex <= 6 &&\n    draftStartMinutes !== null;\n\n  const draftEndMinutes = isDraftWithinWeek\n    ? Math.min(draftStartMinutes! + draftDurationMinutes, MINUTES_IN_DAY - 1)\n    : null;\n\n  const days = useMemo(\n    () =>\n      Array.from({ length: 7 }, (_, index) => ({\n        date: addDays(weekStart, index),\n        index,\n      })),\n    [weekStart]\n  );\n\n  const { dayLayouts, daySessionsMap, noTimeSessions, viewWindow } = useMemo(() => {\n    const dayMap = new Map<number, Array<WeeklyScheduleSession & { startMinutes: number; endMinutes: number }>>();\n    const noTimeMap = new Map<number, WeeklyScheduleSession[]>();\n    const startCandidates: number[] = [];\n    const endCandidates: number[] = [];\n\n    sessions.forEach((session) => {\n      if (!session.session_date) return;\n      const parsedDate = parseISO(session.session_date);\n      if (Number.isNaN(parsedDate.getTime())) return;\n      const dayIndex = differenceInCalendarDays(parsedDate, weekStart);\n      if (dayIndex < 0 || dayIndex > 6) return;\n\n    const startMinutes = parseTimeToMinutes(session.session_time);\n    const durationMinutes =\n      typeof session.duration_minutes === \"number\" && session.duration_minutes > 0\n        ? session.duration_minutes\n        : 60;\n    const safeEnd = startMinutes !== null ? startMinutes + durationMinutes : null;\n\n      if (startMinutes === null || safeEnd === null) {\n        const existing = noTimeMap.get(dayIndex) ?? [];\n        noTimeMap.set(dayIndex, [...existing, session]);\n        return;\n      }\n\n      const normalized = {\n        ...session,\n        startMinutes,\n        endMinutes: safeEnd,\n        duration_minutes: durationMinutes,\n      };\n\n      const daySessions = dayMap.get(dayIndex) ?? [];\n      dayMap.set(dayIndex, [...daySessions, normalized]);\n      startCandidates.push(startMinutes);\n      endCandidates.push(safeEnd);\n    });\n\n    if (isDraftWithinWeek && draftStartMinutes !== null && draftEndMinutes !== null) {\n      startCandidates.push(draftStartMinutes);\n      endCandidates.push(draftEndMinutes);\n    }\n\n    const rawStart = startCandidates.length ? Math.min(...startCandidates) : 9 * 60;\n    const rawEnd = endCandidates.length ? Math.max(...endCandidates) : 17 * 60;\n    const viewWindow = clampRange(rawStart, rawEnd);\n\n    const layoutsByDay = new Map<number, PositionedSession[]>();\n    dayMap.forEach((daySessions, dayIndex) => {\n      const layouts = buildDayLayout(daySessions).map((session) => ({\n        ...session,\n        dayIndex,\n      }));\n      layoutsByDay.set(dayIndex, layouts);\n    });\n\n    return {\n      dayLayouts: layoutsByDay,\n      daySessionsMap: dayMap,\n      noTimeSessions: noTimeMap,\n      viewWindow,\n    };\n  }, [\n    draftEndMinutes,\n    draftStartMinutes,\n    isDraftWithinWeek,\n    sessions,\n    weekStart,\n  ]);\n\n  const containerHeight = (viewWindow.end - viewWindow.start) * PIXELS_PER_MINUTE;\n  const hourMarkers = useMemo(() => {\n    const markers: Array<{ label: string; minute: number }> = [];\n    if (viewWindow.end <= viewWindow.start) {\n      return markers;\n    }\n    const firstMarker = Math.ceil(viewWindow.start / 60) * 60;\n    if (firstMarker > viewWindow.end) {\n      return markers;\n    }\n    for (let minute = firstMarker; minute <= viewWindow.end; minute += 60) {\n      markers.push({\n        label: formatTimeLabel(minute, locale),\n        minute,\n      });\n    }\n    return markers;\n  }, [viewWindow.end, viewWindow.start, locale]);\n\n  const hasDraftSelection = Boolean(isDraftWithinWeek);\n\n  if (!sessions.length && !hasDraftSelection) {\n    return (\n      <div className=\"rounded-xl border border-dashed border-primary/30 bg-primary/5 p-6 text-sm text-muted-foreground\">\n        {t(\"sessionScheduling.weekly_preview_empty\")}\n      </div>\n    );\n  }\n\n  return (\n    <TooltipProvider delayDuration={120}>\n    <div className=\"space-y-4\">\n      <div className=\"flex flex-wrap items-center justify-between gap-2\">\n        <h3 className=\"text-sm font-semibold tracking-tight text-slate-900\">\n          {t(\"sessionScheduling.weekly_preview_heading\")}\n        </h3>\n        <span className=\"text-xs font-medium uppercase tracking-wide text-muted-foreground\">\n          {format(weekStart, \"MMM d\")} – {format(addDays(weekStart, 6), \"MMM d\")}\n        </span>\n      </div>\n      <div className=\"overflow-hidden rounded-xl border bg-white shadow-sm\">\n        <div className=\"grid grid-cols-[72px_repeat(7,minmax(0,1fr))] border-b bg-slate-50/70 text-xs font-medium uppercase tracking-wide text-muted-foreground\">\n          <div className=\"px-3 py-2\">{t(\"sessionScheduling.weekly_preview_time_column\")}</div>\n          {days.map(({ date, index }) => (\n            <div\n              key={index}\n              className={cn(\n                \"border-l px-3 py-2 text-center first:border-l-0\",\n                selectedDayIndex === index && \"bg-primary/10 text-primary\"\n              )}\n            >\n              <div>{new Intl.DateTimeFormat(locale, { weekday: \"short\" }).format(date)}</div>\n              <div className=\"text-[11px] font-semibold text-slate-600\">\n                {new Intl.DateTimeFormat(locale, {\n                  day: \"2-digit\",\n                  month: \"2-digit\",\n                }).format(date)}\n              </div>\n            </div>\n          ))}\n        </div>\n        <div className=\"grid grid-cols-[72px_repeat(7,minmax(0,1fr))]\">\n          <div className=\"relative border-r bg-slate-50/40\">\n            <div\n              className=\"relative\"\n              style={{ height: `${containerHeight}px` }}\n            >\n              {hourMarkers.map((marker) => {\n                const offset = (marker.minute - viewWindow.start) * PIXELS_PER_MINUTE;\n                return (\n                  <div\n                    key={marker.minute}\n                    data-testid=\"weekly-hour-marker\"\n                    className=\"absolute left-0 right-0 flex items-center justify-end pr-2 text-[11px] text-muted-foreground\"\n                    style={{ top: `${offset}px` }}\n                  >\n                    {marker.label}\n                  </div>\n                );\n              })}\n          </div>\n        </div>\n          {days.map(({ index }) => {\n            const baseDaySessions = dayLayouts.get(index) ?? [];\n            const rawDaySessions = daySessionsMap.get(index) ?? [];\n            const dayNoTime = noTimeSessions.get(index) ?? [];\n            const draftStart = draftStartMinutes ?? 0;\n            const draftEnd = draftEndMinutes ?? draftStart;\n            const shouldRenderDraft =\n              showDraftSelection &&\n              hasDraftSelection &&\n              selectedDayIndex === index &&\n              draftStartMinutes !== null &&\n              draftEndMinutes !== null;\n\n            let renderedSessions = baseDaySessions;\n            let draftLayout: PositionedSession | null = null;\n\n            if (showDraftSelection) {\n              const draftSession: WeeklyScheduleSession & {\n                startMinutes: number;\n                endMinutes: number;\n              } = {\n                id: \"__draft__\",\n                session_time: selectedTime ?? null,\n                duration_minutes: draftDurationMinutes,\n                startMinutes: draftStart,\n                endMinutes: draftEnd,\n              };\n\n              const layoutWithDraft = buildDayLayout([\n                ...rawDaySessions,\n                draftSession,\n              ]).map((session) => ({\n                ...session,\n                dayIndex: index,\n              }));\n\n              draftLayout =\n                layoutWithDraft.find((session) => session.id === draftSession.id) ??\n                null;\n\n              renderedSessions = layoutWithDraft.filter(\n                (session) => session.id !== draftSession.id\n              );\n            }\n\n            const draftBlockMetrics = showDraftSelection\n              ? (() => {\n                  const top =\n                    (draftStart - viewWindow.start) * PIXELS_PER_MINUTE;\n                  const height = Math.max(\n                    (draftEnd - draftStart) * PIXELS_PER_MINUTE,\n                    MIN_BLOCK_HEIGHT\n                  );\n                  const columnCount =\n                    draftLayout?.columnCount && draftLayout.columnCount > 0\n                      ? draftLayout.columnCount\n                      : 1;\n                  const columnIndex =\n                    draftLayout?.columnIndex && draftLayout.columnIndex >= 0\n                      ? draftLayout.columnIndex\n                      : 0;\n                  const widthPercent = 100 / columnCount;\n                  const leftPercent = (columnIndex * widthPercent).toFixed(3);\n                  const widthValue = widthPercent.toFixed(3);\n                  const gutter = columnCount > 1 ? 1 : 0;\n\n                  return {\n                    top,\n                    height,\n                    left: `calc(${leftPercent}% + ${gutter}px)`,\n                    width: `calc(${widthValue}% - ${gutter * 2}px)`,\n                    startLabel: formatTimeLabel(draftStart, locale),\n                    endLabel: formatTimeLabel(draftEnd, locale),\n                  };\n                })()\n              : null;\n\n            return (\n              <div\n                key={index}\n                className={cn(\n                  \"relative border-l first:border-l-0\",\n                  selectedDayIndex === index && \"bg-primary/5\"\n                )}\n              >\n                <div\n                  className=\"relative\"\n                  style={{ height: `${containerHeight}px` }}\n                >\n                  {hourMarkers.map((marker) => {\n                    const offset = (marker.minute - viewWindow.start) * PIXELS_PER_MINUTE;\n                    return (\n                      <div\n                        key={marker.minute}\n                        className=\"absolute left-0 right-0 border-t border-dashed border-slate-200/70\"\n                        style={{ top: `${offset}px` }}\n                        aria-hidden=\"true\"\n                      />\n                    );\n                  })}\n                  {draftBlockMetrics && shouldRenderDraft ? (\n                    <div\n                      data-testid=\"weekly-draft-selection\"\n                      aria-hidden=\"true\"\n                      className=\"pointer-events-none absolute flex flex-col items-stretch text-center\"\n                      style={{\n                        top: `${draftBlockMetrics.top}px`,\n                        left: draftBlockMetrics.left,\n                        width: draftBlockMetrics.width,\n                      }}\n                    >\n                      <div\n                        className=\"rounded-xl border border-dashed border-amber-400/80 bg-amber-50/90 px-1.5 py-1 text-[10px] font-medium uppercase tracking-wide text-amber-900 shadow-none\"\n                        style={{ height: `${draftBlockMetrics.height}px` }}\n                      >\n                        <div className=\"text-[11px] capitalize tracking-normal\">\n                          {draftBlockMetrics.startLabel} – {draftBlockMetrics.endLabel}\n                        </div>\n                      </div>\n                      <div className=\"mt-1 text-[10px] font-semibold uppercase tracking-wide text-amber-700\">\n                        {t(\"sessionScheduling.weekly_preview_draft_label\")}\n                      </div>\n                    </div>\n                  ) : null}\n                  {renderedSessions.map((session) => {\n                    const topOffset =\n                      (session.startMinutes - viewWindow.start) * PIXELS_PER_MINUTE;\n                    const blockHeight = Math.max(\n                      (session.endMinutes - session.startMinutes) * PIXELS_PER_MINUTE,\n                      MIN_BLOCK_HEIGHT\n                    );\n                    const widthPercent = 100 / session.columnCount;\n                    const leftOffset = (session.columnIndex * widthPercent).toFixed(3);\n                    const widthValue = widthPercent.toFixed(3);\n                    const startLabel = formatTimeLabel(session.startMinutes, locale);\n                    const endLabel = formatTimeLabel(session.endMinutes, locale);\n                    const durationMinutes =\n                      typeof session.duration_minutes === \"number\"\n                        ? Math.max(session.duration_minutes, 0)\n                        : undefined;\n                    const formattedDuration =\n                      durationMinutes !== undefined\n                        ? formatDurationLabel(durationMinutes, t)\n                        : undefined;\n                    const gutter = session.columnCount > 1 ? 1 : 0;\n                    const tooltipDetails = [\n                      session.lead_name || t(\"sessionScheduling.unknown_client\"),\n                      session.project_name,\n                      session.session_type_name && formattedDuration\n                        ? `${session.session_type_name} • ${formattedDuration}`\n                        : formattedDuration,\n                      `${startLabel} – ${endLabel}`,\n                    ].filter(Boolean);\n                    const ariaLabel = tooltipDetails.join(\" • \");\n\n                    return (\n                      <Tooltip key={session.id}>\n                        <TooltipTrigger asChild>\n                          <div\n                            data-testid={`weekly-session-${session.id}`}\n                            aria-label={ariaLabel}\n                            className={cn(\n                              \"absolute overflow-hidden rounded-xl border border-emerald-300/80 bg-emerald-50 px-1.5 py-1.5 text-left shadow-[0_16px_28px_rgba(15,118,110,0.08)] transition-all\",\n                              \"hover:border-emerald-400 hover:bg-emerald-100/90 hover:shadow-[0_20px_34px_rgba(15,118,110,0.15)]\"\n                            )}\n                            style={{\n                              top: `${topOffset}px`,\n                              height: `${blockHeight}px`,\n                              left: `calc(${leftOffset}% + ${gutter}px)`,\n                              width: `calc(${widthValue}% - ${gutter * 2}px)`,\n                            }}\n                          >\n                            <p className=\"flex-1 break-all text-[11px] font-light leading-snug text-slate-800 line-clamp-6\">\n                              {session.lead_name || t(\"sessionScheduling.unknown_client\")}\n                            </p>\n                          </div>\n                        </TooltipTrigger>\n                        <TooltipContent className=\"max-w-xs space-y-1 text-left text-sm leading-snug\">\n                          <div className=\"font-medium text-emerald-900\">\n                            {session.lead_name || t(\"sessionScheduling.unknown_client\")}\n                          </div>\n                          {session.project_name ? (\n                            <div className=\"text-emerald-800\">{session.project_name}</div>\n                          ) : null}\n                          {formattedDuration ? (\n                            <div className=\"text-muted-foreground\">\n                              {session.session_type_name\n                                ? `${session.session_type_name} • ${formattedDuration}`\n                                : formattedDuration}\n                            </div>\n                          ) : null}\n                          <div className=\"text-xs font-medium uppercase tracking-wide text-slate-500\">\n                            {startLabel} – {endLabel}\n                          </div>\n                        </TooltipContent>\n                      </Tooltip>\n                    );\n                  })}\n                </div>\n                {dayNoTime.length > 0 && (\n                  <div className=\"border-t border-dashed border-slate-200 bg-slate-50/80 px-2 py-2 text-[11px] text-muted-foreground\">\n                    <div className=\"font-semibold uppercase tracking-wide\">\n                      {t(\"sessionScheduling.weekly_preview_time_tbd\")}\n                    </div>\n                    <ul className=\"mt-1 space-y-1\">\n                      {dayNoTime.map((session) => (\n                        <li key={session.id}>\n                          {session.lead_name || t(\"sessionScheduling.unknown_client\")}\n                        </li>\n                      ))}\n                    </ul>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      </div>\n    </div>\n    </TooltipProvider>\n  );\n};\n\nexport const __testUtils = {\n  PIXELS_PER_MINUTE,\n  MIN_BLOCK_HEIGHT,\n  clampRange,\n  parseTimeToMinutes,\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/WorkflowDeleteDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/WorkflowHealthDashboard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ActivityForm.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ActivitySection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ActivityTimeline.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ActivityTimelineItem.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/AddLeadDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/AddPaymentDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/AppSidebar.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/BaseOnboardingModal.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/CalendarTimePicker.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":96,"column":22,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":96,"endColumn":63}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen, waitFor } from \"@/utils/testUtils\";\nimport { CalendarTimePicker } from \"../CalendarTimePicker\";\n\njest.mock(\"@/components/TimeSlotPicker\", () => ({\n  TimeSlotPicker: () => <div data-testid=\"time-slot-picker\" />,\n}));\njest.mock(\"react-calendar/dist/Calendar.css\", () => ({}));\njest.mock(\"@/components/react-calendar.css\", () => ({}));\njest.mock(\"@/lib/organizationUtils\", () => ({\n  getUserOrganizationId: jest.fn(() => Promise.resolve(\"org-1\")),\n}));\njest.mock(\"@/hooks/useTypedTranslation\", () => ({\n  useFormsTranslation: () => ({ t: (key: string) => key }),\n  useCommonTranslation: () => ({ t: (key: string) => key }),\n  useMessagesTranslation: () => ({ t: (key: string) => key }),\n}));\n\nconst scrollIntoViewMock = jest.fn();\n\nbeforeAll(() => {\n  Object.defineProperty(HTMLElement.prototype, \"scrollIntoView\", {\n    configurable: true,\n    value: scrollIntoViewMock,\n  });\n\n  Object.defineProperty(window, \"matchMedia\", {\n    writable: true,\n    value: jest.fn().mockImplementation(() => ({\n      matches: false,\n      addListener: jest.fn(),\n      removeListener: jest.fn(),\n      addEventListener: jest.fn(),\n      removeEventListener: jest.fn(),\n      dispatchEvent: jest.fn(),\n    })),\n  });\n});\n\nconst eqCalls: Array<{ field: string; value: unknown }> = [];\nconst gteCalls: Array<{ field: string; value: unknown }> = [];\nconst lteCalls: Array<{ field: string; value: unknown }> = [];\n\njest.mock(\"@/integrations/supabase/client\", () => {\n  const authGetUserMock = jest.fn(() =>\n    Promise.resolve({ data: { user: { id: \"user-1\" } }, error: null })\n  );\n\nconst queryChain = {\n  eq(field: string, value: unknown) {\n    eqCalls.push({ field, value });\n    return queryChain;\n  },\n    gte(field: string, value: unknown) {\n      gteCalls.push({ field, value });\n      return queryChain;\n    },\n    lte(field: string, value: unknown) {\n      lteCalls.push({ field, value });\n      return Promise.resolve({\n        data: [\n          {\n            id: \"session-1\",\n            session_date: \"2024-05-21\",\n            session_time: \"10:00\",\n            session_type_id: \"type-1\",\n            leads: { name: \"Alex\" },\n            projects: { name: \"Wedding\" },\n            status: \"planned\",\n            session_types: { duration_minutes: 90 },\n          },\n        ],\n        error: null,\n      });\n    },\n  };\n\n  return {\n    supabase: {\n      auth: {\n        getUser: authGetUserMock,\n      },\n      from(table: string) {\n        if (table === \"sessions\") {\n          return {\n            select: () => queryChain,\n          };\n        }\n        return {\n          select: () => ({ eq: () => ({ maybeSingle: jest.fn() }) }),\n        };\n      },\n    },\n  };\n});\n\nconst { supabase } = require(\"@/integrations/supabase/client\");\nconst authGetUserMock = supabase.auth.getUser as jest.Mock;\n\nafterEach(() => {\n  jest.clearAllMocks();\n  scrollIntoViewMock.mockReset();\n  eqCalls.length = 0;\n  gteCalls.length = 0;\n  lteCalls.length = 0;\n});\n\ndescribe(\"CalendarTimePicker\", () => {\n  it(\"invokes smooth scroll when planned sessions load\", async () => {\n    const { rerender } = render(\n      <CalendarTimePicker\n        selectedDate={undefined}\n        selectedTime=\"\"\n        onDateChange={jest.fn()}\n        onTimeChange={jest.fn()}\n        onDateStringChange={jest.fn()}\n      />\n    );\n\n    await waitFor(() => expect(eqCalls.length).toBeGreaterThanOrEqual(2));\n\n    rerender(\n      <CalendarTimePicker\n        selectedDate={new Date(\"2024-05-21T00:00:00\")}\n        selectedTime=\"10:00\"\n        onDateChange={jest.fn()}\n        onTimeChange={jest.fn()}\n        onDateStringChange={jest.fn()}\n      />\n    );\n\n    await screen.findByText(/sessionScheduling.planned_sessions_on/i);\n    await screen.findByText(\"sessionScheduling.weekly_preview_heading\");\n    await waitFor(() => expect(scrollIntoViewMock).toHaveBeenCalled());\n\n    expect(authGetUserMock).toHaveBeenCalled();\n    expect(eqCalls).toEqual(\n      expect.arrayContaining([\n        { field: \"organization_id\", value: \"org-1\" },\n        { field: \"status\", value: \"planned\" },\n      ])\n    );\n    expect(gteCalls[0]?.field).toBe(\"session_date\");\n    expect(lteCalls[0]?.field).toBe(\"session_date\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/CreateWorkflowSheet.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/DeadSimpleSessionBanner.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/EditLeadDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/EditPaymentDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/EnhancedAddLeadDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/EnhancedEditLeadDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/EnhancedSessionsSection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ErrorBoundary.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":7,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":7,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[248,251],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[248,251],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { render, screen, fireEvent, waitFor } from \"@testing-library/react\";\nimport ErrorBoundary from \"../ErrorBoundary\";\n\njest.mock(\"react-i18next\", () => ({\n  withTranslation: () =>\n    (Component: React.ComponentType<any>) =>\n      function WithTranslationWrapper(props: Record<string, unknown>) {\n        return (\n          <Component\n            {...props}\n            t={(key: string, options?: Record<string, string>) =>\n              options?.reference ? `${key}:${options.reference}` : key\n            }\n          />\n        );\n      },\n}));\n\ndescribe(\"ErrorBoundary\", () => {\n  let consoleErrorSpy: jest.SpyInstance;\n  let originalClipboard: typeof navigator.clipboard;\n\n  beforeEach(() => {\n    consoleErrorSpy = jest\n      .spyOn(console, \"error\")\n      .mockImplementation(() => undefined);\n    originalClipboard = navigator.clipboard;\n    Object.assign(navigator, {\n      clipboard: {\n        writeText: jest.fn().mockResolvedValue(undefined),\n      },\n    });\n  });\n\n  afterEach(() => {\n    consoleErrorSpy.mockRestore();\n    Object.assign(navigator, { clipboard: originalClipboard });\n  });\n\n  it(\"renders children when no error occurs\", () => {\n    render(\n      <ErrorBoundary>\n        <div data-testid=\"safe-child\">Content</div>\n      </ErrorBoundary>\n    );\n\n    expect(screen.getByTestId(\"safe-child\")).toBeInTheDocument();\n    expect(consoleErrorSpy).not.toHaveBeenCalled();\n  });\n\n  it(\"renders default fallback UI when an error is thrown\", async () => {\n    const onError = jest.fn();\n\n    const ProblemChild = () => {\n      throw new Error(\"Boom\");\n    };\n\n    render(\n      <ErrorBoundary onError={onError}>\n        <ProblemChild />\n      </ErrorBoundary>\n    );\n\n    expect(await screen.findByText(\"errorBoundary.title\")).toBeInTheDocument();\n    expect(screen.getByText(\"Boom\")).toBeInTheDocument();\n    expect(screen.getByRole(\"button\", { name: \"buttons.tryAgain\" })).toBeInTheDocument();\n    expect(screen.getByRole(\"button\", { name: \"buttons.reload\" })).toBeInTheDocument();\n    expect(onError).toHaveBeenCalled();\n  });\n\n  it(\"supports providing a custom fallback component\", () => {\n    const ProblemChild = () => {\n      throw new Error(\"Boom\");\n    };\n\n    render(\n      <ErrorBoundary fallback={<div data-testid=\"custom-fallback\" />}> \n        <ProblemChild />\n      </ErrorBoundary>\n    );\n\n    expect(screen.getByTestId(\"custom-fallback\")).toBeInTheDocument();\n    expect(screen.queryByText(\"errorBoundary.title\")).not.toBeInTheDocument();\n  });\n\n  it(\"copies error details to clipboard when requested\", async () => {\n    const ProblemChild = () => {\n      throw new Error(\"Boom\");\n    };\n\n    render(\n      <ErrorBoundary>\n        <ProblemChild />\n      </ErrorBoundary>\n    );\n\n    const copyButton = await screen.findByRole(\"button\", { name: \"buttons.copy\" });\n    fireEvent.click(copyButton);\n\n    await waitFor(() => {\n      expect(navigator.clipboard.writeText).toHaveBeenCalledWith(\n        expect.stringContaining(\"Boom\")\n      );\n    });\n  });\n\n  it(\"provides contextual summary for reference errors\", async () => {\n    const ProblemChild = () => {\n      throw new ReferenceError(\"foo is not defined\");\n    };\n\n    render(\n      <ErrorBoundary>\n        <ProblemChild />\n      </ErrorBoundary>\n    );\n\n    expect(\n      await screen.findByText(\"errorBoundary.missingReference:foo\")\n    ).toBeInTheDocument();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ExitGuidanceModeButton.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/FilterBar.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/GlobalSearch.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/GuidedStepProgress.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":12,"column":94,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":12,"endColumn":97,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[449,452],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[449,452],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { act, render, screen } from \"@/utils/testUtils\";\nimport { GuidedStepProgress } from \"../GuidedStepProgress\";\nimport { useFormsTranslation } from \"@/hooks/useTypedTranslation\";\n\ntype Mocked<T> = jest.MockedFunction<T>;\n\njest.mock(\"@/hooks/useTypedTranslation\", () => ({\n  useFormsTranslation: jest.fn(),\n}));\n\ndescribe(\"GuidedStepProgress\", () => {\n  const useFormsTranslationMock: Mocked<typeof useFormsTranslation> = useFormsTranslation as any;\n  const translations = {\n    \"progress.tasks_complete\": \"tasks complete\",\n  } as const;\n\n  beforeEach(() => {\n    useFormsTranslationMock.mockReturnValue({\n      t: (key: string) => translations[key as keyof typeof translations] ?? key,\n    });\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n    jest.useRealTimers();\n  });\n\n  it(\"renders the target value immediately when animation is disabled\", () => {\n    render(\n      <GuidedStepProgress\n        currentValue={2}\n        targetValue={8}\n        totalSteps={10}\n        animate={false}\n      />\n    );\n\n    const fraction = screen.getByText((content, element) =>\n      element?.classList.contains(\"tabular-nums\") && content.replace(/\\s+/g, \"\") === \"8/10\"\n    );\n    expect(fraction).toBeInTheDocument();\n\n    const indicator = screen.getByRole(\"progressbar\").querySelector('[style*=\"translateX\"]');\n    expect(indicator).toHaveStyle({ transform: \"translateX(-20%)\" });\n  });\n\n  it(\"animates towards the target value when enabled\", () => {\n    jest.useFakeTimers({ doNotFake: [\"performance\"] });\n\n    render(\n      <GuidedStepProgress\n        currentValue={1}\n        targetValue={6}\n        totalSteps={10}\n      />\n    );\n\n    act(() => {\n      jest.runAllTimers();\n    });\n\n    const fraction = screen.getByText((content, element) =>\n      element?.classList.contains(\"tabular-nums\") && content.replace(/\\s+/g, \"\") === \"6/10\"\n    );\n    expect(fraction).toBeInTheDocument();\n\n    const indicator = screen.getByRole(\"progressbar\").querySelector('[style*=\"translateX\"]');\n    expect(indicator).toHaveStyle({ transform: \"translateX(-40%)\" });\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/LanguageSwitcher.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/LeadActivitySection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/MobileStickyNav.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/OfflineBanner.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/OnboardingModal.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/OnboardingTutorial.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/PerformanceMonitor.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProjectActivitySection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProjectKanbanBoard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProjectPaymentsSection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProjectServicesSection.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":47,"column":67,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":47,"endColumn":70,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1371,1374],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1371,1374],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render, screen, waitFor, fireEvent } from \"@/utils/testUtils\";\nimport { ProjectServicesSection } from \"@/components/ProjectServicesSection\";\nimport { supabase } from \"@/integrations/supabase/client\";\n\njest.mock(\"@/integrations/supabase/client\", () => ({\n  supabase: {\n    from: jest.fn(),\n    auth: {\n      getUser: jest.fn()\n    },\n    rpc: jest.fn()\n  }\n}));\n\nconst toastSuccess = jest.fn();\n\njest.mock(\"@/lib/toastHelpers\", () => ({\n  useI18nToast: () => ({\n    success: toastSuccess,\n    error: jest.fn()\n  })\n}));\n\nconst translations: Record<string, string> = {\n  \"services.title\": \"Services\",\n  \"services.add\": \"Add services\",\n  \"services.edit\": \"Edit services\",\n  \"services.selected_services\": \"Selected services\",\n  \"services.services_updated\": \"Services updated\",\n  \"services.cost\": \"Cost\",\n  \"services.selling\": \"Selling\",\n  \"projectDetails.services.emptyState\": \"No services yet\",\n  \"projectDetails.services.addHint\": \"Add services to get started\",\n  \"buttons.clearAll\": \"Clear All\",\n  \"common:actions.saving\": \"Saving\",\n  \"common:buttons.save\": \"Save\",\n  \"common:buttons.cancel\": \"Cancel\"\n};\n\njest.mock(\"@/hooks/useTypedTranslation\", () => ({\n  useFormsTranslation: () => ({\n    t: (key: string) => translations[key] ?? key\n  })\n}));\n\njest.mock(\"@/components/ServicePicker\", () => ({\n  ServicePicker: ({ value, onChange, isLoading, error, onRetry }: any) => (\n    <div data-testid=\"service-picker\">\n      <div data-testid=\"service-picker-value\">{value.join(\",\")}</div>\n      {isLoading && <span>Loading services…</span>}\n      {error && (\n        <>\n          <span>{error}</span>\n          <button onClick={onRetry}>Retry</button>\n        </>\n      )}\n      <button onClick={() => onChange([\"svc-2\"]) }>Choose second</button>\n    </div>\n  )\n}));\n\nconst mockProjectServices = [\n  {\n    services: {\n      id: \"svc-1\",\n      name: \"Portrait Session\",\n      category: \"Photography\",\n      cost_price: 50,\n      selling_price: 150\n    }\n  }\n];\n\nconst availableServices = [\n  {\n    id: \"svc-1\",\n    name: \"Portrait Session\",\n    category: \"Photography\",\n    cost_price: 50,\n    selling_price: 150\n  },\n  {\n    id: \"svc-2\",\n    name: \"Wedding Package\",\n    category: \"Photography\",\n    cost_price: 200,\n    selling_price: 450\n  }\n];\n\nconst insertSpy = jest.fn();\n\nbeforeEach(() => {\n  jest.clearAllMocks();\n\n  (supabase.auth.getUser as jest.Mock).mockResolvedValue({\n    data: { user: { id: \"user-1\" } }\n  });\n\n  (supabase.rpc as jest.Mock).mockResolvedValue({ data: \"org-1\" });\n\n  insertSpy.mockResolvedValue({ error: null });\n\n  (supabase.from as jest.Mock).mockImplementation((table: string) => {\n    if (table === \"project_services\") {\n      return {\n        select: jest.fn(() => ({\n          eq: jest.fn().mockResolvedValue({ data: mockProjectServices, error: null })\n        })),\n        delete: jest.fn(() => ({\n          eq: jest.fn().mockResolvedValue({ error: null })\n        })),\n        insert: insertSpy\n      };\n    }\n\n    if (table === \"services\") {\n      return {\n        select: jest.fn(() => ({\n          eq: jest.fn(() => ({\n            order: jest.fn(() => ({\n              order: jest.fn().mockResolvedValue({ data: availableServices, error: null })\n            }))\n          }))\n        }))\n      };\n    }\n\n    return {};\n  });\n});\n\nafterEach(() => {\n  jest.useRealTimers();\n});\n\nfunction renderComponent(onServicesUpdated?: jest.Mock) {\n  return render(\n    <ProjectServicesSection projectId=\"project-1\" onServicesUpdated={onServicesUpdated} />\n  );\n}\n\ntest(\"renders fetched services and toggles edit mode\", async () => {\n  renderComponent();\n\n  expect(await screen.findByText(\"Portrait Session\")).toBeInTheDocument();\n  expect(screen.getByRole(\"button\", { name: \"Edit services\" })).toBeInTheDocument();\n\n  fireEvent.click(screen.getByRole(\"button\", { name: \"Edit services\" }));\n\n  expect(await screen.findByTestId(\"service-picker\")).toBeInTheDocument();\n  expect(screen.getByTestId(\"service-picker-value\").textContent).toBe(\"svc-1\");\n\n  fireEvent.click(screen.getByRole(\"button\", { name: \"Cancel\" }));\n\n  await waitFor(() => expect(screen.queryByTestId(\"service-picker\")).not.toBeInTheDocument());\n  expect(screen.getByRole(\"button\", { name: \"Edit services\" })).toBeInTheDocument();\n});\n\ntest(\"saves updated services and shows success toast\", async () => {\n  const updatedCallback = jest.fn();\n\n  renderComponent(updatedCallback);\n\n  await screen.findByText(\"Portrait Session\");\n\n  fireEvent.click(screen.getByRole(\"button\", { name: \"Edit services\" }));\n  const saveButton = await screen.findByRole(\"button\", { name: \"Save\" });\n\n  fireEvent.click(screen.getByText(\"Choose second\"));\n\n  fireEvent.click(saveButton);\n\n  await waitFor(() => {\n    expect(insertSpy).toHaveBeenCalledWith([\n      {\n        project_id: \"project-1\",\n        service_id: \"svc-2\",\n        user_id: \"user-1\"\n      }\n    ]);\n  });\n\n  await waitFor(() => expect(toastSuccess).toHaveBeenCalledWith(\"Services updated\"));\n  expect(updatedCallback).toHaveBeenCalled();\n\n  await waitFor(() => expect(screen.queryByTestId(\"service-picker\")).not.toBeInTheDocument());\n  expect(screen.getByRole(\"button\", { name: \"Edit services\" })).toBeInTheDocument();\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProjectSheetPreview.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProjectSheetView.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ProtectedRoute.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ReminderCard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/RestartGuidedModeButton.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/RoutePrefetcher.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SampleDataModal.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ScheduleSessionDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/ServiceInventorySelector.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SessionBanner.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":16,"column":48,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":16,"endColumn":51,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[537,540],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[537,540],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { fireEvent, render, screen } from \"@/utils/testUtils\";\nimport SessionBanner from \"../SessionBanner\";\nimport { useFormsTranslation } from \"@/hooks/useTypedTranslation\";\nimport { useSessionActions } from \"@/hooks/useSessionActions\";\n\njest.mock(\"@/hooks/useTypedTranslation\", () => ({\n  useFormsTranslation: jest.fn(),\n}));\n\njest.mock(\"@/hooks/useSessionActions\", () => ({\n  useSessionActions: jest.fn(),\n}));\n\njest.mock(\"@/components/SessionStatusBadge\", () => ({\n  __esModule: true,\n  default: ({ currentStatus, onStatusChange }: any) => (\n    <button\n      data-testid=\"session-status-badge\"\n      onClick={() => onStatusChange?.(\"completed\")}\n    >\n      Status: {currentStatus}\n    </button>\n  ),\n}));\n\ndescribe(\"SessionBanner\", () => {\n  const mockUpdateSessionStatus = jest.fn();\n\n  beforeAll(() => {\n    Object.defineProperty(window.navigator, \"language\", {\n      configurable: true,\n      value: \"en-US\",\n    });\n  });\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    (useFormsTranslation as jest.Mock).mockReturnValue({\n      t: (key: string) => key,\n    });\n    (useSessionActions as jest.Mock).mockReturnValue({\n      updateSessionStatus: mockUpdateSessionStatus,\n    });\n  });\n\n  it(\"renders planned session details and triggers callbacks\", () => {\n    const onStatusUpdate = jest.fn();\n    const onEdit = jest.fn();\n    const onDelete = jest.fn();\n\n    render(\n      <SessionBanner\n        session={{\n          id: \"session-1\",\n          session_date: \"2024-05-15\",\n          session_time: \"14:30\",\n          notes: \"Bring props\",\n          status: \"planned\",\n        }}\n        leadName=\"Jamie Doe\"\n        projectName=\"Project Phoenix\"\n        onStatusUpdate={onStatusUpdate}\n        onEdit={onEdit}\n        onDelete={onDelete}\n      />\n    );\n\n    expect(screen.getByText(\"sessions.photoSession\")).toBeInTheDocument();\n    expect(\n      screen.getByText(/sessions\\.projectLabel: Project Phoenix/)\n    ).toBeInTheDocument();\n    expect(screen.getByText(\"Wed, May 15, 2024\")).toBeInTheDocument();\n    expect(\n      screen.getByText((content) => content.trim() === \"02:30 PM\")\n    ).toBeInTheDocument();\n    expect(screen.getByText(/\"Bring props\"/)).toBeInTheDocument();\n\n    fireEvent.click(screen.getByTestId(\"session-status-badge\"));\n    expect(onStatusUpdate).toHaveBeenCalledWith(\"completed\");\n\n    const editButton = screen\n      .getAllByRole(\"button\")\n      .find((button) => button.querySelector('.lucide-square-pen'));\n    expect(editButton).toBeDefined();\n    fireEvent.click(editButton!);\n    expect(onEdit).toHaveBeenCalled();\n\n    const deleteButton = screen\n      .getAllByRole(\"button\")\n      .find((button) => button.querySelector('.lucide-trash2'));\n    expect(deleteButton).toBeDefined();\n    fireEvent.click(deleteButton!);\n    expect(onDelete).toHaveBeenCalled();\n  });\n\n  it(\"disables edit when session is not planned\", () => {\n    const onEdit = jest.fn();\n\n    render(\n      <SessionBanner\n        session={{\n          id: \"session-2\",\n          session_date: \"2024-06-01\",\n          session_time: \"09:00\",\n          notes: \"\",\n          status: \"completed\",\n        }}\n        leadName=\"Jamie Doe\"\n        onEdit={onEdit}\n        showActions\n      />\n    );\n\n    expect(\n      screen.getByText(\"This session has been marked as completed\")\n    ).toBeInTheDocument();\n\n    const editButton = screen\n      .getAllByRole(\"button\")\n      .find((button) => button.querySelector('.lucide-square-pen'));\n    expect(editButton).toBeDefined();\n    expect(editButton).toBeDisabled();\n    fireEvent.click(editButton!);\n    expect(onEdit).not.toHaveBeenCalled();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SessionFormFields.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SessionSchedulingSheet.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":11,"column":20,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":11,"endColumn":58}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { render } from \"@testing-library/react\";\nimport { SessionSchedulingSheet } from \"../SessionSchedulingSheet\";\n\njest.mock(\"@/features/session-planning\", () => {\n  const mock = jest.fn(() => <div data-testid=\"session-planning-wizard\" />);\n  return {\n    SessionPlanningWizardSheet: mock,\n  };\n});\n\nconst WizardMock = require(\"@/features/session-planning\").SessionPlanningWizardSheet as jest.Mock;\n\ndescribe(\"SessionSchedulingSheet\", () => {\n  beforeEach(() => {\n    WizardMock.mockClear();\n  });\n\n  it(\"renders the session planning wizard with derived entry source\", () => {\n    render(\n      <SessionSchedulingSheet\n        leadId=\"lead-1\"\n        leadName=\"Taylor\"\n        projectId=\"proj-1\"\n        projectName=\"Project\"\n        isOpen\n        onOpenChange={jest.fn()}\n        onSessionScheduled={jest.fn()}\n      />\n    );\n\n    expect(WizardMock).toHaveBeenCalledWith(\n      expect.objectContaining({\n        leadId: \"lead-1\",\n        leadName: \"Taylor\",\n        projectId: \"proj-1\",\n        projectName: \"Project\",\n        entrySource: \"project\",\n        isOpen: true,\n      }),\n      {}\n    );\n  });\n\n  it(\"falls back to lead entry source when no project is provided\", () => {\n    render(\n      <SessionSchedulingSheet\n        leadId=\"lead-2\"\n        leadName=\"Alex\"\n        isOpen={false}\n        onOpenChange={jest.fn()}\n      />\n    );\n\n    expect(WizardMock).toHaveBeenCalledWith(\n      expect.objectContaining({\n        entrySource: \"lead\",\n        isOpen: false,\n      }),\n      {}\n    );\n  });\n\n  it(\"forwards a start step override to the wizard\", () => {\n    render(\n      <SessionSchedulingSheet\n        leadId=\"lead-3\"\n        leadName=\"Casey\"\n        isOpen\n        onOpenChange={jest.fn()}\n        startStep=\"schedule\"\n      />\n    );\n\n    expect(WizardMock).toHaveBeenCalledWith(\n      expect.objectContaining({\n        startStepOverride: \"schedule\",\n      }),\n      {}\n    );\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SessionStatusBadge.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SessionTypesSection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/SessionsSection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/TimeSlotPicker.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":14,"column":29,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":14,"endColumn":63}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { fireEvent, render, screen } from \"@/utils/testUtils\";\nimport { TimeSlotPicker } from \"../TimeSlotPicker\";\n\njest.mock(\"@/hooks/useWorkingHours\", () => ({\n  useWorkingHours: jest.fn(),\n}));\n\njest.mock(\"@/hooks/useTypedTranslation\", () => ({\n  useFormsTranslation: () => ({ t: (key: string) => key }),\n  useCommonTranslation: () => ({ t: (key: string) => key }),\n  useMessagesTranslation: () => ({ t: (key: string) => key }),\n}));\n\nconst mockUseWorkingHours = require(\"@/hooks/useWorkingHours\").useWorkingHours as jest.Mock;\n\nbeforeAll(() => {\n  Object.defineProperty(window.navigator, \"language\", {\n    value: \"en-US\",\n    configurable: true,\n  });\n});\n\nbeforeEach(() => {\n  mockUseWorkingHours.mockReturnValue({\n    loading: false,\n    workingHours: [\n      {\n        day_of_week: 2,\n        enabled: true,\n        start_time: \"09:00\",\n        end_time: \"11:00\",\n      },\n    ],\n  });\n});\n\nafterEach(() => {\n  jest.clearAllMocks();\n});\n\ndescribe(\"TimeSlotPicker\", () => {\n  it(\"renders available time slots centered with soft hover\", () => {\n    const handleSelect = jest.fn();\n    const selectedDate = new Date(\"2024-05-21T00:00:00\"); // Tuesday (day_of_week = 2)\n\n    render(\n      <TimeSlotPicker\n        selectedDate={selectedDate}\n        selectedTime=\"09:00\"\n        onTimeSelect={handleSelect}\n      />\n    );\n\n    const buttons = screen.getAllByRole(\"button\");\n    expect(buttons.length).toBeGreaterThan(1);\n    const selectedButton = buttons[0];\n    const hoverButton = buttons[1];\n    expect(selectedButton.className).toContain(\"justify-center\");\n    expect(selectedButton.className).toContain(\"text-center\");\n    expect(hoverButton.className).toContain(\"hover:bg-primary/10\");\n\n    fireEvent.click(hoverButton);\n    expect(handleSelect).toHaveBeenCalledWith(expect.any(String));\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/TimezoneSelector.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/TruncatedTextWithTooltip.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[688,691],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[688,691],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { act, render, screen, waitFor } from \"@testing-library/react\";\nimport userEvent from \"@testing-library/user-event\";\nimport { TruncatedTextWithTooltip } from \"../TruncatedTextWithTooltip\";\n\ndescribe(\"TruncatedTextWithTooltip\", () => {\n  let originalRAF: typeof window.requestAnimationFrame;\n  let originalCancelRAF: typeof window.cancelAnimationFrame;\n  let resizeObserverMock: jest.Mock;\n\n  beforeEach(() => {\n    originalRAF = window.requestAnimationFrame;\n    originalCancelRAF = window.cancelAnimationFrame;\n    resizeObserverMock = jest.fn().mockImplementation(() => ({\n      observe: jest.fn(),\n      disconnect: jest.fn(),\n    }));\n    (window as any).ResizeObserver = resizeObserverMock;\n  });\n\n  afterEach(() => {\n    window.requestAnimationFrame = originalRAF;\n    window.cancelAnimationFrame = originalCancelRAF;\n  });\n\n  it(\"returns null when no text provided\", () => {\n    const { container } = render(<TruncatedTextWithTooltip text=\"\" />);\n    expect(container.firstChild).toBeNull();\n  });\n\n  it(\"does not render tooltip content when text fits\", async () => {\n    let frameCallback: FrameRequestCallback | null = null;\n    window.requestAnimationFrame = (callback: FrameRequestCallback) => {\n      frameCallback = callback;\n      return 1 as unknown as number;\n    };\n    window.cancelAnimationFrame = jest.fn();\n\n    const user = userEvent.setup();\n    render(<TruncatedTextWithTooltip text=\"Visible\" delayDuration={0} />);\n\n    const textElement = screen.getByText(\"Visible\");\n    Object.defineProperty(textElement, \"scrollHeight\", { value: 20, configurable: true });\n    Object.defineProperty(textElement, \"clientHeight\", { value: 20, configurable: true });\n    Object.defineProperty(textElement, \"scrollWidth\", { value: 20, configurable: true });\n    Object.defineProperty(textElement, \"clientWidth\", { value: 20, configurable: true });\n\n    await act(async () => {\n      frameCallback?.(performance.now());\n    });\n\n    await user.hover(textElement);\n\n    await waitFor(() => {\n      expect(screen.getAllByText(\"Visible\")).toHaveLength(1);\n    });\n  });\n\n  it(\"renders tooltip content when text is truncated\", async () => {\n    let frameCallback: FrameRequestCallback | null = null;\n    window.requestAnimationFrame = (callback: FrameRequestCallback) => {\n      frameCallback = callback;\n      return 1 as unknown as number;\n    };\n    window.cancelAnimationFrame = jest.fn();\n\n    const user = userEvent.setup();\n    render(\n      <TruncatedTextWithTooltip\n        text=\"This is a very long piece of text\"\n        lines={1}\n        delayDuration={0}\n      />\n    );\n\n    const textElement = screen.getByText(\"This is a very long piece of text\");\n    Object.defineProperty(textElement, \"scrollHeight\", { value: 120, configurable: true });\n    Object.defineProperty(textElement, \"clientHeight\", { value: 20, configurable: true });\n    Object.defineProperty(textElement, \"scrollWidth\", { value: 200, configurable: true });\n    Object.defineProperty(textElement, \"clientWidth\", { value: 100, configurable: true });\n\n    await act(async () => {\n      frameCallback?.(performance.now());\n    });\n\n    await user.hover(textElement);\n\n    const occurrences = await screen.findAllByText(\"This is a very long piece of text\");\n    expect(occurrences.length).toBeGreaterThan(1);\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/TutorialExitGuardDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/TutorialFloatingCard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/UnifiedClientDetails.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/UserMenu.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/WeeklySchedulePreview.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/WorkflowDeleteDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/__tests__/WorkflowHealthDashboard.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":47,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":50,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[392,395],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[392,395],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { fireEvent, render, screen } from \"@/utils/testUtils\";\nimport { WorkflowHealthDashboard } from \"../WorkflowHealthDashboard\";\nimport { useWorkflowHealth } from \"@/hooks/useWorkflowHealth\";\n\njest.mock(\"@/hooks/useWorkflowHealth\", () => ({\n  useWorkflowHealth: jest.fn(),\n}));\n\njest.mock(\"react-i18next\", () => ({\n  useTranslation: () => ({\n    t: (key: string, options?: Record<string, any>, defaultValue?: string) => {\n      const translations: Record<string, string> = {\n        \"workflows.health.unableToLoad\": \"Unable to load\",\n        \"workflows.health.status.title\": \"Workflow health\",\n        \"workflows.health.status.description\": \"Monitor your automations\",\n        \"workflows.health.status.labels.healthy\": \"Healthy\",\n        \"workflows.health.status.labels.warning\": \"Warning\",\n        \"workflows.health.status.labels.critical\": \"Critical\",\n        \"workflows.health.critical.title\": \"Critical issues detected\",\n        \"workflows.health.warning.title\": \"Needs attention\",\n        \"workflows.health.actions.cleanup\": \"Clean up stuck runs\",\n        \"workflows.health.actions.refresh\": \"Refresh\",\n        \"workflows.health.actions.systemTitle\": \"System actions\",\n        \"workflows.health.actions.systemDescription\": \"Keep workflows humming\",\n        \"workflows.health.metrics.totalWorkflows\": \"Total workflows\",\n        \"workflows.health.metrics.successRate\": \"Success rate\",\n        \"workflows.health.metrics.recentExecutions\": \"Recent executions\",\n        \"workflows.health.metrics.averageExecutionTime\": \"Avg execution time\",\n        \"workflows.health.metrics.dailyTitle\": \"Daily performance\",\n        \"workflows.health.metrics.dailyDescription\": \"Per-day stats\",\n        \"workflows.health.metrics.successRateSubtitle\": \"Success over last 7 days\",\n        \"workflows.health.metrics.recentExecutionsSubtitle\": \"Runs in the last 24h\",\n        \"workflows.health.metrics.averageExecutionTimeSubtitle\": \"Average time per workflow\",\n      };\n\n      switch (key) {\n        case \"workflows.health.metrics.totalSubtitle\":\n          return `Active ${options?.active} · Paused ${options?.paused}`;\n        case \"workflows.health.metrics.dailyTotal\":\n          return `Total ${options?.count}`;\n        case \"workflows.health.metrics.dailySuccess\":\n          return `Success ${options?.rate}%`;\n        case \"workflows.health.metrics.dailyAverage\":\n          return `Avg ${options?.time}`;\n        case \"workflows.health.critical.stuckExecutions\":\n          return `Stuck ${options?.count}`;\n        case \"workflows.health.critical.lowSuccessRate\":\n          return `Low success ${options?.rate}%`;\n        case \"common:abbreviations.notAvailable\":\n          return defaultValue ?? \"N/A\";\n        default:\n          return translations[key] ?? key;\n      }\n    },\n  }),\n}));\n\ndescribe(\"WorkflowHealthDashboard\", () => {\n  const useWorkflowHealthMock = useWorkflowHealth as jest.Mock;\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it(\"renders loading skeleton while data is fetching\", () => {\n    useWorkflowHealthMock.mockReturnValue({\n      loading: true,\n      health: null,\n    });\n\n    const { container } = render(<WorkflowHealthDashboard />);\n\n    expect(container.querySelectorAll(\".animate-pulse\")).toHaveLength(4);\n  });\n\n  it(\"shows empty state when health is unavailable\", () => {\n    useWorkflowHealthMock.mockReturnValue({\n      loading: false,\n      health: null,\n    });\n\n    render(<WorkflowHealthDashboard />);\n\n    expect(screen.getByText(\"Unable to load\")).toBeInTheDocument();\n  });\n\n  it(\"displays critical health details and triggers actions\", () => {\n    const cleanupStuckExecutions = jest.fn();\n    const refetch = jest.fn();\n\n    useWorkflowHealthMock.mockReturnValue({\n      loading: false,\n      health: {\n        totalWorkflows: 12,\n        activeWorkflows: 6,\n        pausedWorkflows: 6,\n        successRate: 72.3,\n        recentExecutions: 45,\n        averageExecutionTime: 185,\n        stuckExecutions: 3,\n        metrics: [\n          {\n            id: \"metric-1\",\n            date: \"2024-10-24T00:00:00Z\",\n            total_executions: 20,\n            successful_executions: 14,\n            average_execution_time_ms: 210,\n          },\n        ],\n      },\n      cleanupStuckExecutions,\n      getHealthIcon: () => <span data-testid=\"health-icon\">!</span>,\n      getHealthStatus: () => \"critical\",\n      refetch,\n    });\n\n    render(<WorkflowHealthDashboard />);\n\n    expect(screen.getByText(\"Critical\")).toBeInTheDocument();\n    expect(screen.getByText(\"Stuck 3\")).toBeInTheDocument();\n    expect(screen.getByText(\"Low success 72.3%\"))\n      .toBeInTheDocument();\n    expect(screen.getByText(\"Active 6 · Paused 6\")).toBeInTheDocument();\n    expect(screen.getByText(\"Success 70.0%\"))\n      .toBeInTheDocument();\n    expect(screen.getByText(\"Avg 210\"))\n      .toBeInTheDocument();\n\n    const cleanupButtons = screen.getAllByText(\"Clean up stuck runs\");\n    cleanupButtons.forEach((button) => fireEvent.click(button));\n    fireEvent.click(screen.getByText(\"Refresh\"));\n\n    expect(cleanupStuckExecutions).toHaveBeenCalledTimes(2);\n    expect(refetch).toHaveBeenCalledTimes(1);\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/admin/AdminLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/CalendarDay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/CalendarDayView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/CalendarErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/CalendarMonthView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/CalendarSkeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/CalendarWeek.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/__tests__/CalendarDay.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/__tests__/CalendarDayView.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/__tests__/CalendarErrorBoundary.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/__tests__/CalendarMonthView.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/__tests__/CalendarSkeleton.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/calendar/__tests__/CalendarWeek.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/common/ErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/AdvancedDataTable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/AdvancedDataTablePagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/TableSearchInput.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/__tests__/AdvancedDataTable.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/__tests__/TableSearchInput.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/__tests__/useAdvancedTableSearch.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/__tests__/useDraftFilters.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/useAdvancedTableSearch.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/data-table/useDraftFilters.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/CustomFieldDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/CustomFieldDisplayWithEmpty.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldCheckboxDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldDateDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldEmailDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldMultiSelectDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldNumberDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldPhoneDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldSelectDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldTextDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldTextTableDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldTextareaDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/FieldTextareaTableDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/InlineEditField.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineCheckboxEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineDateEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineEmailEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineMultiSelectEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineNumberEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlinePhoneEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineSelectEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineTextEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/fields/inline-editors/InlineTextareaEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/layout-primitives/Surface.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/layout-primitives/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/leadInitialsUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/mobile/BottomSheetMenu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/mobile/MobileBottomNav.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":91,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":91,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2756,2759],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2756,2759],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { NavLink, useLocation, useNavigate } from 'react-router-dom';\nimport { \n  LayoutDashboard, \n  Users, \n  FolderOpen, \n  CalendarRange, \n  MoreHorizontal,\n  Calendar,\n  CalendarDays,\n  Bell,\n  BarChart3,\n  CreditCard,\n  Settings,\n  LogOut,\n  User,\n  HelpCircle,\n  Zap,\n  FileText\n} from 'lucide-react';\nimport { BottomSheetMenu } from './BottomSheetMenu';\nimport { cn } from '@/lib/utils';\nimport { supabase } from '@/integrations/supabase/client';\nimport { toast } from '@/hooks/use-toast';\nimport { useProfile } from '@/hooks/useProfile';\nimport { HelpModal } from '@/components/modals/HelpModal';\nimport { UserMenu } from '@/components/UserMenu';\n\ninterface NavTab {\n  title: string;\n  icon: React.ComponentType<{ className?: string }>;\n  path?: string;\n  action?: () => void;\n  badge?: number;\n}\n\nexport function MobileBottomNav({ hideForOnboarding = false }: { hideForOnboarding?: boolean }) {\n  const [bookingsOpen, setBookingsOpen] = useState(false);\n  const [automationOpen, setAutomationOpen] = useState(false);\n  const [moreOpen, setMoreOpen] = useState(false);\n  const [helpOpen, setHelpOpen] = useState(false);\n  const [isVisible, setIsVisible] = useState(true);\n  const [userEmail, setUserEmail] = useState<string>(\"\");\n  const location = useLocation();\n  const navigate = useNavigate();\n  const { profile } = useProfile();\n\n  // Get user email from auth\n  useEffect(() => {\n    const getUser = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user?.email) {\n        setUserEmail(user.email);\n      }\n    };\n    getUser();\n  }, []);\n\n  // Hide on auth routes, keyboard open, and during onboarding\n  useEffect(() => {\n    const isAuthRoute = location.pathname === '/auth';\n    \n    const handleResize = () => {\n      // Hide when keyboard is likely open (viewport height reduced significantly)\n      const isKeyboardOpen = window.visualViewport \n        ? window.visualViewport.height < window.innerHeight * 0.75\n        : false;\n      \n      setIsVisible(!isAuthRoute && !isKeyboardOpen && !hideForOnboarding);\n    };\n\n    handleResize();\n    window.addEventListener('resize', handleResize);\n    if (window.visualViewport) {\n      window.visualViewport.addEventListener('resize', handleResize);\n    }\n\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      if (window.visualViewport) {\n        window.visualViewport.removeEventListener('resize', handleResize);\n      }\n    };\n  }, [location.pathname, hideForOnboarding]);\n\n  const handleSignOut = async () => {\n    if (window.confirm('Are you sure you want to sign out?')) {\n      try {\n        await supabase.auth.signOut();\n        navigate('/auth');\n      } catch (error: any) {\n        toast({\n          title: \"Error signing out\",\n          description: error.message,\n          variant: \"destructive\"\n        });\n      }\n    }\n  };\n\n  const scrollToTop = () => {\n    window.scrollTo({ top: 0, behavior: 'smooth' });\n  };\n\n  const tabs: NavTab[] = [\n    { title: 'Dashboard', icon: LayoutDashboard, path: '/' },\n    { title: 'Leads', icon: Users, path: '/leads' },\n    { title: 'Projects', icon: FolderOpen, path: '/projects' },\n    { title: 'Bookings', icon: CalendarRange, action: () => setBookingsOpen(true) },\n    { title: 'More', icon: MoreHorizontal, action: () => setMoreOpen(true) }\n  ];\n\n  const bookingItems = [\n    {\n      title: 'Calendar',\n      icon: CalendarDays,\n      onClick: () => navigate('/calendar')\n    },\n    {\n      title: 'Sessions',\n      icon: Calendar,\n      onClick: () => navigate('/sessions')\n    },\n    {\n      title: 'Reminders',\n      icon: Bell,\n      onClick: () => navigate('/reminders')\n    }\n  ];\n\n  const automationItems = [\n    {\n      title: 'Workflows',\n      icon: BarChart3,\n      onClick: () => navigate('/workflows')\n    },\n    {\n      title: 'Templates',\n      icon: FileText,\n      onClick: () => navigate('/templates')\n    }\n  ];\n\n  const moreItems = [\n    {\n      title: 'Analytics',\n      icon: BarChart3,\n      onClick: () => navigate('/analytics')\n    },\n    {\n      title: 'Automation',\n      icon: Zap,\n      onClick: () => setAutomationOpen(true)\n    },\n    {\n      title: 'Payments',\n      icon: CreditCard,\n      onClick: () => navigate('/payments')\n    },\n    {\n      title: 'Settings',\n      icon: Settings,\n      onClick: () => navigate('/settings'),\n      testId: 'mobile-settings'\n    },\n    {\n      title: 'Help & Support',\n      icon: HelpCircle,\n      onClick: () => setHelpOpen(true)\n    },\n    {\n      title: 'Sign Out',\n      icon: LogOut,\n      onClick: handleSignOut,\n      variant: 'destructive' as const\n    }\n  ];\n\n  const isActive = (path: string) => {\n    if (path === '/') {\n      return location.pathname === '/';\n    }\n    return location.pathname.startsWith(path);\n  };\n\n  const isBookingsActive = ['/calendar', '/sessions', '/reminders'].some(path =>\n    location.pathname.startsWith(path)\n  );\n\n  const isAutomationActive = ['/workflows', '/templates'].some(path =>\n    location.pathname.startsWith(path)\n  );\n\n  const isMoreActive = ['/analytics', '/payments', '/settings'].some(path =>\n    location.pathname.startsWith(path)\n  ) || isAutomationActive;\n\n  if (!isVisible) return null;\n\n  return (\n    <>\n      <nav \n        className=\"md:hidden fixed bottom-0 left-0 right-0 z-50 bg-background/90 backdrop-blur-md border-t supports-[backdrop-filter]:bg-background/50 mobile-bottom-nav\"\n        style={{ \n          paddingBottom: 'max(env(safe-area-inset-bottom), 8px)',\n          position: 'fixed',\n          bottom: 0,\n        }}\n      >\n        <div className=\"flex items-center justify-around px-2 py-2\">\n          {tabs.map((tab, index) => {\n            const Icon = tab.icon;\n            let active = false;\n            \n            if (tab.path) {\n              active = isActive(tab.path);\n            } else if (tab.title === 'Bookings') {\n              active = isBookingsActive;\n            } else if (tab.title === 'More') {\n              active = isMoreActive;\n            }\n\n            const handleTabPress = () => {\n              if (tab.path) {\n                if (active) {\n                  scrollToTop();\n                } else {\n                  navigate(tab.path);\n                }\n              } else if (tab.action) {\n                tab.action();\n              }\n            };\n\n            return (\n              <button\n                key={index}\n                onClick={handleTabPress}\n                data-walkthrough={tab.title === 'More' ? 'mobile-more-tab' : undefined}\n                className={cn(\n                  \"flex flex-col items-center justify-center min-h-[44px] px-2 py-1 rounded-lg transition-colors relative\",\n                  \"hover:bg-muted/50 active:bg-muted\"\n                )}\n              >\n                <Icon \n                  className={cn(\n                    \"h-5 w-5 mb-1\",\n                    active ? \"text-primary\" : \"text-muted-foreground\"\n                  )} \n                />\n                <span \n                  className={cn(\n                    \"text-[10px] font-medium leading-tight\",\n                    active ? \"text-primary\" : \"text-muted-foreground\"\n                  )}\n                >\n                  {tab.title}\n                </span>\n                \n                {tab.badge && tab.badge > 0 && (\n                  <div className=\"absolute -top-1 -right-1 bg-destructive text-destructive-foreground text-[10px] font-bold rounded-full h-4 w-4 flex items-center justify-center\">\n                    {tab.badge > 9 ? '9+' : tab.badge}\n                  </div>\n                )}\n              </button>\n            );\n          })}\n        </div>\n      </nav>\n\n      <BottomSheetMenu\n        title=\"Bookings\"\n        isOpen={bookingsOpen}\n        onOpenChange={setBookingsOpen}\n        items={bookingItems}\n      />\n\n      <BottomSheetMenu\n        title=\"Automation\"\n        isOpen={automationOpen}\n        onOpenChange={setAutomationOpen}\n        items={automationItems}\n      />\n\n      <BottomSheetMenu\n        title=\"More\"\n        isOpen={moreOpen}\n        onOpenChange={setMoreOpen}\n        items={moreItems}\n        customContent={\n          <div className=\"mt-4 border-t pt-4\">\n            <UserMenu \n              variant=\"mobile\" \n              onNavigate={() => setMoreOpen(false)} \n            />\n          </div>\n        }\n      />\n\n      <HelpModal \n        isOpen={helpOpen} \n        onOpenChange={setHelpOpen} \n      />\n    </>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/mobile/__tests__/BottomSheetMenu.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/mobile/__tests__/MobileBottomNav.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/modals/HelpModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/modals/__tests__/HelpModal.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/navigation/StickySectionNav.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":50,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":50,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useMemo, useRef, useState } from \"react\";\nimport { cn } from \"@/lib/utils\";\n\nexport interface StickySectionNavItem {\n  id: string;\n  title: string;\n  onSelect?: () => void;\n}\n\nexport interface StickySectionNavProps {\n  items: StickySectionNavItem[];\n  stickyTopOffset?: number;\n  align?: \"start\" | \"center\" | \"end\";\n  ariaLabel?: string;\n  className?: string;\n  navClassName?: string;\n  observeIds?: string[];\n  onActiveChange?: (id: string) => void;\n  fallbackActiveId?: string;\n  scrollBehavior?: ScrollBehavior;\n  disableSticky?: boolean;\n}\n\nconst ALIGN_CLASSNAMES: Record<NonNullable<StickySectionNavProps[\"align\"]>, string> = {\n  start: \"justify-start\",\n  center: \"justify-center\",\n  end: \"justify-end\"\n};\n\nconst BASE_NAV_BUTTON_CLASSES = [\n  \"flex-shrink-0\",\n  \"whitespace-nowrap\",\n  \"rounded-full\",\n  \"border\",\n  \"px-3\",\n  \"py-1.5\",\n  \"text-sm\",\n  \"font-medium\",\n  \"transition-colors\",\n  \"focus-visible:outline-none\",\n  \"focus-visible:ring-2\",\n  \"focus-visible:ring-offset-2\",\n  \"focus-visible:ring-primary\"\n].join(\" \");\n\nconst ACTIVE_NAV_CLASSES = \"border-primary/50 bg-primary/10 text-primary shadow-sm\";\nconst INACTIVE_NAV_CLASSES =\n  \"border-transparent bg-muted/20 text-muted-foreground hover:bg-muted/30 hover:text-foreground\";\n\nexport const STICKY_NAV_CLASSES = {\n  baseButton: BASE_NAV_BUTTON_CLASSES,\n  active: ACTIVE_NAV_CLASSES,\n  inactive: INACTIVE_NAV_CLASSES\n};\n\nexport function StickySectionNav({\n  items,\n  stickyTopOffset = 0,\n  align = \"end\",\n  ariaLabel = \"Section navigation\",\n  className,\n  navClassName,\n  observeIds,\n  onActiveChange,\n  fallbackActiveId,\n  scrollBehavior = \"smooth\",\n  disableSticky = false\n}: StickySectionNavProps) {\n  const [activeId, setActiveId] = useState<string>(() => fallbackActiveId ?? items[0]?.id ?? \"\");\n  const observer = useRef<IntersectionObserver | null>(null);\n\n  const idsToObserve = useMemo(() => {\n    const ids = observeIds && observeIds.length > 0 ? observeIds : items.map((item) => item.id);\n    return Array.from(new Set(ids)).filter(Boolean);\n  }, [observeIds, items]);\n\n  useEffect(() => {\n    if (idsToObserve.length === 0 || typeof window === \"undefined\") {\n      return undefined;\n    }\n\n    const headings = idsToObserve\n      .map((id) => document.getElementById(id))\n      .filter((el): el is HTMLElement => Boolean(el));\n\n    observer.current?.disconnect();\n    observer.current = new IntersectionObserver(\n      (entries) => {\n        const visible = entries\n          .filter((entry) => entry.isIntersecting)\n          .sort((a, b) => b.intersectionRatio - a.intersectionRatio);\n\n        if (visible[0]?.target?.id) {\n          setActiveId(visible[0].target.id);\n        }\n      },\n      { rootMargin: \"-100px 0px -60% 0px\", threshold: [0, 0.5, 1] }\n    );\n\n    headings.forEach((el) => observer.current?.observe(el));\n\n    return () => observer.current?.disconnect();\n  }, [idsToObserve]);\n\n  useEffect(() => {\n    if (idsToObserve.length === 0) {\n      setActiveId(\"\");\n      return;\n    }\n\n    setActiveId((prev) => {\n      if (prev && idsToObserve.includes(prev)) {\n        return prev;\n      }\n      const preferred =\n        fallbackActiveId && idsToObserve.includes(fallbackActiveId)\n          ? fallbackActiveId\n          : idsToObserve[0];\n      return preferred ?? \"\";\n    });\n  }, [idsToObserve, fallbackActiveId]);\n\n  useEffect(() => {\n    if (activeId && onActiveChange) {\n      onActiveChange(activeId);\n    }\n  }, [activeId, onActiveChange]);\n\n  const handleSelect = (item: StickySectionNavItem) => {\n    setActiveId(item.id);\n\n    if (item.onSelect) {\n      item.onSelect();\n      return;\n    }\n\n    if (typeof window === \"undefined\") {\n      return;\n    }\n\n    const target = document.getElementById(item.id);\n    if (target) {\n      target.scrollIntoView({ behavior: scrollBehavior, block: \"start\" });\n    }\n  };\n\n  if (items.length === 0) {\n    return null;\n  }\n\n  const containerClasses = disableSticky\n    ? \"border-b border-border/20 bg-background/70 px-2 py-3 backdrop-blur supports-[backdrop-filter]:bg-background/50\"\n    : \"sticky z-30 -mx-2 mb-6 border-b border-border/20 bg-background/70 px-2 py-3 backdrop-blur supports-[backdrop-filter]:bg-background/50\";\n\n  const containerStyle = disableSticky ? undefined : { top: stickyTopOffset };\n\n  return (\n    <div\n      className={cn(containerClasses, className)}\n      style={containerStyle}\n    >\n      <nav\n        className={cn(\n          \"flex w-full max-w-full items-center gap-2 overflow-x-auto\",\n          ALIGN_CLASSNAMES[align],\n          navClassName\n        )}\n        aria-label={ariaLabel}\n      >\n        {items.map((item) => {\n          const buttonClasses = [\n            BASE_NAV_BUTTON_CLASSES,\n            item.id === activeId ? ACTIVE_NAV_CLASSES : INACTIVE_NAV_CLASSES\n          ].join(\" \");\n\n          return (\n            <button\n              key={item.id}\n              type=\"button\"\n              className={buttonClasses}\n              onClick={() => handleSelect(item)}\n              aria-current={item.id === activeId ? \"page\" : undefined}\n            >\n              {item.title}\n            </button>\n          );\n        })}\n      </nav>\n    </div>\n  );\n}\n\nexport default StickySectionNav;\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/navigation/__tests__/StickySectionNav.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/ProjectDetailsLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Section.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/StickySectionNav.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":3,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":3,"endColumn":21}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"export {\n  StickySectionNav as default,\n  STICKY_NAV_CLASSES\n} from \"@/components/navigation/StickySectionNav\";\n\nexport type {\n  StickySectionNavProps,\n  StickySectionNavItem\n} from \"@/components/navigation/StickySectionNav\";\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/ClientCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/CompactProjectBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/CompactSessionBanner.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/FinancialSummaryCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/ProjectSummaryCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/QuickActionsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/project-details/Summary/SessionsSummaryCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/projectArchiveToggle.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/services/ServicesTableCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/services/SummaryTotalsCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/services/__tests__/ServicesTableCard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/services/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/AutoSaveToggle.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/CategoryFloatingActionBar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/CategorySettingsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/EnhancedSettingsSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/LeadStatusDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/NavigationGuardDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/PackageDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/ProjectStageDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/ProjectTypeDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/ServiceDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SessionStatusDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SessionTypeDialogs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SettingsHeader.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SettingsHelpButton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SettingsHelpSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SettingsLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SettingsPageWrapper.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SettingsStickyFooter.tsx","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useTranslation\" is called conditionally. React Hooks must be called in the exact same order in every component render.","line":24,"column":17,"nodeType":"Identifier","endLine":24,"endColumn":31}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Button } from \"@/components/ui/button\";\nimport { Loader2, Check } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport { useTranslation } from \"react-i18next\";\n\nexport interface SettingsStickyFooterProps {\n  show: boolean;\n  isSaving: boolean;\n  showSuccess?: boolean;\n  onSave: () => void;\n  onCancel: () => void;\n  className?: string;\n}\n\nexport function SettingsStickyFooter({\n  show,\n  isSaving,\n  showSuccess,\n  onSave,\n  onCancel,\n  className,\n}: SettingsStickyFooterProps) {\n  if (!show) return null;\n  const { t } = useTranslation(\"common\");\n\n  return (\n    <div\n      className={cn(\n        \"sticky bottom-0 left-0 right-0 z-10 border-t border-border/80 bg-card/95 backdrop-blur-md transition-all duration-200 ease-in-out\",\n        \"animate-in slide-in-from-bottom-2\",\n        className\n      )}\n    >\n      <div className=\"flex w-full items-center justify-end gap-2 px-4 py-4 sm:px-0\">\n        <Button\n          variant=\"ghost\"\n          onClick={onCancel}\n          disabled={isSaving}\n          className={cn(\n            \"h-9 min-w-[80px] rounded-md px-4 text-sm font-medium text-muted-foreground transition-colors\",\n            \"hover:bg-destructive/10 hover:text-destructive focus-visible:ring-destructive/40\"\n          )}\n        >\n          {t(\"buttons.cancel\")}\n        </Button>\n        <Button\n          onClick={onSave}\n          disabled={isSaving}\n          className={cn(\n            \"h-9 min-w-[128px] rounded-md px-4 text-sm font-semibold text-[hsl(var(--accent-900))]\",\n            \"bg-[hsl(var(--accent-200))] hover:bg-[hsl(var(--accent-300))] focus-visible:ring-[hsl(var(--accent-300))]\",\n            \"disabled:opacity-70\"\n          )}\n        >\n          {isSaving ? (\n            <>\n              <Loader2 className=\"h-4 w-4 animate-spin\" />\n              {t(\"actions.saving\")}\n            </>\n          ) : showSuccess ? (\n            <>\n              <Check className=\"h-4 w-4\" />\n              {t(\"toast.settingsSavedTitle\")}\n            </>\n          ) : (\n            t(\"buttons.save_changes\")\n          )}\n        </Button>\n      </div>\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/SocialChannelsSection.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":53,"column":32,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":53,"endColumn":35,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2125,2128],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2125,2128],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState } from 'react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';\nimport { Badge } from '@/components/ui/badge';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { \n  Globe, \n  Facebook, \n  Instagram, \n  Twitter, \n  Linkedin, \n  Youtube, \n  Plus, \n  Trash2,\n  GripVertical,\n  Music\n} from 'lucide-react';\nimport { DragDropContext, Droppable, Draggable, DropResult } from '@hello-pangea/dnd';\nimport { SocialChannel } from '@/hooks/useOrganizationSettings';\nimport { cn } from '@/lib/utils';\nimport { useTranslation } from 'react-i18next';\n\ninterface SocialChannelsSectionProps {\n  socialChannels: Record<string, SocialChannel>;\n  onUpdate: (channels: Record<string, SocialChannel>) => void;\n  isDirty: boolean;\n}\n\nconst PREDEFINED_PLATFORMS = [\n  { key: 'website', name: 'Website', icon: Globe },\n  { key: 'facebook', name: 'Facebook', icon: Facebook },\n  { key: 'instagram', name: 'Instagram', icon: Instagram },\n  { key: 'twitter', name: 'Twitter/X', icon: Twitter },\n  { key: 'linkedin', name: 'LinkedIn', icon: Linkedin },\n  { key: 'youtube', name: 'YouTube', icon: Youtube },\n  { key: 'tiktok', name: 'TikTok', icon: Music },\n];\n\nexport function SocialChannelsSection({ socialChannels, onUpdate, isDirty }: SocialChannelsSectionProps) {\n  const { t } = useTranslation('forms');\n  const [customPlatformName, setCustomPlatformName] = useState('');\n\n  const addPredefinedPlatform = (platformKey: string) => {\n    const platform = PREDEFINED_PLATFORMS.find(p => p.key === platformKey);\n    if (!platform || socialChannels[platformKey]) return;\n\n    const maxOrder = Math.max(0, ...Object.values(socialChannels).map(c => c.order || 0));\n    const newChannel: SocialChannel = {\n      name: platform.name,\n      url: '',\n      platform: platformKey as any,\n      enabled: true,\n      order: maxOrder + 1,\n    };\n\n    onUpdate({\n      ...socialChannels,\n      [platformKey]: newChannel\n    });\n  };\n\n  const addCustomPlatform = () => {\n    if (!customPlatformName.trim()) return;\n\n    const customKey = `custom_${Date.now()}`;\n    const maxOrder = Math.max(0, ...Object.values(socialChannels).map(c => c.order || 0));\n    const newChannel: SocialChannel = {\n      name: customPlatformName.trim(),\n      url: '',\n      platform: 'custom',\n      customPlatformName: customPlatformName.trim(),\n      enabled: true,\n      order: maxOrder + 1,\n    };\n\n    onUpdate({\n      ...socialChannels,\n      [customKey]: newChannel\n    });\n    setCustomPlatformName('');\n  };\n\n  const updateChannel = (key: string, updates: Partial<SocialChannel>) => {\n    onUpdate({\n      ...socialChannels,\n      [key]: { ...socialChannels[key], ...updates }\n    });\n  };\n\n  const removeChannel = (key: string) => {\n    const { [key]: removed, ...remaining } = socialChannels;\n    onUpdate(remaining);\n  };\n\n  const handleDragEnd = (result: DropResult) => {\n    if (!result.destination) return;\n\n    const sortedEntries = Object.entries(socialChannels)\n      .sort(([, a], [, b]) => (a.order || 0) - (b.order || 0));\n    \n    const [reorderedItem] = sortedEntries.splice(result.source.index, 1);\n    sortedEntries.splice(result.destination.index, 0, reorderedItem);\n\n    const reorderedChannels = Object.fromEntries(\n      sortedEntries.map(([key, channel], index) => [\n        key,\n        { ...channel, order: index }\n      ])\n    );\n    onUpdate(reorderedChannels);\n  };\n\n  const validateUrl = (url: string): boolean => {\n    try {\n      new URL(url);\n      return true;\n    } catch {\n      return false;\n    }\n  };\n\n  const getChannelIcon = (channel: SocialChannel) => {\n    const platform = PREDEFINED_PLATFORMS.find(p => p.key === channel.platform);\n    return platform?.icon || Globe;\n  };\n\n  const availablePlatforms = PREDEFINED_PLATFORMS.filter(\n    platform => !socialChannels[platform.key]\n  );\n\n  const channelEntries = Object.entries(socialChannels)\n    .sort(([, a], [, b]) => (a.order || 0) - (b.order || 0));\n\n  return (\n    <Card>\n      <CardHeader>\n        <CardTitle className=\"flex items-center gap-2\">\n          <Globe className=\"h-5 w-5\" />\n          {t('social_channels.title')}\n          {isDirty && <Badge variant=\"secondary\">{t('social_channels.unsaved_changes')}</Badge>}\n        </CardTitle>\n        <p className=\"text-sm text-muted-foreground\">\n          {t('social_channels.description')}\n        </p>\n      </CardHeader>\n      <CardContent>\n        <div className=\"space-y-4\">\n          {/* Existing Channels with Drag & Drop */}\n          {channelEntries.length > 0 && (\n            <DragDropContext onDragEnd={handleDragEnd}>\n              <Droppable droppableId=\"social-channels\">\n                {(provided) => (\n                  <div \n                    {...provided.droppableProps} \n                    ref={provided.innerRef}\n                    className=\"space-y-3\"\n                  >\n                    {channelEntries.map(([key, channel], index) => {\n                      const Icon = getChannelIcon(channel);\n                      const hasValidUrl = channel.url && validateUrl(channel.url);\n                      \n                      return (\n                        <Draggable key={key} draggableId={key} index={index}>\n                          {(provided, snapshot) => (\n                            <div\n                              ref={provided.innerRef}\n                              {...provided.draggableProps}\n                              className={cn(\n                                \"flex items-center gap-3 p-3 rounded-lg border bg-card transition-colors\",\n                                !hasValidUrl && channel.url && \"border-destructive/50 bg-destructive/5\",\n                                snapshot.isDragging && \"shadow-lg\"\n                              )}\n                            >\n                              <div \n                                {...provided.dragHandleProps}\n                                className=\"cursor-grab active:cursor-grabbing\"\n                              >\n                                <GripVertical className=\"h-4 w-4 text-muted-foreground\" />\n                              </div>\n                              \n                              <Icon className=\"h-4 w-4 text-muted-foreground flex-shrink-0\" />\n                              \n                              <div className=\"min-w-0 w-20 flex-shrink-0\">\n                                <span className=\"text-sm font-medium truncate block\">\n                                  {channel.customPlatformName || channel.name}\n                                </span>\n                              </div>\n                              \n                              <div className=\"flex-1\">\n                                <Input\n                                  placeholder={`https://${channel.platform === 'website' ? 'yourwebsite.com' : `${channel.platform}.com/yourprofile`}`}\n                                  value={channel.url}\n                                  onChange={(e) => updateChannel(key, { url: e.target.value })}\n                                  className={cn(\n                                    \"h-9 text-sm\",\n                                    !hasValidUrl && channel.url && \"border-destructive focus:ring-destructive\"\n                                  )}\n                                 />\n                                 {!hasValidUrl && channel.url && (\n                                   <p className=\"text-xs text-destructive mt-1\">{t('social_channels.url_invalid')}</p>\n                                 )}\n                               </div>\n                              \n                              <AlertDialog>\n                                <AlertDialogTrigger asChild>\n                                  <Button\n                                    variant=\"ghost\"\n                                    size=\"sm\"\n                                    className=\"text-destructive hover:text-destructive hover:bg-destructive/10 h-9 w-9 p-0 flex-shrink-0\"\n                                  >\n                                    <Trash2 className=\"h-4 w-4\" />\n                                  </Button>\n                                </AlertDialogTrigger>\n                                 <AlertDialogContent>\n                                   <AlertDialogHeader>\n                                     <AlertDialogTitle>{t('social_channels.remove_channel_title')}</AlertDialogTitle>\n                                     <AlertDialogDescription>\n                                       {t('social_channels.remove_channel_description', { name: channel.customPlatformName || channel.name })}\n                                     </AlertDialogDescription>\n                                   </AlertDialogHeader>\n                                   <AlertDialogFooter>\n                                     <AlertDialogCancel>{t('common:common.buttons.cancel')}</AlertDialogCancel>\n                                     <AlertDialogAction \n                                       onClick={() => removeChannel(key)}\n                                       className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                                     >\n                                       {t('social_channels.remove_button')}\n                                     </AlertDialogAction>\n                                   </AlertDialogFooter>\n                                 </AlertDialogContent>\n                              </AlertDialog>\n                            </div>\n                          )}\n                        </Draggable>\n                      );\n                    })}\n                    {provided.placeholder}\n                  </div>\n                )}\n              </Droppable>\n            </DragDropContext>\n          )}\n\n          {/* Empty State */}\n          {channelEntries.length === 0 && (\n            <div className=\"text-center py-6 text-muted-foreground\">\n              <Globe className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n              <p className=\"text-sm\">{t('social_channels.no_channels')}</p>\n              <p className=\"text-xs\">{t('social_channels.add_links_description')}</p>\n            </div>\n          )}\n\n          {/* Add Platform Buttons */}\n          {availablePlatforms.length > 0 && (\n            <div>\n              <Label className=\"text-sm font-medium mb-2 block\">{t('social_channels.add_platform')}</Label>\n              <div className=\"flex flex-wrap gap-2\">\n                {availablePlatforms.map((platform) => {\n                  const Icon = platform.icon;\n                  return (\n                    <Button\n                      key={platform.key}\n                      variant=\"outline\"\n                      size=\"sm\"\n                      onClick={() => addPredefinedPlatform(platform.key)}\n                      className=\"flex items-center gap-2 h-9\"\n                    >\n                      <Icon className=\"h-4 w-4\" />\n                      {platform.name}\n                    </Button>\n                  );\n                })}\n              </div>\n            </div>\n          )}\n\n          {/* Add Custom Platform */}\n          <div className=\"flex gap-2\">\n            <Input\n              placeholder={t('social_channels.custom_platform_placeholder')}\n              value={customPlatformName}\n              onChange={(e) => setCustomPlatformName(e.target.value)}\n              onKeyPress={(e) => e.key === 'Enter' && addCustomPlatform()}\n              className=\"flex-1 h-9\"\n            />\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={addCustomPlatform}\n              disabled={!customPlatformName.trim()}\n              className=\"flex items-center gap-2 h-9\"\n            >\n              <Plus className=\"h-4 w-4\" />\n              {t('social_channels.add_custom')}\n            </Button>\n          </div>\n\n          {/* Helper Text */}\n          <div className=\"text-xs text-muted-foreground space-y-1\">\n            <p>• {t('social_channels.help_text.appear_in_emails')}</p>\n            <p>• {t('social_channels.help_text.drag_to_reorder')}</p>\n            <p>• {t('social_channels.help_text.valid_urls_only')}</p>\n          </div>\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/TaxBillingSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/LeadStatusDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/NavigationGuardDialog.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/PackageDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/ProjectStageDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/ProjectTypeDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/ServiceDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/SessionStatusDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/SessionTypeDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/SettingsHelpButton.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/SettingsLayout.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/SettingsPageWrapper.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/__tests__/SettingsStickyFooter.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/settings/settingsNavConfig.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/ActivityForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/ActivityTimeline.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/ActivityTimelineItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/BaseOnboardingModal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/OnboardingTutorial.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/TutorialExitGuardDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/shared/TutorialFloatingCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/sidebar/SidebarCategory.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/sidebar/SidebarNavItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/sidebar/SidebarSubItem.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/summary/SummaryCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/summary/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/support/HelpOptionCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/support/__tests__/HelpOptionCard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/AddBlockSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/BlockEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/CompactStorageIndicator.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchStorageUsage'. Either include it or remove the dependency array.","line":53,"column":6,"nodeType":"ArrayExpression","endLine":53,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [activeOrganization.id, fetchStorageUsage]","fix":{"range":[1646,1670],"text":"[activeOrganization.id, fetchStorageUsage]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { AlertTriangle, HardDrive } from 'lucide-react';\nimport { Progress } from '@/components/ui/progress';\nimport { Badge } from '@/components/ui/badge';\nimport { Button } from '@/components/ui/button';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useOrganization } from '@/contexts/OrganizationContext';\n\ninterface StorageUsage {\n  total_images: number;\n  total_storage_bytes: number;\n}\n\nconst STORAGE_LIMITS = {\n  MAX_IMAGES: 50,\n  MAX_STORAGE_BYTES: 50 * 1024 * 1024, // 50MB\n};\n\ninterface CompactStorageIndicatorProps {\n  onManageImages?: () => void;\n}\n\nexport function CompactStorageIndicator({ onManageImages }: CompactStorageIndicatorProps) {\n  const [storageUsage, setStorageUsage] = useState<StorageUsage>({ total_images: 0, total_storage_bytes: 0 });\n  const [loading, setLoading] = useState(true);\n  const { activeOrganization } = useOrganization();\n\n  const fetchStorageUsage = async () => {\n    if (!activeOrganization?.id) return;\n    \n    try {\n      const { data, error } = await supabase\n        .from('template_image_usage')\n        .select('total_images, total_storage_bytes')\n        .eq('organization_id', activeOrganization.id)\n        .single();\n\n      if (error && error.code !== 'PGRST116') {\n        console.error('Error fetching storage usage:', error);\n        return;\n      }\n\n      setStorageUsage(data || { total_images: 0, total_storage_bytes: 0 });\n    } catch (error) {\n      console.error('Error fetching storage usage:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchStorageUsage();\n  }, [activeOrganization?.id]);\n\n  if (loading) {\n    return <div className=\"h-4 w-32 bg-muted animate-pulse rounded\" />;\n  }\n\n  const imageProgress = (storageUsage.total_images / STORAGE_LIMITS.MAX_IMAGES) * 100;\n  const storageProgress = (storageUsage.total_storage_bytes / STORAGE_LIMITS.MAX_STORAGE_BYTES) * 100;\n  const isNearLimit = imageProgress > 80 || storageProgress > 80;\n  const isAtLimit = imageProgress >= 100 || storageProgress >= 100;\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`;\n  };\n\n  return (\n    <div className=\"flex items-center gap-3 p-3 bg-muted/50 rounded-lg\">\n      <div className=\"flex items-center gap-2\">\n        <HardDrive className=\"h-4 w-4 text-muted-foreground\" />\n        <div className=\"space-y-1\">\n          <div className=\"flex items-center gap-2\">\n            <span className=\"text-xs text-muted-foreground\">\n              {storageUsage.total_images}/{STORAGE_LIMITS.MAX_IMAGES} images\n            </span>\n            {isAtLimit && <AlertTriangle className=\"h-3 w-3 text-destructive\" />}\n            {isNearLimit && !isAtLimit && <AlertTriangle className=\"h-3 w-3 text-warning\" />}\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Progress value={Math.min(imageProgress, 100)} className=\"w-20 h-1\" />\n            <span className=\"text-xs text-muted-foreground\">\n              {formatFileSize(storageUsage.total_storage_bytes)}/50MB\n            </span>\n          </div>\n        </div>\n      </div>\n      \n      {onManageImages && (\n        <Button variant=\"ghost\" size=\"sm\" onClick={onManageImages} className=\"text-xs\">\n          Manage\n        </Button>\n      )}\n      \n      {isAtLimit && (\n        <Badge variant=\"destructive\" className=\"text-xs\">\n          Limit Reached\n        </Badge>\n      )}\n      {isNearLimit && !isAtLimit && (\n        <Badge variant=\"secondary\" className=\"text-xs\">\n          Near Limit\n        </Badge>\n      )}\n    </div>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/DeleteTemplateDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/EmojiPicker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/ImageLibrarySheet.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAssets'. Either include it or remove the dependency array.","line":71,"column":6,"nodeType":"ArrayExpression","endLine":71,"endColumn":36,"suggestions":[{"desc":"Update the dependencies array to be: [open, activeOrganization.id, loadAssets]","fix":{"range":[2518,2548],"text":"[open, activeOrganization.id, loadAssets]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Sheet, SheetContent, SheetDescription, SheetHeader, SheetTitle } from '@/components/ui/sheet';\nimport { Button } from '@/components/ui/button';\nimport { Badge } from '@/components/ui/badge';\nimport { Input } from '@/components/ui/input';\nimport { AlertDialog, AlertDialogAction, AlertDialogCancel, AlertDialogContent, AlertDialogDescription, AlertDialogFooter, AlertDialogHeader, AlertDialogTitle, AlertDialogTrigger } from '@/components/ui/alert-dialog';\nimport { Copy, Trash2, Edit3, Check, X } from 'lucide-react';\nimport { useToast } from '@/hooks/use-toast';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useOrganization } from '@/contexts/OrganizationContext';\nimport { CompactStorageIndicator } from './CompactStorageIndicator';\nimport { useTranslation } from 'react-i18next';\nimport { useMessagesTranslation } from '@/hooks/useTypedTranslation';\n\ninterface TemplateAsset {\n  id: string;\n  file_name: string;\n  file_path: string;\n  file_size: number;\n  content_type: string;\n  alt_text?: string;\n  created_at: string;\n}\n\ninterface ImageLibrarySheetProps {\n  open: boolean;\n  onOpenChange: (open: boolean) => void;\n  onImageSelect?: (imageUrl: string, altText?: string) => void;\n  templateId?: string;\n}\n\nexport function ImageLibrarySheet({ open, onOpenChange, onImageSelect, templateId }: ImageLibrarySheetProps) {\n  const [assets, setAssets] = useState<TemplateAsset[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [editingAltText, setEditingAltText] = useState<string | null>(null);\n  const [tempAltText, setTempAltText] = useState('');\n  const { toast } = useToast();\n  const { t } = useTranslation();\n  const { t: tMessages } = useMessagesTranslation();\n  const { activeOrganization } = useOrganization();\n\n  const loadAssets = async () => {\n    if (!activeOrganization?.id) return;\n    \n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('template_assets')\n        .select('*')\n        .eq('organization_id', activeOrganization.id)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      setAssets(data || []);\n    } catch (error) {\n      console.error('Error loading assets:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to load images',\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    if (open) {\n      loadAssets();\n    }\n  }, [open, activeOrganization?.id]);\n\n  const getImageUrl = (filePath: string) => {\n    const { data: { publicUrl } } = supabase.storage\n      .from('template-images')\n      .getPublicUrl(filePath);\n    return publicUrl;\n  };\n\n  const copyImageUrl = async (filePath: string) => {\n    const imageUrl = getImageUrl(filePath);\n    try {\n      await navigator.clipboard.writeText(imageUrl);\n      toast({\n        title: 'Success',\n        description: 'Image URL copied to clipboard',\n      });\n    } catch (error) {\n      toast({\n        title: 'Error',\n        description: 'Failed to copy URL',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const deleteAsset = async (asset: TemplateAsset) => {\n    try {\n      // Delete from storage\n      const { error: storageError } = await supabase.storage\n        .from('template-images')\n        .remove([asset.file_path]);\n\n      if (storageError) throw storageError;\n\n      // Delete from database\n      const { error: dbError } = await supabase\n        .from('template_assets')\n        .delete()\n        .eq('id', asset.id);\n\n      if (dbError) throw dbError;\n\n      toast({\n        title: 'Success',\n        description: 'Image deleted successfully',\n      });\n\n      // Refresh the list\n      loadAssets();\n    } catch (error) {\n      console.error('Error deleting asset:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to delete image',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const updateAltText = async (assetId: string, newAltText: string) => {\n    try {\n      const { error } = await supabase\n        .from('template_assets')\n        .update({ alt_text: newAltText })\n        .eq('id', assetId);\n\n      if (error) throw error;\n\n      setAssets(prev => prev.map(asset => \n        asset.id === assetId ? { ...asset, alt_text: newAltText } : asset\n      ));\n\n      toast({\n        title: 'Success',\n        description: 'Alt text updated',\n      });\n    } catch (error) {\n      console.error('Error updating alt text:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to update alt text',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const handleEditAltText = (assetId: string, currentAltText: string) => {\n    setEditingAltText(assetId);\n    setTempAltText(currentAltText || '');\n  };\n\n  const handleSaveAltText = (assetId: string) => {\n    updateAltText(assetId, tempAltText);\n    setEditingAltText(null);\n    setTempAltText('');\n  };\n\n  const handleCancelEditAltText = () => {\n    setEditingAltText(null);\n    setTempAltText('');\n  };\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return `${parseFloat((bytes / Math.pow(k, i)).toFixed(1))} ${sizes[i]}`;\n  };\n\n  return (\n    <Sheet open={open} onOpenChange={onOpenChange}>\n      <SheetContent className=\"w-[600px] sm:w-[700px] overflow-hidden flex flex-col\">\n        <SheetHeader>\n          <SheetTitle>Image Library</SheetTitle>\n          <SheetDescription>\n            Manage your uploaded images. Click on an image to select it for your template.\n          </SheetDescription>\n        </SheetHeader>\n\n        <div className=\"mt-4\">\n          <CompactStorageIndicator />\n        </div>\n\n        <div className=\"flex-1 overflow-y-auto mt-6\">\n          {loading ? (\n            <div className=\"grid grid-cols-2 gap-4\">\n              {Array.from({ length: 6 }).map((_, i) => (\n                <div key={i} className=\"aspect-video bg-muted animate-pulse rounded-lg\" />\n              ))}\n            </div>\n          ) : assets.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <p className=\"text-muted-foreground\">No images uploaded yet</p>\n              <p className=\"text-sm text-muted-foreground mt-1\">\n                Upload an image using the image block to see it here\n              </p>\n            </div>\n          ) : (\n            <div className=\"grid grid-cols-2 gap-4\">\n              {assets.map((asset) => (\n                <div key={asset.id} className=\"group relative bg-card border rounded-lg overflow-hidden\">\n                  <div className=\"aspect-video relative\">\n                    <img\n                      src={getImageUrl(asset.file_path)}\n                      alt={asset.alt_text || asset.file_name}\n                      className=\"w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform\"\n                      onClick={() => {\n                        if (onImageSelect) {\n                          onImageSelect(getImageUrl(asset.file_path), asset.alt_text);\n                          onOpenChange(false);\n                        }\n                      }}\n                    />\n                    <div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors\" />\n                    <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity flex gap-1\">\n                      <Button\n                        size=\"sm\"\n                        variant=\"secondary\"\n                        onClick={() => copyImageUrl(asset.file_path)}\n                        className=\"h-8 w-8 p-0\"\n                        aria-label=\"Copy image URL\"\n                      >\n                        <Copy className=\"h-3 w-3\" />\n                      </Button>\n                      <AlertDialog>\n                        <AlertDialogTrigger asChild>\n                          <Button\n                            size=\"sm\"\n                            variant=\"destructive\"\n                            className=\"h-8 w-8 p-0\"\n                            aria-label=\"Delete image\"\n                          >\n                            <Trash2 className=\"h-3 w-3\" />\n                          </Button>\n                        </AlertDialogTrigger>\n                        <AlertDialogContent>\n                          <AlertDialogHeader>\n                            <AlertDialogTitle>Delete Image</AlertDialogTitle>\n                            <AlertDialogDescription>\n                              {tMessages('confirm.deleteWithName', { name: asset.file_name })} {tMessages('confirm.cannotUndo')}\n                            </AlertDialogDescription>\n                          </AlertDialogHeader>\n                          <AlertDialogFooter>\n                            <AlertDialogCancel>Cancel</AlertDialogCancel>\n                            <AlertDialogAction\n                              onClick={() => deleteAsset(asset)}\n                              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                            >\n                              Delete\n                            </AlertDialogAction>\n                          </AlertDialogFooter>\n                        </AlertDialogContent>\n                      </AlertDialog>\n                    </div>\n                  </div>\n                  \n                  <div className=\"p-3 space-y-2\">\n                    <div className=\"flex items-center justify-between\">\n                      <p className=\"text-sm font-medium truncate\">{asset.file_name}</p>\n                      <Badge variant=\"secondary\" className=\"text-xs\">\n                        {formatFileSize(asset.file_size)}\n                      </Badge>\n                    </div>\n                    \n                    <div className=\"flex items-center gap-2\">\n                      {editingAltText === asset.id ? (\n                        <div className=\"flex items-center gap-1 flex-1\">\n                          <Input\n                            value={tempAltText}\n                            onChange={(e) => setTempAltText(e.target.value)}\n                            placeholder=\"Alt text\"\n                            className=\"h-7 text-xs\"\n                          />\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleSaveAltText(asset.id)}\n                            className=\"h-7 w-7 p-0\"\n                            aria-label=\"Confirm alt text\"\n                          >\n                            <Check className=\"h-3 w-3\" />\n                          </Button>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={handleCancelEditAltText}\n                            className=\"h-7 w-7 p-0\"\n                            aria-label=\"Cancel alt text edit\"\n                          >\n                            <X className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      ) : (\n                        <div className=\"flex items-center gap-1 flex-1\">\n                          <p className=\"text-xs text-muted-foreground flex-1 truncate\">\n                            Alt: {asset.alt_text || 'No alt text'}\n                          </p>\n                          <Button\n                            size=\"sm\"\n                            variant=\"ghost\"\n                            onClick={() => handleEditAltText(asset.id, asset.alt_text || '')}\n                            className=\"h-7 w-7 p-0\"\n                            aria-label=\"Edit alt text\"\n                          >\n                            <Edit3 className=\"h-3 w-3\" />\n                          </Button>\n                        </div>\n                      )}\n                    </div>\n\n                    {onImageSelect && (\n                      <Button\n                        size=\"sm\"\n                        variant=\"outline\"\n                        className=\"w-full h-7 text-xs\"\n                        onClick={() => {\n                          onImageSelect(getImageUrl(asset.file_path), asset.alt_text);\n                          onOpenChange(false);\n                        }}\n                      >\n                        Insert\n                      </Button>\n                    )}\n                  </div>\n                </div>\n              ))}\n            </div>\n          )}\n        </div>\n      </SheetContent>\n    </Sheet>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/ImageUpload.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/InlinePreheaderEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/InlineSubjectEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/NewBlockEditors.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/OptimizedTemplateEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/OptimizedTemplatePreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/PlainTextPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/StorageQuotaDisplay.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/TemplateErrorBoundary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/TemplateNameDialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/TemplatePreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/VariablePicker.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":28,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":28,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1041,1044],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1041,1044],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Popover, PopoverContent, PopoverTrigger } from \"@/components/ui/popover\";\nimport { Command, CommandEmpty, CommandGroup, CommandInput, CommandItem, CommandList } from \"@/components/ui/command\";\nimport { Plus, Check } from \"lucide-react\";\nimport { useTemplateVariables } from \"@/hooks/useTemplateVariables\";\n\ninterface VariablePickerProps {\n  onVariableSelect: (variable: string) => void;\n  trigger?: React.ReactNode;\n}\n\nexport function VariablePicker({ onVariableSelect, trigger }: VariablePickerProps) {\n  const [open, setOpen] = useState(false);\n  const { variables, loading } = useTemplateVariables();\n\n  const handleSelect = (variableKey: string) => {\n    onVariableSelect(`{${variableKey}}`);\n    setOpen(false);\n  };\n\n  const groupedVariables = variables.reduce((acc, variable) => {\n    if (!acc[variable.category]) {\n      acc[variable.category] = [];\n    }\n    acc[variable.category].push(variable);\n    return acc;\n  }, {} as Record<string, any[]>);\n\n  return (\n    <Popover open={open} onOpenChange={setOpen}>\n      <PopoverTrigger asChild>\n        {trigger || (\n          <Button variant=\"outline\" size=\"sm\">\n            <Plus className=\"h-3 w-3\" />\n            Variable\n          </Button>\n        )}\n      </PopoverTrigger>\n      <PopoverContent className=\"w-80 p-0\" align=\"start\">\n        <Command>\n          <CommandInput placeholder=\"Search variables...\" />\n          <CommandList>\n            <CommandEmpty>No variables found.</CommandEmpty>\n            {loading ? (\n              <div className=\"p-4 text-center text-muted-foreground\">\n                Loading variables...\n              </div>\n            ) : (\n              Object.entries(groupedVariables).map(([category, vars]) => (\n                <CommandGroup key={category} heading={category}>\n                  {vars.map((variable) => (\n                    <CommandItem\n                      key={variable.key}\n                      onSelect={() => handleSelect(variable.key)}\n                      className=\"cursor-pointer\"\n                    >\n                      <Check className=\"mr-2 h-4 w-4 opacity-0\" />\n                      <div>\n                        <div className=\"font-medium\">{variable.label}</div>\n                        <div className=\"text-xs text-muted-foreground\">{`{${variable.key}}`}</div>\n                      </div>\n                    </CommandItem>\n                  ))}\n                </CommandGroup>\n              ))\n            )}\n          </CommandList>\n        </Command>\n      </PopoverContent>\n    </Popover>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/CompactStorageIndicator.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/ImageLibrarySheet.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/ImageUpload.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/InlineEditors.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/StorageQuotaDisplay.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/TemplateBuilderAssets.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/TemplateBuilderDialogs.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/TemplateBuilderEditors.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/TemplateBuilderPreview.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/TemplateBuilderStorage.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/__tests__/TemplatePreview.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":43,"column":17,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":43,"endColumn":33}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { fireEvent, render, screen, waitFor } from \"@/utils/testUtils\";\nimport { TemplatePreview } from \"../TemplatePreview\";\nimport { PlainTextPreview } from \"../PlainTextPreview\";\nimport { SMSPreview } from \"../previews/SMSPreview\";\nimport { WhatsAppPreview } from \"../previews/WhatsAppPreview\";\nimport { EmailPreview } from \"../previews/EmailPreview\";\nimport type { TemplateBlock } from \"@/types/templateBuilder\";\n\nconst toastMock = jest.fn();\nconst invokeMock = jest.fn();\nconst useAuthMock = jest.fn();\nconst useOrganizationSettingsMock = jest.fn(() => ({ settings: null }));\nconst generatePlainTextMock = jest.fn(() => \"Plain text body\");\n\njest.mock(\"@/hooks/use-toast\", () => ({\n  toast: (...args: unknown[]) => toastMock(...args),\n  useToast: () => ({ toast: (...args: unknown[]) => toastMock(...args) }),\n}));\n\njest.mock(\"@/integrations/supabase/client\", () => ({\n  supabase: {\n    functions: {\n      invoke: (...args: unknown[]) => invokeMock(...args),\n    },\n  },\n}));\n\njest.mock(\"@/contexts/AuthContext\", () => ({\n  useAuth: () => useAuthMock(),\n}));\n\njest.mock(\"@/hooks/useOrganizationSettings\", () => ({\n  useOrganizationSettings: () => useOrganizationSettingsMock(),\n}));\n\njest.mock(\"@/lib/templateUtils\", () => ({\n  ...jest.requireActual(\"@/lib/templateUtils\"),\n  generatePlainText: (...args: unknown[]) => generatePlainTextMock(...args),\n}));\n\njest.mock(\"@/components/ui/tabs\", () => {\n  const React = require(\"react\");\n  const TabsContext = React.createContext<{ onValueChange?: (value: string) => void }>({});\n\n  const Tabs = ({\n    onValueChange,\n    children,\n  }: {\n    onValueChange?: (value: string) => void;\n    children: React.ReactNode;\n  }) => <TabsContext.Provider value={{ onValueChange }}>{children}</TabsContext.Provider>;\n\n  const TabsList = ({ children, ...props }: { children: React.ReactNode }) => <div {...props}>{children}</div>;\n\n  const TabsTrigger = ({\n    value,\n    children,\n    ...props\n  }: {\n    value: string;\n    children: React.ReactNode;\n  } & React.ButtonHTMLAttributes<HTMLButtonElement>) => {\n    const ctx = React.useContext(TabsContext);\n    return (\n      <button\n        type=\"button\"\n        {...props}\n        onClick={() => ctx.onValueChange?.(value)}\n      >\n        {children}\n      </button>\n    );\n  };\n\n  const TabsContent = ({ children, ...props }: { children: React.ReactNode }) => <div {...props}>{children}</div>;\n\n  return {\n    Tabs,\n    TabsList,\n    TabsTrigger,\n    TabsContent,\n  };\n});\n\njest.mock(\"react-i18next\", () => ({\n  useTranslation: () => ({\n    t: (key: string, options?: Record<string, unknown>) => {\n      if (options?.name) return `${key}:${options.name}`;\n      if (options?.email) return `${key}:${options.email}`;\n      return key;\n    },\n    i18n: { language: \"en\", changeLanguage: jest.fn() },\n  }),\n}));\n\nconst clipboardWriteMock = jest.fn().mockResolvedValue(undefined);\n\nbeforeAll(() => {\n  Object.assign(navigator, {\n    clipboard: {\n      writeText: clipboardWriteMock,\n    },\n  });\n});\n\nbeforeEach(() => {\n  toastMock.mockClear();\n  invokeMock.mockReset().mockResolvedValue({ data: { ok: true }, error: null });\n  clipboardWriteMock.mockClear();\n  useOrganizationSettingsMock.mockReturnValue({ settings: null });\n  useAuthMock.mockReturnValue({ user: { email: \"user@example.com\" } });\n  generatePlainTextMock.mockReturnValue(\"Plain text body\");\n});\n\nconst sampleBlocks: TemplateBlock[] = [\n  {\n    id: \"block-1\",\n    type: \"text\",\n    visible: true,\n    order: 0,\n    data: {\n      content: \"Hello {customer_name}\",\n      formatting: {\n        fontSize: \"p\",\n      },\n    },\n  },\n];\n\nconst previewData = {\n  customer_name: \"Alice Example\",\n  session_date: \"Aug 12\",\n  session_time: \"2:00 PM\",\n  session_location: \"Studio 5\",\n  business_name: \"Lumiso Studios\",\n  business_phone: \"555-1234\",\n};\n\ndescribe(\"TemplatePreview\", () => {\n  it(\"switches channels when tabs are selected\", () => {\n    const onChannelChange = jest.fn();\n\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"email\"\n        onChannelChange={onChannelChange}\n        previewData={previewData}\n      />\n    );\n\n    fireEvent.click(screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.channels\\.whatsapp/ }));\n    expect(onChannelChange).toHaveBeenCalledWith(\"whatsapp\");\n\n    fireEvent.click(screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.channels\\.sms/ }));\n    expect(onChannelChange).toHaveBeenCalledWith(\"sms\");\n  });\n\n  it(\"sends a test email when user has an email and blocks exist\", async () => {\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"email\"\n        onChannelChange={jest.fn()}\n        emailSubject=\"Subject {customer_name}\"\n        preheader=\"Preheader\"\n        previewData={previewData}\n      />\n    );\n\n    fireEvent.click(screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.testSend/ }));\n\n    await waitFor(() => {\n      expect(invokeMock).toHaveBeenCalledWith(\n        \"send-template-email\",\n        expect.objectContaining({\n          body: expect.objectContaining({\n            to: \"user@example.com\",\n            blocks: expect.arrayContaining([\n              expect.objectContaining({ id: \"block-1\" }),\n            ]),\n          }),\n        })\n      );\n    });\n\n    expect(toastMock).toHaveBeenCalledWith({\n      title: \"templateBuilder.preview.toast.successTitle\",\n      description: \"templateBuilder.preview.toast.testEmailSent:user@example.com\",\n    });\n  });\n\n  it(\"shows an error toast when no user email is present\", () => {\n    useAuthMock.mockReturnValue({ user: { email: null } });\n\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"email\"\n        onChannelChange={jest.fn()}\n        previewData={previewData}\n      />\n    );\n\n    fireEvent.click(screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.testSend/ }));\n\n    expect(invokeMock).not.toHaveBeenCalled();\n    expect(toastMock).toHaveBeenCalledWith({\n      title: \"templateBuilder.preview.toast.errorTitle\",\n      description: \"templateBuilder.preview.toast.noUserEmail\",\n      variant: \"destructive\",\n    });\n  });\n\n  it(\"disables test send when no blocks are present\", () => {\n    render(\n      <TemplatePreview\n        blocks={[]}\n        activeChannel=\"email\"\n        onChannelChange={jest.fn()}\n        previewData={previewData}\n      />\n    );\n\n    const sendButton = screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.testSend/ });\n    expect(sendButton).toBeDisabled();\n    fireEvent.click(sendButton);\n    expect(invokeMock).not.toHaveBeenCalled();\n    expect(toastMock).not.toHaveBeenCalled();\n  });\n\n  it(\"surfaces Supabase errors from sendTestEmail\", async () => {\n    invokeMock.mockResolvedValueOnce({ data: null, error: { message: \"Send failed\" } });\n\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"email\"\n        onChannelChange={jest.fn()}\n        previewData={previewData}\n      />\n    );\n\n    fireEvent.click(screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.testSend/ }));\n\n    await waitFor(() => {\n      expect(toastMock).toHaveBeenCalledWith({\n        title: \"templateBuilder.preview.toast.errorTitle\",\n        description: \"Send failed\",\n        variant: \"destructive\",\n      });\n    });\n  });\n\n  it(\"switches email preview device between desktop and mobile\", () => {\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"email\"\n        onChannelChange={jest.fn()}\n        previewData={previewData}\n      />\n    );\n\n    const previewContainerBefore = document.querySelector(\".mx-auto.transition-all\");\n    expect(previewContainerBefore?.className).toContain(\"max-w-2xl\");\n\n    fireEvent.click(screen.getByRole(\"button\", { name: /templateBuilder\\.preview\\.mobile/ }));\n\n    const previewContainerAfter = document.querySelector(\".mx-auto.transition-all\");\n    expect(previewContainerAfter?.className).toContain(\"max-w-sm\");\n  });\n\n  it(\"renders WhatsApp preview when channel is whatsapp\", () => {\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"whatsapp\"\n        onChannelChange={jest.fn()}\n        previewData={previewData}\n      />\n    );\n\n    expect(screen.getByText(/templateBuilder\\.preview\\.whatsapp\\.online/)).toBeInTheDocument();\n    expect(screen.getByText(/Hello 👋 Alice Example/)).toBeInTheDocument();\n  });\n\n  it(\"renders SMS preview when channel is sms\", () => {\n    render(\n      <TemplatePreview\n        blocks={sampleBlocks}\n        activeChannel=\"sms\"\n        onChannelChange={jest.fn()}\n        previewData={previewData}\n      />\n    );\n\n    expect(screen.getByText(/templateBuilder\\.preview\\.sms\\.label/)).toBeInTheDocument();\n    expect(screen.getByText(/templateBuilder\\.preview\\.sms\\.characters/)).toBeInTheDocument();\n  });\n});\n\ndescribe(\"PlainTextPreview\", () => {\n  it(\"copies generated text to the clipboard\", async () => {\n    render(<PlainTextPreview blocks={sampleBlocks} mockData={previewData} />);\n\n    fireEvent.click(screen.getByRole(\"button\", { name: \"Copy plain text preview\" }));\n\n    await waitFor(() => {\n      expect(generatePlainTextMock).toHaveBeenCalled();\n      expect(clipboardWriteMock).toHaveBeenCalledWith(\"Plain text body\");\n      expect(toastMock).toHaveBeenCalledWith({\n        title: \"Copied to clipboard\",\n        description: \"Plain text version has been copied to your clipboard.\",\n      });\n    });\n  });\n});\n\ndescribe(\"SMSPreview\", () => {\n  it(\"displays character counts and long message warning\", () => {\n    const longText = \"A\".repeat(170);\n    const smsBlock: TemplateBlock = {\n      id: \"sms-block\",\n      type: \"text\",\n      visible: true,\n      order: 0,\n      data: {\n        content: longText,\n        formatting: { fontSize: \"p\" },\n      },\n    };\n\n    render(<SMSPreview blocks={[smsBlock]} mockData={previewData} />);\n\n    expect(screen.getByText(/170/)).toBeInTheDocument();\n    expect(screen.getByText(/templateBuilder\\.preview\\.sms\\.longMessageWarning/)).toBeInTheDocument();\n  });\n});\n\ndescribe(\"WhatsAppPreview\", () => {\n  it(\"renders fallback content when no blocks are visible\", () => {\n    render(<WhatsAppPreview blocks={[]} mockData={previewData} />);\n\n    expect(screen.getByText(/templateBuilder\\.preview\\.excitedMessage/)).toBeInTheDocument();\n    expect(screen.getByText(/templateBuilder\\.preview\\.addBlocks/)).toBeInTheDocument();\n  });\n});\n\ndescribe(\"EmailPreview\", () => {\n  it(\"replaces template variables in text blocks\", () => {\n    render(\n      <EmailPreview\n        blocks={sampleBlocks}\n        mockData={previewData}\n        device=\"desktop\"\n        emailSubject=\"Subject for {customer_name}\"\n        preheader=\"Preheader for {business_name}\"\n      />\n    );\n\n    expect(screen.getByText(/Hello Alice Example/)).toBeInTheDocument();\n    expect(screen.getByText(/Subject for Alice Example/)).toBeInTheDocument();\n    expect(screen.getByText(/Preheader for Lumiso Studios/)).toBeInTheDocument();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/previews/EmailPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/previews/SMSPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/previews/WhatsAppPreview.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/template-builder/storageLimits.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/app-sheet-modal.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/card.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/data-table-container.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/data-table.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/date-time-picker.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/kpi-presets.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/loading-presets.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/long-press-button.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/page-header.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/pagination.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/progress-bar.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/progress.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/segmented-control.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/switch.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/toast.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/toaster.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/__tests__/use-toast.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":72,"column":51,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":72,"endColumn":54,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1712,1715],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1712,1715],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { act, renderHook } from \"@testing-library/react\";\nimport { toast, useToast } from \"@/hooks/use-toast\";\n\nconst clearToasts = () => {\n  const { result, unmount } = renderHook(() => useToast());\n  act(() => {\n    result.current.dismiss();\n    jest.runOnlyPendingTimers();\n  });\n  unmount();\n};\n\nbeforeEach(() => {\n  jest.useFakeTimers({ doNotFake: [\"performance\"] });\n  clearToasts();\n});\n\nafterEach(() => {\n  clearToasts();\n  jest.useRealTimers();\n});\n\ndescribe(\"toast hook\", () => {\n  it(\"adds toasts and enforces the queue limit\", () => {\n    const { result, unmount } = renderHook(() => useToast());\n\n    act(() => {\n      toast({ title: \"First\" });\n    });\n\n    expect(result.current.toasts).toHaveLength(1);\n    expect(result.current.toasts[0].title).toBe(\"First\");\n\n    act(() => {\n      toast({ title: \"Second\" });\n    });\n\n    expect(result.current.toasts).toHaveLength(1);\n    expect(result.current.toasts[0].title).toBe(\"Second\");\n\n    unmount();\n  });\n\n  it(\"dismisses toasts and removes them after the timer elapses\", () => {\n    const { result, unmount } = renderHook(() => useToast());\n\n    let toastId = \"\";\n    act(() => {\n      toastId = toast({ title: \"Dismiss me\" }).id;\n    });\n\n    act(() => {\n      result.current.dismiss(toastId);\n    });\n\n    expect(result.current.toasts[0].open).toBe(false);\n\n    act(() => {\n      jest.runOnlyPendingTimers();\n    });\n\n    expect(result.current.toasts).toHaveLength(0);\n\n    unmount();\n  });\n\n  it(\"allows updating toast properties\", () => {\n    const { result, unmount } = renderHook(() => useToast());\n\n    act(() => {\n      const handle = toast({ title: \"Initial\", description: \"Original\" });\n      handle.update({ description: \"Updated\" } as any);\n    });\n\n    expect(result.current.toasts[0]).toMatchObject({\n      title: \"Initial\",\n      description: \"Updated\",\n    });\n\n    unmount();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/accordion.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/alert-dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/alert.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/app-sheet-modal.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/aspect-ratio.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/avatar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/badge.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":42,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":42,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n        success:\n          \"border-transparent bg-[hsl(var(--success-bg))] text-[hsl(var(--success-foreground))]\",\n        warning:\n          \"border-transparent bg-[hsl(var(--warning-bg))] text-[hsl(var(--warning-foreground))]\",\n        info:\n          \"border-transparent bg-[hsl(var(--info-bg))] text-[hsl(var(--info-foreground))]\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/breadcrumb.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/button.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":60,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":60,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground hover:text-white\",\n        link: \"text-accent underline-offset-4 hover:underline\",\n        cta: \"bg-accent text-accent-foreground hover:bg-accent/90 h-11 px-6 rounded-md border border-input shadow-sm transition-colors\",\n        dangerOutline: \"border border-destructive text-destructive hover:bg-destructive/10\",\n        chip:\n          \"bg-transparent text-current hover:bg-transparent hover:text-current shadow-none\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/carousel.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/chart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/checkbox.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/collapsible.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/command.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":24,"column":11,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":24,"endColumn":29,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[701,752],"text":"type CommandDialogProps = DialogProps"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\ninterface CommandDialogProps extends DialogProps {}\n\nconst CommandDialog = ({ children, ...props }: CommandDialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/context-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/data-table-container.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/data-table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/date-time-picker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/dialog.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/drawer.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/dropdown-menu.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/form.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":168,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":168,"endColumn":15}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  ControllerProps,\n  FieldPath,\n  FieldValues,\n  FormProvider,\n  useFormContext,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message) : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/hover-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/icon-action-button-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/icon-action-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/input-otp.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/input.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/kpi-card.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/kpi-presets.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/label.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/loading-presets.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/loading-skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/long-press-button.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/menubar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/navigation-menu.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":119,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":119,"endColumn":29}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/page-header.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/pagination.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/popover.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/progress-bar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/progress.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/radio-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/resizable.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/scroll-area.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/segmented-control.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook React.useCallback has an unnecessary dependency: 'indicatorInset'. Either exclude it or remove the dependency array.","line":75,"column":6,"nodeType":"ArrayExpression","endLine":75,"endColumn":29,"suggestions":[{"desc":"Update the dependencies array to be: [value]","fix":{"range":[2062,2085],"text":"[value]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\";\n\nimport { cn } from \"@/lib/utils\";\nimport { Tooltip, TooltipContent, TooltipProvider, TooltipTrigger } from \"@/components/ui/tooltip\";\n\ntype SegmentedSize = \"sm\" | \"md\";\n\nexport interface SegmentedOption {\n  value: string;\n  label: React.ReactNode;\n  ariaLabel?: string;\n  disabled?: boolean;\n  tooltip?: React.ReactNode;\n}\n\nexport interface SegmentedControlProps\n  extends React.HTMLAttributes<HTMLDivElement> {\n  value: string;\n  onValueChange: (value: string) => void;\n  options: SegmentedOption[];\n  size?: SegmentedSize;\n}\n\nconst sizeClasses: Record<SegmentedSize, { container: string; item: string }> = {\n  sm: {\n    container: \"p-1 gap-1\",\n    item: \"px-3 py-1 text-xs\",\n  },\n  md: {\n    container: \"p-1.5 gap-1.5\",\n    item: \"px-4 py-1.5 text-sm\",\n  },\n};\n\nconst indicatorOffsets: Record<SegmentedSize, number> = {\n  sm: 2,\n  md: 3,\n};\n\nexport const SegmentedControl = React.forwardRef<\n  HTMLDivElement,\n  SegmentedControlProps\n>(({ value, onValueChange, options, size = \"md\", className, ...rest }, ref) => {\n  const containerRef = React.useRef<HTMLDivElement | null>(null);\n  const mergedRef = React.useCallback(\n    (node: HTMLDivElement | null) => {\n      containerRef.current = node;\n      if (typeof ref === \"function\") {\n        ref(node);\n      } else if (ref) {\n        (ref as React.MutableRefObject<HTMLDivElement | null>).current = node;\n      }\n    },\n    [ref],\n  );\n\n  const buttonRefs = React.useRef<Record<string, HTMLButtonElement | null>>({});\n  const sizeStyle = sizeClasses[size];\n  const indicatorInset = indicatorOffsets[size];\n  const [indicatorStyle, setIndicatorStyle] = React.useState<{\n    width: number;\n    left: number;\n  }>({ width: 0, left: 0 });\n\n  const updateIndicator = React.useCallback(() => {\n    const container = containerRef.current;\n    const activeButton = buttonRefs.current[value];\n    if (!container || !activeButton) return;\n    const width = activeButton.offsetWidth;\n    const left = activeButton.offsetLeft;\n    setIndicatorStyle({\n      width,\n      left,\n    });\n  }, [indicatorInset, value]);\n\n  React.useLayoutEffect(() => {\n    updateIndicator();\n  }, [updateIndicator, options]);\n\n  React.useEffect(() => {\n    window.addEventListener(\"resize\", updateIndicator);\n    return () => window.removeEventListener(\"resize\", updateIndicator);\n  }, [updateIndicator]);\n\n  return (\n    <TooltipProvider delayDuration={150}>\n      <div\n        ref={mergedRef}\n        role=\"group\"\n        className={cn(\n          \"relative inline-flex items-center rounded-full bg-muted/80 shadow-inner\",\n          sizeStyle.container,\n          className,\n        )}\n        {...rest}\n      >\n        <span\n          aria-hidden=\"true\"\n          className=\"pointer-events-none absolute rounded-full border border-border/40 bg-white shadow-sm transition-all duration-200 ease-out dark:border-slate-700 dark:bg-slate-900\"\n          style={{\n            width: indicatorStyle.width || 0,\n            left: indicatorStyle.left,\n            opacity: indicatorStyle.width ? 1 : 0,\n            top: indicatorInset,\n            bottom: indicatorInset,\n          }}\n        />\n        {options.map((option) => {\n          const isActive = option.value === value;\n          const button = (\n            <button\n              ref={(node) => {\n                buttonRefs.current[option.value] = node;\n              }}\n              type=\"button\"\n              disabled={option.disabled}\n              aria-pressed={isActive}\n              aria-label={option.ariaLabel}\n              onClick={() => {\n                if (option.disabled) return;\n                onValueChange(option.value);\n              }}\n              className={cn(\n                \"relative z-10 inline-flex items-center gap-1.5 rounded-full font-medium leading-none transition-colors duration-150 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/40 focus-visible:ring-offset-2 focus-visible:ring-offset-background\",\n                sizeStyle.item,\n                option.disabled && \"pointer-events-none opacity-50\",\n                isActive\n                  ? \"text-foreground\"\n                  : \"text-muted-foreground hover:text-foreground\",\n              )}\n            >\n              {option.label}\n            </button>\n          );\n\n          if (option.tooltip) {\n            return (\n              <Tooltip key={option.value}>\n                <TooltipTrigger asChild>{button}</TooltipTrigger>\n                <TooltipContent className=\"max-w-xs text-sm leading-snug\">\n                  {option.tooltip}\n                </TooltipContent>\n              </Tooltip>\n            );\n          }\n\n          return (\n            <React.Fragment key={option.value}>\n              {button}\n            </React.Fragment>\n          );\n        })}\n      </div>\n    </TooltipProvider>\n  );\n});\n\nSegmentedControl.displayName = \"SegmentedControl\";\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/select.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/selectable-pill.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":17,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":17,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[717,720],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[717,720],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { forwardRef, type KeyboardEventHandler } from \"react\";\nimport { Trash2 } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\n\ninterface SelectablePillProps extends React.ButtonHTMLAttributes<HTMLButtonElement> {\n  selected?: boolean;\n  onRemove?: () => void;\n  removeLabel?: string;\n  disableRemoveTooltip?: boolean;\n}\n\nexport const SelectablePill = forwardRef<HTMLButtonElement, SelectablePillProps>(\n  ({ children, className, selected = false, onRemove, removeLabel, onClick, onKeyDown, ...props }, ref) => {\n    const handleKeyDown: KeyboardEventHandler<HTMLButtonElement> = (event) => {\n      if (event.key === \"Enter\" || event.key === \" \") {\n        event.preventDefault();\n        onClick?.(event as any);\n      }\n      onKeyDown?.(event);\n    };\n\n    return (\n      <button\n        ref={ref}\n        type=\"button\"\n        aria-pressed={selected}\n        onClick={onClick}\n        onKeyDown={handleKeyDown}\n        className={cn(\n          \"group inline-flex items-center gap-2 rounded-full border px-3 py-1 text-xs font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n          selected\n            ? \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\"\n            : \"border-border bg-white text-slate-700 hover:bg-slate-100\",\n          className\n        )}\n        {...props}\n      >\n        <span className=\"truncate\">{children}</span>\n        {onRemove ? (\n          <span\n            role=\"button\"\n            tabIndex={-1}\n            onClick={(event) => {\n              event.stopPropagation();\n              onRemove();\n            }}\n            onKeyDown={(event) => {\n              if (event.key === \"Enter\" || event.key === \" \") {\n                event.preventDefault();\n                event.stopPropagation();\n                onRemove();\n              }\n            }}\n            aria-label={removeLabel}\n            className={cn(\n              \"ml-1 inline-flex h-5 w-5 items-center justify-center rounded-full transition-colors\",\n              selected ? \"hover:bg-white/30\" : \"hover:bg-slate-900/10\"\n            )}\n          >\n            <Trash2 className=\"h-3.5 w-3.5 opacity-70\" aria-hidden />\n          </span>\n        ) : null}\n      </button>\n    );\n  }\n);\n\nSelectablePill.displayName = \"SelectablePill\";\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/separator.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/sheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/sidebar.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":1204,"column":3,"nodeType":"Identifier","messageId":"namedExport","endLine":1204,"endColumn":13}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport { Sheet, SheetContent } from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\nimport { useTranslation } from \"react-i18next\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar:state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContext = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContext | null>(null)\n\ntype SidebarMenuHoverContextValue = {\n  hoveringMenuId: string | null\n  setHoveringMenuId: (id: string | null) => void\n}\n\nconst SidebarMenuHoverContext = React.createContext<\n  SidebarMenuHoverContextValue | null\n>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n    const [hoveringMenuId, setHoveringMenuId] = React.useState<string | null>(\n      null\n    )\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContext>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    const hoverContextValue = React.useMemo<SidebarMenuHoverContextValue>(\n      () => ({ hoveringMenuId, setHoveringMenuId }),\n      [hoveringMenuId]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <SidebarMenuHoverContext.Provider value={hoverContextValue}>\n          <TooltipProvider delayDuration={0}>\n            <div\n              style={\n                {\n                  \"--sidebar-width\": SIDEBAR_WIDTH,\n                  \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                  ...style,\n                } as React.CSSProperties\n              }\n              className={cn(\n                \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n                className\n              )}\n              ref={ref}\n              {...props}\n            >\n              {children}\n            </div>\n          </TooltipProvider>\n        </SidebarMenuHoverContext.Provider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden md:block text-sidebar-foreground\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n  const { t } = useTranslation(\"common\")\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">{t(\"sidebar.toggle\")}</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n  const { t } = useTranslation(\"common\")\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label={t(\"sidebar.toggle\")}\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title={t(\"sidebar.toggle\")}\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex min-h-svh flex-1 flex-col bg-background\",\n        \"peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\ntype SidebarMenuHighlightMode = \"active\" | \"hover\"\n\ninterface SidebarMenuHighlightContextValue {\n  setActive: (node: HTMLElement | null) => void\n  unsetActive: (node: HTMLElement | null) => void\n  setHover: (node: HTMLElement | null) => void\n  clearHover: (node: HTMLElement | null) => void\n  unregister: (node: HTMLElement | null) => void\n}\n\nconst SidebarMenuHighlightContext =\n  React.createContext<SidebarMenuHighlightContextValue | null>(null)\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, children, ...props }, ref) => {\n  const menuRef = React.useRef<HTMLUListElement | null>(null)\n  const activeNodeRef = React.useRef<HTMLElement | null>(null)\n  const hoverNodeRef = React.useRef<HTMLElement | null>(null)\n  const rafRef = React.useRef<number | null>(null)\n  const hoverContext = React.useContext(SidebarMenuHoverContext)\n  const menuId = React.useId()\n  const [indicator, setIndicator] = React.useState<{\n    x: number\n    y: number\n    width: number\n    height: number\n    borderRadius: string\n    opacity: number\n    mode: SidebarMenuHighlightMode\n  }>({\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    borderRadius: \"0px\",\n    opacity: 0,\n    mode: \"active\",\n  })\n\n  const applyIndicator = React.useCallback(\n    (node: HTMLElement, mode: SidebarMenuHighlightMode) => {\n      if (!menuRef.current) return\n\n      const menuRect = menuRef.current.getBoundingClientRect()\n      const nodeRect = node.getBoundingClientRect()\n      const styles = window.getComputedStyle(node)\n\n      setIndicator({\n        x: nodeRect.left - menuRect.left + menuRef.current.scrollLeft,\n        y: nodeRect.top - menuRect.top + menuRef.current.scrollTop,\n        width: nodeRect.width,\n        height: nodeRect.height,\n        borderRadius: styles.borderRadius,\n        opacity: mode === \"hover\" ? 0.92 : 1,\n        mode,\n      })\n    },\n    []\n  )\n\n  const scheduleIndicator = React.useCallback(\n    (node: HTMLElement, mode: SidebarMenuHighlightMode) => {\n      if (!menuRef.current) return\n      if (rafRef.current) {\n        cancelAnimationFrame(rafRef.current)\n      }\n      rafRef.current = window.requestAnimationFrame(() => {\n        applyIndicator(node, mode)\n      })\n    },\n    [applyIndicator]\n  )\n\n  const resetIndicator = React.useCallback(() => {\n    if (rafRef.current) {\n      cancelAnimationFrame(rafRef.current)\n      rafRef.current = null\n    }\n    setIndicator((prev) => ({\n      ...prev,\n      opacity: 0,\n    }))\n  }, [])\n\n  const setActive = React.useCallback(\n    (node: HTMLElement | null) => {\n      activeNodeRef.current = node\n      if (!node) {\n        if (!hoverNodeRef.current) {\n          resetIndicator()\n        }\n        return\n      }\n      if (hoverNodeRef.current && hoverNodeRef.current !== node) {\n        return\n      }\n      if (\n        hoverContext?.hoveringMenuId &&\n        hoverContext.hoveringMenuId !== menuId\n      ) {\n        return\n      }\n      scheduleIndicator(node, \"active\")\n    },\n    [hoverContext?.hoveringMenuId, menuId, resetIndicator, scheduleIndicator]\n  )\n\n  const unsetActive = React.useCallback(\n    (node: HTMLElement | null) => {\n      if (!node) return\n      if (activeNodeRef.current !== node) return\n      activeNodeRef.current = null\n      if (hoverNodeRef.current) {\n        scheduleIndicator(\n          hoverNodeRef.current,\n          hoverNodeRef.current === node ? \"active\" : \"hover\"\n        )\n      } else {\n        resetIndicator()\n      }\n    },\n    [resetIndicator, scheduleIndicator]\n  )\n\n  const setHover = React.useCallback(\n    (node: HTMLElement | null) => {\n      hoverNodeRef.current = node\n      if (!node) {\n        if (activeNodeRef.current) {\n          scheduleIndicator(activeNodeRef.current, \"active\")\n        } else {\n          resetIndicator()\n        }\n        if (hoverContext?.hoveringMenuId === menuId) {\n          hoverContext.setHoveringMenuId(null)\n        }\n        return\n      }\n      hoverContext?.setHoveringMenuId(menuId)\n      const mode =\n        activeNodeRef.current && activeNodeRef.current === node\n          ? \"active\"\n          : \"hover\"\n      scheduleIndicator(node, mode)\n    },\n    [hoverContext, menuId, resetIndicator, scheduleIndicator]\n  )\n\n  const clearHover = React.useCallback(\n    (node: HTMLElement | null) => {\n      if (!node) return\n      if (hoverNodeRef.current !== node) return\n      hoverNodeRef.current = null\n      if (hoverContext?.hoveringMenuId === menuId) {\n        hoverContext.setHoveringMenuId(null)\n      }\n      if (activeNodeRef.current) {\n        scheduleIndicator(activeNodeRef.current, \"active\")\n      } else {\n        resetIndicator()\n      }\n    },\n    [hoverContext, menuId, resetIndicator, scheduleIndicator]\n  )\n\n  const unregister = React.useCallback(\n    (node: HTMLElement | null) => {\n      if (!node) return\n      if (hoverNodeRef.current === node) {\n        hoverNodeRef.current = null\n      }\n      if (activeNodeRef.current === node) {\n        activeNodeRef.current = null\n        if (hoverNodeRef.current) {\n          scheduleIndicator(\n            hoverNodeRef.current,\n            hoverNodeRef.current === node ? \"active\" : \"hover\"\n          )\n        } else {\n          resetIndicator()\n        }\n      }\n      if (hoverContext?.hoveringMenuId === menuId) {\n        hoverContext.setHoveringMenuId(null)\n      }\n    },\n    [hoverContext, menuId, resetIndicator, scheduleIndicator]\n  )\n\n  React.useEffect(() => {\n    return () => {\n      if (rafRef.current) {\n        cancelAnimationFrame(rafRef.current)\n      }\n    }\n  }, [])\n\n  React.useLayoutEffect(() => {\n    if (typeof window === \"undefined\") return\n\n    const handleResize = () => {\n      const target = hoverNodeRef.current ?? activeNodeRef.current\n      if (target && menuRef.current) {\n        scheduleIndicator(\n          target,\n          target === activeNodeRef.current ? \"active\" : \"hover\"\n        )\n      }\n    }\n\n    window.addEventListener(\"resize\", handleResize)\n    return () => {\n      window.removeEventListener(\"resize\", handleResize)\n    }\n  }, [scheduleIndicator])\n\n  React.useLayoutEffect(() => {\n    const menu = menuRef.current\n    if (!menu || typeof ResizeObserver === \"undefined\") return\n\n    const observer = new ResizeObserver(() => {\n      const target = hoverNodeRef.current ?? activeNodeRef.current\n      if (target) {\n        scheduleIndicator(\n          target,\n          target === activeNodeRef.current ? \"active\" : \"hover\"\n        )\n      }\n    })\n\n    observer.observe(menu)\n    return () => {\n      observer.disconnect()\n    }\n  }, [scheduleIndicator])\n\n  React.useEffect(() => {\n    if (!hoverContext) return\n    if (\n      hoverContext.hoveringMenuId &&\n      hoverContext.hoveringMenuId !== menuId &&\n      !hoverNodeRef.current\n    ) {\n      resetIndicator()\n      return\n    }\n    if (\n      (!hoverContext.hoveringMenuId ||\n        hoverContext.hoveringMenuId === menuId) &&\n      !hoverNodeRef.current &&\n      activeNodeRef.current\n    ) {\n      scheduleIndicator(activeNodeRef.current, \"active\")\n    }\n  }, [hoverContext, menuId, resetIndicator, scheduleIndicator])\n\n  const setMenuRef = React.useCallback(\n    (node: HTMLUListElement | null) => {\n      menuRef.current = node\n      if (typeof ref === \"function\") {\n        ref(node)\n      } else if (ref) {\n        ;(ref as React.MutableRefObject<HTMLUListElement | null>).current = node\n      }\n    },\n    [ref]\n  )\n\n  const contextValue = React.useMemo<SidebarMenuHighlightContextValue>(\n    () => ({\n      setActive,\n      unsetActive,\n      setHover,\n      clearHover,\n      unregister,\n    }),\n    [clearHover, setActive, setHover, unregister, unsetActive]\n  )\n\n  const handleMenuPointerLeave = React.useCallback(() => {\n    if (hoverNodeRef.current) {\n      setHover(null)\n      return\n    }\n\n    if (!hoverContext) {\n      return\n    }\n\n    if (hoverContext.hoveringMenuId !== menuId) {\n      return\n    }\n\n    hoverContext.setHoveringMenuId(null)\n    if (activeNodeRef.current) {\n      scheduleIndicator(activeNodeRef.current, \"active\")\n    } else {\n      resetIndicator()\n    }\n  }, [\n    hoverContext,\n    menuId,\n    resetIndicator,\n    scheduleIndicator,\n    setHover,\n  ])\n\n  return (\n    <SidebarMenuHighlightContext.Provider value={contextValue}>\n      <ul\n        ref={setMenuRef}\n        data-sidebar=\"menu\"\n        className={cn(\n          \"relative flex w-full min-w-0 flex-col gap-1\",\n          className\n        )}\n        onPointerLeave={handleMenuPointerLeave}\n        {...props}\n      >\n        <li\n          aria-hidden=\"true\"\n          data-sidebar=\"menu-highlight\"\n          className=\"pointer-events-none absolute left-0 top-0 z-0 list-none border border-[hsl(var(--accent-200))] bg-[linear-gradient(135deg,_hsl(var(--accent-100)),_hsl(var(--accent-300)))] shadow-[0_20px_36px_-26px_hsl(var(--accent-400)_/_0.85)] transition-[opacity,transform,width,height] duration-300 ease-out will-change-transform data-[mode=hover]:border-[hsl(var(--accent-300))] data-[mode=hover]:shadow-[0_24px_40px_-24px_hsl(var(--accent-400)_/_0.92)] data-[mode=active]:border-[hsl(var(--accent-300))] data-[mode=active]:shadow-[0_24px_40px_-24px_hsl(var(--accent-400)_/_0.92)]\"\n          data-mode={indicator.mode}\n          style={{\n            transform: `translate3d(${indicator.x}px, ${indicator.y}px, 0)`,\n            width: indicator.width ? `${indicator.width}px` : 0,\n            height: indicator.height ? `${indicator.height}px` : 0,\n            borderRadius: indicator.borderRadius,\n            opacity: indicator.opacity,\n          }}\n        />\n        {children}\n      </ul>\n    </SidebarMenuHighlightContext.Provider>\n  )\n})\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative z-10\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button relative z-[1] isolate flex w-full items-center gap-2 overflow-hidden rounded-xl px-3 py-2 text-left text-sm font-medium text-sidebar-foreground/85 outline-none ring-sidebar-ring transition-all duration-300 ease-out hover:translate-x-[4px] hover:text-sidebar-accent-foreground focus-visible:translate-x-[4px] focus-visible:ring-2 focus-visible:ring-offset-0 focus-visible:ring-[hsl(var(--accent-300))] active:translate-x-[2px] disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-9 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:font-semibold data-[active=true]:text-[hsl(var(--accent-900))] data-[state=open]:text-[hsl(var(--accent-900))] group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:transition-colors\",\n  {\n    variants: {\n      variant: {\n        default: \"\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))] data-[active=true]:shadow-[0_0_0_1px_hsl(var(--accent-300))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      onMouseEnter,\n      onMouseLeave,\n      onFocus,\n      onBlur,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n    const highlight = React.useContext(SidebarMenuHighlightContext)\n    const localRef =\n      React.useRef<HTMLButtonElement | HTMLAnchorElement | null>(null)\n    const lastAssignedRef = React.useRef<HTMLElement | null>(null)\n\n    const setRefs = React.useCallback(\n      (node: HTMLElement | null) => {\n        localRef.current = node as HTMLButtonElement | HTMLAnchorElement | null\n        if (node) {\n          lastAssignedRef.current = node\n        }\n\n        if (typeof ref === \"function\") {\n          ref(node as HTMLButtonElement | null)\n        } else if (ref) {\n          ;(ref as React.MutableRefObject<HTMLButtonElement | null>).current =\n            node as HTMLButtonElement | null\n        }\n      },\n      [ref]\n    )\n\n    React.useLayoutEffect(() => {\n      if (!highlight) return\n      const node = localRef.current as unknown as HTMLElement | null\n      if (!node) return\n\n      if (isActive) {\n        highlight.setActive(node)\n        return () => {\n          highlight.unsetActive(node)\n        }\n      }\n\n      highlight.unsetActive(node)\n    }, [highlight, isActive])\n\n    React.useEffect(() => {\n      if (!highlight) return\n      const node = lastAssignedRef.current\n      if (!node) return\n\n      return () => {\n        highlight.unregister(node)\n      }\n    }, [highlight])\n\n    const handleMouseEnter = React.useCallback(\n      (event: React.MouseEvent<HTMLElement>) => {\n        onMouseEnter?.(event as React.MouseEvent<HTMLButtonElement>)\n        if (highlight && localRef.current) {\n          highlight.setHover(localRef.current as unknown as HTMLElement)\n        }\n      },\n      [highlight, onMouseEnter]\n    )\n\n    const handleMouseLeave = React.useCallback(\n      (event: React.MouseEvent<HTMLElement>) => {\n        onMouseLeave?.(event as React.MouseEvent<HTMLButtonElement>)\n        if (highlight && localRef.current) {\n          highlight.clearHover(localRef.current as unknown as HTMLElement)\n        }\n      },\n      [highlight, onMouseLeave]\n    )\n\n    const handleFocus = React.useCallback(\n      (event: React.FocusEvent<HTMLElement>) => {\n        onFocus?.(event as React.FocusEvent<HTMLButtonElement>)\n        if (highlight && localRef.current) {\n          highlight.setHover(localRef.current as unknown as HTMLElement)\n        }\n      },\n      [highlight, onFocus]\n    )\n\n    const handleBlur = React.useCallback(\n      (event: React.FocusEvent<HTMLElement>) => {\n        onBlur?.(event as React.FocusEvent<HTMLButtonElement>)\n        if (highlight && localRef.current) {\n          highlight.clearHover(localRef.current as unknown as HTMLElement)\n        }\n      },\n      [highlight, onBlur]\n    )\n\n    const button = (\n      <Comp\n        ref={setRefs}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        onMouseEnter={handleMouseEnter}\n        onMouseLeave={handleMouseLeave}\n        onFocus={handleFocus}\n        onBlur={handleBlur}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"rounded-md h-8 flex gap-2 px-2 items-center\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 flex-1 max-w-[--skeleton-width]\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/skeleton.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/slider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/sonner.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":29,"column":19,"nodeType":"Identifier","messageId":"namedExport","endLine":29,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useTheme } from \"next-themes\"\nimport { Toaster as Sonner, toast } from \"sonner\"\n\ntype ToasterProps = React.ComponentProps<typeof Sonner>\n\nconst Toaster = ({ ...props }: ToasterProps) => {\n  const { theme = \"system\" } = useTheme()\n\n  return (\n    <Sonner\n      theme={theme as ToasterProps[\"theme\"]}\n      className=\"toaster group\"\n      toastOptions={{\n        classNames: {\n          toast:\n            \"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg\",\n          description: \"group-[.toast]:text-muted-foreground\",\n          actionButton:\n            \"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground\",\n          cancelButton:\n            \"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground\",\n        },\n      }}\n      {...props}\n    />\n  )\n}\n\nexport { Toaster, toast }\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/switch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/table.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/tabs.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/textarea.tsx","messages":[{"ruleId":"@typescript-eslint/no-empty-object-type","severity":2,"message":"An interface declaring no members is equivalent to its supertype.","line":5,"column":18,"nodeType":"Identifier","messageId":"noEmptyInterfaceWithSuper","endLine":5,"endColumn":31,"suggestions":[{"messageId":"replaceEmptyInterfaceWithSuper","fix":{"range":[73,159],"text":"type TextareaProps = React.TextareaHTMLAttributes<HTMLTextAreaElement>"},"desc":"Replace empty interface with a type alias."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nexport interface TextareaProps\n  extends React.TextareaHTMLAttributes<HTMLTextAreaElement> {}\n\nconst Textarea = React.forwardRef<HTMLTextAreaElement, TextareaProps>(\n  ({ className, ...props }, ref) => {\n    return (\n      <textarea\n        className={cn(\n          \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/time-picker.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/toast.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/toaster.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/toggle-group.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/toggle-section.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/toggle.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":43,"column":18,"nodeType":"Identifier","messageId":"namedExport","endLine":43,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3\",\n        sm: \"h-9 px-2.5\",\n        lg: \"h-11 px-5\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/tooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/components/ui/use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/constants/entityConstants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/constants/onboarding.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/AuthContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":149,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":149,"endColumn":24}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, ReactNode } from 'react';\nimport { User, Session } from '@supabase/supabase-js';\nimport { supabase } from '@/integrations/supabase/client';\n\ntype UserRole = 'admin' | 'support' | 'user';\n\ninterface AuthContextType {\n  user: User | null;\n  session: Session | null;\n  userRoles: UserRole[];\n  loading: boolean;\n  signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\n\nexport function AuthProvider({ children }: { children: ReactNode }) {\n  const [user, setUser] = useState<User | null>(null);\n  const [session, setSession] = useState<Session | null>(null);\n  const [userRoles, setUserRoles] = useState<UserRole[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [initialized, setInitialized] = useState(false);\n\n  const fetchUserRoles = async (userId: string) => {\n    try {\n      const { data: roles, error } = await supabase\n        .rpc('get_user_roles', { user_uuid: userId });\n      \n      if (error) {\n        console.error('Error fetching user roles:', error);\n        return [];\n      }\n      \n      return roles || [];\n    } catch (error) {\n      console.error('Error fetching user roles:', error);\n      return [];\n    }\n  };\n\n  const signOut = async () => {\n    try {\n      // Clear everything first\n      localStorage.clear();\n      setUser(null);\n      setSession(null);\n      setUserRoles([]);\n      \n      // Then sign out\n      await supabase.auth.signOut({ scope: 'global' });\n      \n      // Use window navigation for auth redirect\n      window.location.href = '/auth';\n    } catch (error) {\n      console.error('Sign out error:', error);\n      // Force reload anyway\n      window.location.href = '/auth';\n    }\n  };\n\n  useEffect(() => {\n    console.log('AuthProvider initializing...');\n    \n    let isMounted = true;\n\n    const initializeAuth = async () => {\n      try {\n        // Get current session\n        const { data: { session }, error } = await supabase.auth.getSession();\n        \n        if (error) {\n          console.error('Session error:', error);\n        }\n\n        if (isMounted && !initialized) {\n          console.log('Setting initial auth state:', session?.user?.id || 'no user');\n          setSession(session);\n          setUser(session?.user ?? null);\n          \n          // Fetch user roles if user exists\n          if (session?.user) {\n            setTimeout(async () => {\n              const roles = await fetchUserRoles(session.user.id);\n              if (isMounted) {\n                setUserRoles(roles);\n              }\n            }, 0);\n          }\n          \n          setLoading(false);\n          setInitialized(true);\n        }\n      } catch (error) {\n        console.error('Auth initialization error:', error);\n        if (isMounted) {\n          setLoading(false);\n          setInitialized(true);\n        }\n      }\n    };\n\n    // Set up auth state listener\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      async (event, session) => {\n        console.log('Auth state change:', event, session?.user?.id || 'no user');\n        \n        if (isMounted) {\n          setSession(session);\n          setUser(session?.user ?? null);\n          \n          // Fetch user roles if user exists\n          if (session?.user) {\n            setTimeout(async () => {\n              const roles = await fetchUserRoles(session.user.id);\n              if (isMounted) {\n                setUserRoles(roles);\n              }\n            }, 0);\n          } else {\n            setUserRoles([]);\n          }\n          \n          // Only set loading to false if we haven't initialized yet\n          if (!initialized) {\n            setLoading(false);\n            setInitialized(true);\n          }\n        }\n      }\n    );\n\n    // Initialize auth state\n    initializeAuth();\n\n    return () => {\n      console.log('AuthProvider cleanup...');\n      isMounted = false;\n      subscription.unsubscribe();\n    };\n  }, [initialized]);\n\n  return (\n    <AuthContext.Provider value={{ user, session, userRoles, loading, signOut }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/ConnectivityContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/LanguageContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/OnboardingContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":203,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":203,"endColumn":30}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useMemo } from \"react\";\nimport { useUserPreferences } from \"@/hooks/useUserPreferences\";\nimport { ONBOARDING_STEPS, TOTAL_STEPS, OnboardingStage } from \"@/constants/onboarding\";\n\ninterface OnboardingContextValue {\n  // State\n  stage: OnboardingStage;\n  currentStep: number;\n  loading: boolean;\n  \n  // Computed values (memoized for performance)\n  shouldShowWelcomeModal: boolean;\n  isInGuidedSetup: boolean;\n  isOnboardingComplete: boolean;\n  shouldLockNavigation: boolean;\n  \n  // Step information\n  currentStepInfo: (typeof ONBOARDING_STEPS)[number] | null;\n  nextStepInfo: (typeof ONBOARDING_STEPS)[number] | null;\n  completedSteps: (typeof ONBOARDING_STEPS)[number][];\n  isAllStepsComplete: boolean;\n  totalSteps: number;\n  \n  // Actions\n  startGuidedSetup: () => Promise<void>;\n  completeCurrentStep: () => Promise<void>;\n  completeMultipleSteps: (numberOfSteps: number) => Promise<void>;\n  completeOnboarding: () => Promise<void>;\n  skipOnboarding: () => Promise<void>;\n  resetOnboarding: () => Promise<void>;\n}\n\nconst OnboardingContext = createContext<OnboardingContextValue | null>(null);\n\nexport function OnboardingProvider({ children }: { children: React.ReactNode }) {\n  const { data: preferences, isLoading, updatePreferences } = useUserPreferences();\n\n  // Memoized computed values to prevent excessive recalculations\n  const computedValues = useMemo(() => {\n    if (!preferences || isLoading) {\n      return {\n        shouldShowWelcomeModal: false,\n        isInGuidedSetup: false,\n        isOnboardingComplete: false,\n        shouldLockNavigation: false,\n        currentStepInfo: null,\n        nextStepInfo: null,\n        completedSteps: [],\n        isAllStepsComplete: false\n      };\n    }\n\n    const { onboardingStage, currentOnboardingStep, welcomeModalShown } = preferences;\n\n    // BULLETPROOF: Modal shows ONLY if user has NEVER seen it\n    const shouldShowWelcomeModal = onboardingStage === 'not_started' && !welcomeModalShown;\n    \n    const isInGuidedSetup = onboardingStage === 'in_progress';\n    \n    const isOnboardingComplete = onboardingStage === 'completed' || onboardingStage === 'skipped';\n    \n    const shouldLockNavigation = onboardingStage === 'in_progress';\n\n    // Step information\n    const currentStepInfo = isInGuidedSetup && currentOnboardingStep >= 1 && currentOnboardingStep <= TOTAL_STEPS\n      ? ONBOARDING_STEPS[currentOnboardingStep - 1]\n      : null;\n\n    const nextStepInfo = isInGuidedSetup && currentOnboardingStep < TOTAL_STEPS\n      ? ONBOARDING_STEPS[currentOnboardingStep]\n      : null;\n\n    const completedSteps = isInGuidedSetup \n      ? ONBOARDING_STEPS.slice(0, currentOnboardingStep - 1)\n      : [];\n\n    const isAllStepsComplete = isInGuidedSetup && currentOnboardingStep > TOTAL_STEPS;\n\n    return {\n      shouldShowWelcomeModal,\n      isInGuidedSetup,\n      isOnboardingComplete,\n      shouldLockNavigation,\n      currentStepInfo,\n      nextStepInfo,\n      completedSteps,\n      isAllStepsComplete\n    };\n  }, [preferences, isLoading]);\n\n  // Action functions\n  const startGuidedSetup = async () => {\n    if (!preferences) return;\n    \n    // Starting guided setup - modal disabled for improved performance\n    \n    await updatePreferences({\n      onboardingStage: 'in_progress',\n      currentOnboardingStep: 1,\n      welcomeModalShown: true // PERMANENT - NEVER reset\n    });\n  };\n\n  const completeCurrentStep = async () => {\n    if (!preferences || preferences.onboardingStage !== 'in_progress') {\n      console.warn(\"🚫 completeCurrentStep: Cannot complete - not in progress\");\n      return;\n    }\n\n    const nextStep = preferences.currentOnboardingStep + 1;\n    // Completing current step and advancing to next\n\n    // Bulletproof: Prevent completing beyond total steps\n    if (preferences.currentOnboardingStep >= TOTAL_STEPS) {\n      console.warn(\"🚫 completeCurrentStep: Attempted to complete step beyond total steps\");\n      return;\n    }\n\n    await updatePreferences({\n      currentOnboardingStep: nextStep\n    });\n  };\n\n  const completeMultipleSteps = async (numberOfSteps: number) => {\n    if (!preferences || preferences.onboardingStage !== 'in_progress') {\n      console.warn(\"🚫 completeMultipleSteps: Cannot complete - not in progress\");\n      return;\n    }\n\n    const targetStep = preferences.currentOnboardingStep + numberOfSteps;\n    // Completing multiple steps in batch\n\n    // Prevent completing beyond total steps\n    if (preferences.currentOnboardingStep >= TOTAL_STEPS) {\n      console.warn(\"🚫 completeMultipleSteps: Already at or beyond total steps\");\n      return;\n    }\n\n    const finalStep = Math.min(targetStep, TOTAL_STEPS + 1);\n    \n    await updatePreferences({\n      currentOnboardingStep: finalStep\n    });\n  };\n\n  const completeOnboarding = async () => {\n    if (!preferences) return;\n\n    // Completing onboarding process\n    \n    await updatePreferences({\n      onboardingStage: 'completed',\n      currentOnboardingStep: TOTAL_STEPS + 1\n    });\n  };\n\n  const skipOnboarding = async () => {\n    if (!preferences) return;\n\n    await updatePreferences({\n      onboardingStage: 'skipped'\n    });\n  };\n\n  const resetOnboarding = async () => {\n    if (!preferences) return;\n\n    // Resetting onboarding to guided mode\n    \n    await updatePreferences({\n      onboardingStage: 'in_progress',\n      currentOnboardingStep: 1,\n      welcomeModalShown: true // Keep modal permanently disabled\n    });\n  };\n\n  const contextValue: OnboardingContextValue = {\n    // State\n    stage: preferences?.onboardingStage || 'not_started',\n    currentStep: preferences?.currentOnboardingStep || 1,\n    loading: isLoading,\n    \n    // Computed values (memoized)\n    ...computedValues,\n    totalSteps: TOTAL_STEPS,\n    \n    // Actions\n    startGuidedSetup,\n    completeCurrentStep,\n    completeMultipleSteps,\n    completeOnboarding,\n    skipOnboarding,\n    resetOnboarding\n  };\n\n  return (\n    <OnboardingContext.Provider value={contextValue}>\n      {children}\n    </OnboardingContext.Provider>\n  );\n}\n\nexport function useOnboarding(): OnboardingContextValue {\n  const context = useContext(OnboardingContext);\n  if (!context) {\n    throw new Error(\"useOnboarding must be used within an OnboardingProvider\");\n  }\n  return context;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/OrganizationContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":27,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":27,"endColumn":32}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, ReactNode, useCallback } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useToast } from '@/hooks/use-toast';\nimport { useQueryClient } from '@tanstack/react-query';\nimport { detectBrowserTimezone } from '@/lib/dateFormatUtils';\nimport {\n  fetchOrganizationSettingsWithCache,\n  ORGANIZATION_SETTINGS_CACHE_TTL,\n} from '@/lib/organizationSettingsCache';\n\ninterface Organization {\n  id: string;\n  name: string;\n  owner_id: string;\n}\n\ninterface OrganizationContextType {\n  activeOrganizationId: string | null;\n  activeOrganization: Organization | null;\n  loading: boolean;\n  refreshOrganization: () => Promise<void>;\n  setActiveOrganization: (orgId: string) => Promise<void>;\n}\n\nconst OrganizationContext = createContext<OrganizationContextType | undefined>(undefined);\n\nexport function useOrganization() {\n  const context = useContext(OrganizationContext);\n  if (context === undefined) {\n    throw new Error('useOrganization must be used within an OrganizationProvider');\n  }\n  return context;\n}\n\ninterface OrganizationProviderProps {\n  children: ReactNode;\n}\n\nexport function OrganizationProvider({ children }: OrganizationProviderProps) {\n  const [activeOrganizationId, setActiveOrganizationId] = useState<string | null>(null);\n  const [activeOrganization, setActiveOrganization] = useState<Organization | null>(null);\n  const [loading, setLoading] = useState(true);\n  const { toast } = useToast();\n  const queryClient = useQueryClient();\n\n  const fetchActiveOrganization = async () => {\n    try {\n      setLoading(true);\n      \n      // Use the organization utils function\n      const { getUserOrganizationId } = await import('@/lib/organizationUtils');\n      const orgId = await getUserOrganizationId();\n      \n      if (!orgId) {\n        setActiveOrganizationId(null);\n        setActiveOrganization(null);\n        return;\n      }\n\n      // Fetch organization details\n      const { data: org, error: orgDetailsError } = await supabase\n        .from('organizations')\n        .select('id, name, owner_id')\n        .eq('id', orgId)\n        .single();\n\n      if (orgDetailsError) {\n        console.error('Error getting organization details:', orgDetailsError);\n        return;\n      }\n\n      setActiveOrganizationId(orgId);\n      setActiveOrganization(org);\n    } catch (error) {\n      console.error('Error in fetchActiveOrganization:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const refreshOrganization = async () => {\n    await fetchActiveOrganization();\n  };\n\n  const setActiveOrganizationHandler = async (orgId: string) => {\n    // In single-photographer model, organization is determined by ownership\n    // No need to update user settings since getUserOrganizationId handles this\n    console.log('Organization switch not needed in single-photographer mode:', orgId);\n    \n    // Just refresh the organization data\n    await refreshOrganization();\n    \n    toast({\n      title: \"Success\", \n      description: \"Organization data refreshed\",\n    });\n  };\n\n  // Set up simplified presence tracking for single-photographer\n  useEffect(() => {\n    let presenceInterval: ReturnType<typeof setInterval> | null = null;\n\n    const setupPresence = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (!user || !activeOrganizationId) return;\n\n      // Simple periodic activity update - no complex presence channels needed\n      presenceInterval = setInterval(async () => {\n        try {\n          // Just update user_settings to show activity\n          await supabase\n            .from('user_settings')\n            .update({ updated_at: new Date().toISOString() })\n            .eq('user_id', user.id);\n        } catch (error) {\n          console.warn('Failed to update activity timestamp:', error);\n        }\n      }, 300000); // Update every 5 minutes\n    };\n\n    if (activeOrganizationId) {\n      setupPresence();\n    }\n\n    return () => {\n      if (presenceInterval) {\n        clearInterval(presenceInterval);\n      }\n    };\n  }, [activeOrganizationId]);\n\n  // Initialize on mount and when auth state changes\n  useEffect(() => {\n    const initializeOrganization = async () => {\n      const { data: { user } } = await supabase.auth.getUser();\n      if (user) {\n        await fetchActiveOrganization();\n      } else {\n        setActiveOrganizationId(null);\n        setActiveOrganization(null);\n        setLoading(false);\n      }\n    };\n\n    initializeOrganization();\n\n    // Listen for auth state changes\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(\n      (event, session) => {\n        if (event === 'SIGNED_IN' && session) {\n          fetchActiveOrganization();\n        } else if (event === 'SIGNED_OUT') {\n          setActiveOrganizationId(null);\n          setActiveOrganization(null);\n          setLoading(false);\n        }\n      }\n    );\n\n    return () => {\n      subscription.unsubscribe();\n    };\n  }, []);\n\n  // Prefetch common organization-scoped data to speed up first paint across pages\n  const prefetchOrgData = useCallback(async (orgId: string) => {\n    const tasks: Array<Promise<unknown>> = [];\n\n    // Project types\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['project_types', orgId],\n        queryFn: async () => {\n          const { data, error } = await supabase\n            .from('project_types')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('sort_order');\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Project statuses\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['project_statuses', orgId],\n        queryFn: async () => {\n          const { data, error } = await supabase\n            .from('project_statuses')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('sort_order');\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Services\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['services', orgId],\n        queryFn: async () => {\n          const { data, error } = await supabase\n            .from('services')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('name');\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Session statuses\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['session_statuses', orgId],\n        queryFn: async () => {\n          const { data, error } = await supabase\n            .from('session_statuses')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('sort_order');\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Lead statuses (used widely in leads and dialogs)\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['lead_statuses', orgId],\n        queryFn: async () => {\n          const { data, error } = await supabase\n            .from('lead_statuses')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('sort_order');\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Organization settings (cache aware)\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['organization_settings', orgId],\n        queryFn: async () => {\n          const detectedTimezone =\n            typeof window !== 'undefined' ? detectBrowserTimezone() : undefined;\n          return fetchOrganizationSettingsWithCache(orgId, {\n            detectedTimezone,\n          });\n        },\n        staleTime: ORGANIZATION_SETTINGS_CACHE_TTL,\n      })\n    );\n\n    // Packages (used by settings, dialogs)\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['packages', orgId],\n        queryFn: async () => {\n          const { data: user } = await supabase.auth.getUser();\n          if (!user.user) return [];\n          await supabase.rpc('ensure_default_packages_for_org', {\n            user_uuid: user.user.id,\n            org_id: orgId,\n          });\n          const { data, error } = await supabase\n            .from('packages')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('created_at', { ascending: false });\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Session types\n    tasks.push(\n      queryClient.prefetchQuery({\n        queryKey: ['session_types', orgId],\n        queryFn: async () => {\n          const { data: user } = await supabase.auth.getUser();\n          if (!user.user) return [];\n          await supabase.rpc('ensure_default_session_types_for_org', {\n            user_uuid: user.user.id,\n            org_id: orgId,\n          });\n          const { data, error } = await supabase\n            .from('session_types')\n            .select('*')\n            .eq('organization_id', orgId)\n            .order('sort_order', { ascending: true })\n            .order('name', { ascending: true });\n          if (error) throw error;\n          return data || [];\n        },\n        staleTime: 5 * 60 * 1000,\n      })\n    );\n\n    // Lead field definitions — not on React Query, seed localStorage for fast bootstrap\n    tasks.push((async () => {\n      try {\n        const { data: authUser } = await supabase.auth.getUser();\n        await supabase.rpc('ensure_default_lead_field_definitions', { org_id: orgId, user_uuid: authUser.user?.id });\n      } catch (error) {\n        console.warn('Failed to ensure default lead field definitions', error);\n      }\n      try {\n        const { data, error } = await supabase\n          .from('lead_field_definitions')\n          .select('*')\n          .eq('organization_id', orgId)\n          .order('sort_order', { ascending: true });\n        if (!error && data && typeof window !== 'undefined') {\n          try {\n            localStorage.setItem(`lead_field_definitions:${orgId}`, JSON.stringify(data));\n          } catch (storageError) {\n            console.warn('Failed to cache lead field definitions', storageError);\n          }\n        }\n      } catch (error) {\n        console.warn('Failed to preload lead field definitions', error);\n      }\n    })());\n\n    await Promise.allSettled(tasks);\n  }, [queryClient]);\n\n  // Trigger prefetch whenever org becomes available\n  useEffect(() => {\n    if (activeOrganizationId) {\n      prefetchOrgData(activeOrganizationId);\n    }\n  }, [activeOrganizationId, prefetchOrgData]);\n\n  return (\n    <OrganizationContext.Provider\n      value={{\n        activeOrganizationId,\n        activeOrganization,\n        loading,\n        refreshOrganization,\n        setActiveOrganization: setActiveOrganizationHandler,\n      }}\n    >\n      {children}\n    </OrganizationContext.Provider>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/PortalResetContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":17,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":17,"endColumn":31}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useCallback, useContext, useMemo, useState } from \"react\";\n\ninterface PortalResetContextValue {\n  resetKey: number;\n  reset: () => void;\n}\n\nconst PortalResetContext = createContext<PortalResetContextValue | undefined>(undefined);\n\nexport function PortalResetProvider({ children }: { children: React.ReactNode }) {\n  const [resetKey, setResetKey] = useState(0);\n  const reset = useCallback(() => setResetKey((k) => k + 1), []);\n  const value = useMemo(() => ({ resetKey, reset }), [resetKey, reset]);\n  return <PortalResetContext.Provider value={value}>{children}</PortalResetContext.Provider>;\n}\n\nexport function usePortalReset(): PortalResetContextValue {\n  const ctx = useContext(PortalResetContext);\n  return ctx ?? { resetKey: 0, reset: () => {} };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/ProfileContext.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/SettingsContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":31,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":31,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext, useState, ReactNode, useCallback } from \"react\";\n\ninterface CategoryChanges {\n  [sectionId: string]: {\n    sectionName: string;\n    isDirty: boolean;\n    saveHandler: () => Promise<void>;\n    cancelHandler: () => void;\n  };\n}\n\ninterface SettingsContextType {\n  dirtySections: Set<string>;\n  addDirtySection: (section: string) => void;\n  removeDirtySection: (section: string) => void;\n  clearAllDirtySections: () => void;\n  hasDirtySections: boolean;\n  // New category-based management\n  categoryChanges: { [categoryPath: string]: CategoryChanges };\n  registerSectionHandler: (categoryPath: string, sectionId: string, sectionName: string, saveHandler: () => Promise<void>, cancelHandler: () => void) => void;\n  unregisterSectionHandler: (categoryPath: string, sectionId: string) => void;\n  setSectionDirty: (categoryPath: string, sectionId: string, isDirty: boolean) => void;\n  getCategoryDirtySections: (categoryPath: string) => string[];\n  hasCategoryChanges: (categoryPath: string) => boolean;\n  saveCategoryChanges: (categoryPath: string) => Promise<void>;\n  cancelCategoryChanges: (categoryPath: string) => void;\n}\n\nconst SettingsContext = createContext<SettingsContextType | undefined>(undefined);\n\nexport function useSettingsContext() {\n  const context = useContext(SettingsContext);\n  if (!context) {\n    throw new Error(\"useSettingsContext must be used within a SettingsProvider\");\n  }\n  return context;\n}\n\ninterface SettingsProviderProps {\n  children: ReactNode;\n}\n\nexport function SettingsProvider({ children }: SettingsProviderProps) {\n  const [dirtySections, setDirtySections] = useState<Set<string>>(new Set());\n  const [categoryChanges, setCategoryChanges] = useState<{ [categoryPath: string]: CategoryChanges }>({});\n\n  const addDirtySection = (section: string) => {\n    setDirtySections(prev => new Set(prev).add(section));\n  };\n\n  const removeDirtySection = (section: string) => {\n    setDirtySections(prev => {\n      const newSet = new Set(prev);\n      newSet.delete(section);\n      return newSet;\n    });\n  };\n\n  const clearAllDirtySections = () => {\n    setDirtySections(new Set());\n  };\n\n  const hasDirtySections = dirtySections.size > 0;\n\n  const registerSectionHandler = useCallback((\n    categoryPath: string, \n    sectionId: string, \n    sectionName: string, \n    saveHandler: () => Promise<void>, \n    cancelHandler: () => void\n  ) => {\n    setCategoryChanges(prev => ({\n      ...prev,\n      [categoryPath]: {\n        ...prev[categoryPath],\n        [sectionId]: {\n          sectionName,\n          isDirty: false,\n          saveHandler,\n          cancelHandler\n        }\n      }\n    }));\n  }, []);\n\n  const unregisterSectionHandler = useCallback((categoryPath: string, sectionId: string) => {\n    setCategoryChanges(prev => {\n      const newCategory = { ...prev[categoryPath] };\n      delete newCategory[sectionId];\n      return {\n        ...prev,\n        [categoryPath]: newCategory\n      };\n    });\n  }, []);\n\n  const setSectionDirty = useCallback((categoryPath: string, sectionId: string, isDirty: boolean) => {\n    setCategoryChanges(prev => {\n      const section = prev[categoryPath]?.[sectionId];\n      if (!section) return prev;\n      \n      return {\n        ...prev,\n        [categoryPath]: {\n          ...prev[categoryPath],\n          [sectionId]: {\n            ...section,\n            isDirty\n          }\n        }\n      };\n    });\n  }, []);\n\n  const getCategoryDirtySections = useCallback((categoryPath: string) => {\n    const sections = categoryChanges[categoryPath] || {};\n    return Object.keys(sections).filter(sectionId => sections[sectionId].isDirty);\n  }, [categoryChanges]);\n\n  const hasCategoryChanges = useCallback((categoryPath: string) => {\n    return getCategoryDirtySections(categoryPath).length > 0;\n  }, [getCategoryDirtySections]);\n\n  const saveCategoryChanges = useCallback(async (categoryPath: string) => {\n    const sections = categoryChanges[categoryPath] || {};\n    const dirtySections = Object.entries(sections).filter(([_, section]) => section.isDirty);\n    \n    for (const [sectionId, section] of dirtySections) {\n      await section.saveHandler();\n      setSectionDirty(categoryPath, sectionId, false);\n    }\n  }, [categoryChanges, setSectionDirty]);\n\n  const cancelCategoryChanges = useCallback((categoryPath: string) => {\n    const sections = categoryChanges[categoryPath] || {};\n    const dirtySections = Object.entries(sections).filter(([_, section]) => section.isDirty);\n    \n    for (const [sectionId, section] of dirtySections) {\n      section.cancelHandler();\n      setSectionDirty(categoryPath, sectionId, false);\n    }\n  }, [categoryChanges, setSectionDirty]);\n\n  return (\n    <SettingsContext.Provider value={{\n      dirtySections,\n      addDirtySection,\n      removeDirtySection,\n      clearAllDirtySections,\n      hasDirtySections,\n      categoryChanges,\n      registerSectionHandler,\n      unregisterSectionHandler,\n      setSectionDirty,\n      getCategoryDirtySections,\n      hasCategoryChanges,\n      saveCategoryChanges,\n      cancelCategoryChanges\n    }}>\n      {children}\n    </SettingsContext.Provider>\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/__tests__/AuthContext.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/__tests__/OnboardingContext.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/__tests__/OrganizationContext.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/connectivityShared.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/languageShared.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/profile-context.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/useConnectivity.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/contexts/useLanguage.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/components/PackageCreationWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/components/PackageCreationWizardSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/components/__tests__/PackageCreationWizard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/context/PackageCreationProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Move your React context(s) to a separate file.","line":10,"column":14,"nodeType":"Identifier","messageId":"reactContext","endLine":10,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, ReactNode, useMemo, useReducer } from \"react\";\nimport { packageCreationReducer, createInitialPackageCreationState } from \"../state/packageCreationReducer\";\nimport { PackageCreationAction, PackageCreationEntryContext, PackageCreationState } from \"../types\";\n\ninterface PackageCreationContextValue {\n  state: PackageCreationState;\n  dispatch: React.Dispatch<PackageCreationAction>;\n}\n\nexport const PackageCreationContext = createContext<PackageCreationContextValue | undefined>(undefined);\n\ninterface PackageCreationProviderProps {\n  children: ReactNode;\n  entryContext?: PackageCreationEntryContext;\n}\n\nexport const PackageCreationProvider = ({ children, entryContext }: PackageCreationProviderProps) => {\n  const [state, dispatch] = useReducer(\n    packageCreationReducer,\n    createInitialPackageCreationState(entryContext)\n  );\n\n  const value = useMemo(\n    () => ({\n      state,\n      dispatch,\n    }),\n    [state]\n  );\n\n  return <PackageCreationContext.Provider value={value}>{children}</PackageCreationContext.Provider>;\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/hooks/usePackageCreationActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/hooks/usePackageCreationContext.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/hooks/usePackageCreationSnapshot.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":18,"column":28,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":18,"endColumn":31,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[639,642],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[639,642],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMemo } from \"react\";\nimport { usePackageCreationContext } from \"./usePackageCreationContext\";\nimport {\n  createPackageSnapshot,\n  preparePackagePersistence,\n  PackageSnapshot,\n  PackagePersistencePayload,\n  CreatePackageSnapshotOptions,\n} from \"../services/packageCreationSnapshot\";\nimport { usePackageDeliveryMethods } from \"@/hooks/useOrganizationData\";\n\nexport const usePackageCreationSnapshot = () => {\n  const { state } = usePackageCreationContext();\n  const deliveryMethodsQuery = usePackageDeliveryMethods();\n\n  const catalog = useMemo(() => {\n    const raw = deliveryMethodsQuery.data ?? [];\n    return raw.map((entry: any) => ({\n      id: entry.id,\n      name: entry.name ?? null,\n    }));\n  }, [deliveryMethodsQuery.data]);\n\n  const options: CreatePackageSnapshotOptions = useMemo(\n    () => ({ deliveryMethodsCatalog: catalog }),\n    [catalog]\n  );\n\n  const snapshot = useMemo<PackageSnapshot>(() => createPackageSnapshot(state, options), [state, options]);\n\n  const buildPersistencePayload = (context: { userId: string; organizationId: string }): PackagePersistencePayload => {\n    return preparePackagePersistence(state, context, options);\n  };\n\n  return {\n    snapshot,\n    buildPersistencePayload,\n    deliveryMethodsQuery,\n  };\n};\n\nexport type { PackageSnapshot } from \"../services/packageCreationSnapshot\";\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/services/__tests__/packageCreationSnapshot.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/services/packageCreationSnapshot.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/state/__tests__/packageCreationReducer.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/state/packageCreationReducer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/BasicsStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/DeliveryStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/PricingStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/ServicesStep.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'getUnitLabel'. Either include it or remove the dependency array.","line":581,"column":6,"nodeType":"ArrayExpression","endLine":581,"endColumn":43,"suggestions":[{"desc":"Update the dependencies array to be: [getUnitLabel, serviceMap, state.services.items]","fix":{"range":[19014,19051],"text":"[getUnitLabel, serviceMap, state.services.items]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport {\n  ServiceInventorySelector,\n  type ServiceInventoryItem,\n  type ServiceInventoryType,\n} from \"@/components/ServiceInventorySelector\";\nimport {\n  ServicesTableCard,\n  type ServicesTableRow,\n  SummaryTotalRow,\n  SummaryTotalsCard,\n  SummaryTotalsDivider,\n  SummaryTotalsSection,\n} from \"@/components/services\";\nimport {\n  useServices,\n  useOrganizationTaxProfile,\n} from \"@/hooks/useOrganizationData\";\nimport { usePackageCreationContext } from \"../hooks/usePackageCreationContext\";\nimport { usePackageCreationActions } from \"../hooks/usePackageCreationActions\";\nimport type { PackageCreationLineItem, PackageVatMode } from \"../types\";\nimport { cn } from \"@/lib/utils\";\nimport { calculateLineItemPricing } from \"../utils/lineItemPricing\";\nimport {\n  DEFAULT_SERVICE_UNIT,\n  normalizeServiceUnit,\n  type ServiceUnit,\n} from \"@/lib/services/units\";\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Users, Package as PackageIcon, Layers } from \"lucide-react\";\nimport {\n  ServiceVatOverridesSection,\n  type ServiceVatOverridesItem,\n  type ServiceVatOverridesMeta,\n} from \"@/features/services/components/ServiceVatOverridesSection\";\nimport {\n  CustomServicesSection,\n  type CustomServiceFormState,\n  type CustomServiceItemView,\n} from \"@/features/services/components/CustomServicesSection\";\ninterface ServiceRecord {\n  id: string;\n  name: string;\n  category?: string | null;\n  cost_price?: number | null;\n  selling_price?: number | null;\n  price?: number | null;\n  vendor_name?: string | null;\n  is_active?: boolean | null;\n  service_type?: ServiceInventoryType | null;\n  vat_rate?: number | null;\n  price_includes_vat?: boolean | null;\n  default_unit?: string | null;\n}\n\ninterface ServiceWithMetadata extends ServiceRecord {\n  unitCost: number;\n  unitPrice: number;\n  serviceType: ServiceInventoryType;\n  isActive: boolean;\n  vatRate: number | null;\n  vatMode: PackageVatMode;\n  priceIncludesVat: boolean;\n  unit: ServiceUnit;\n}\n\nconst formatCurrency = (amount: number) =>\n  new Intl.NumberFormat(\"tr-TR\", {\n    style: \"currency\",\n    currency: \"TRY\",\n    minimumFractionDigits: 0,\n  }).format(amount);\n\nexport const ServicesStep = () => {\n  const { t } = useTranslation(\"packageCreation\");\n  const { t: tForms } = useTranslation(\"forms\");\n  const { state } = usePackageCreationContext();\n  const { updateServices } = usePackageCreationActions();\n\n  const servicesQuery = useServices();\n  const taxProfileQuery = useOrganizationTaxProfile();\n  const taxProfile = taxProfileQuery.data;\n  const defaultVatRate = useMemo(() => {\n    if (\n      typeof taxProfile?.defaultVatRate === \"number\" &&\n      Number.isFinite(taxProfile.defaultVatRate)\n    ) {\n      return Number(taxProfile.defaultVatRate);\n    }\n    return 0;\n  }, [taxProfile]);\n  const defaultVatMode: PackageVatMode = useMemo(\n    () =>\n      taxProfile?.defaultVatMode === \"inclusive\" ? \"inclusive\" : \"exclusive\",\n    [taxProfile]\n  );\n  const defaultVatRateString = useMemo(\n    () =>\n      Number.isFinite(defaultVatRate) && defaultVatRate !== null\n        ? String(defaultVatRate)\n        : \"\",\n    [defaultVatRate]\n  );\n  const services = useMemo(\n    () => (servicesQuery.data as ServiceRecord[] | undefined) ?? [],\n    [servicesQuery.data]\n  );\n\n  const [customName, setCustomName] = useState(\"\");\n  const [customCost, setCustomCost] = useState(\"\");\n  const [customPrice, setCustomPrice] = useState(\"\");\n  const [customError, setCustomError] = useState<string | null>(null);\n  const [customVatRate, setCustomVatRate] = useState<string>(\n    defaultVatRateString\n  );\n  const [customVatMode, setCustomVatMode] =\n    useState<PackageVatMode>(defaultVatMode);\n  const [customVatPanels, setCustomVatPanels] = useState<\n    Record<string, boolean>\n  >({});\n  const [showQuickAddVatForm, setShowQuickAddVatForm] = useState(false);\n  const [showQuickAddVatResetPrompt, setShowQuickAddVatResetPrompt] =\n    useState(false);\n  const [pendingCustomVatResetId, setPendingCustomVatResetId] = useState<\n    string | null\n  >(null);\n  const hasVatOverrides = useMemo(() => {\n    return state.services.items.some((item) => {\n      const rate =\n        typeof item.vatRate === \"number\" && Number.isFinite(item.vatRate)\n          ? item.vatRate\n          : null;\n      const mode = item.vatMode ?? null;\n      const rateDiff = rate != null && Math.abs(rate - defaultVatRate) > 0.001;\n      const modeDiff = mode != null && mode !== defaultVatMode;\n      return rateDiff || modeDiff;\n    });\n  }, [state.services.items, defaultVatRate, defaultVatMode]);\n  const [showVatControls, setShowVatControls] = useState(false);\n  const [showVatResetPrompt, setShowVatResetPrompt] = useState(false);\n\n  useEffect(() => {\n    if (!state.services.showQuickAdd) {\n      setCustomVatRate(defaultVatRateString);\n      setCustomVatMode(defaultVatMode);\n      setShowQuickAddVatForm(false);\n      setShowQuickAddVatResetPrompt(false);\n    }\n  }, [\n    defaultVatMode,\n    defaultVatRateString,\n    state.services.showQuickAdd,\n  ]);\n\n  const serviceMap = useMemo<Map<string, ServiceWithMetadata>>(() => {\n    const entries = services\n      .filter((service) => service.is_active !== false)\n      .map((service) => {\n        const vatRate =\n          typeof service.vat_rate === \"number\" &&\n          Number.isFinite(service.vat_rate)\n            ? Number(service.vat_rate)\n            : null;\n        const vatMode: PackageVatMode = service.price_includes_vat\n          ? \"inclusive\"\n          : \"exclusive\";\n        const unit = normalizeServiceUnit(service.default_unit);\n        return [\n          service.id,\n          {\n            ...service,\n            unitCost: service.cost_price ?? 0,\n            unitPrice: service.selling_price ?? service.price ?? 0,\n            serviceType: (service.service_type ??\n              \"unknown\") as ServiceInventoryType,\n            isActive: true,\n            vatRate,\n            vatMode,\n            priceIncludesVat: service.price_includes_vat ?? false,\n            unit,\n          },\n        ] as const;\n      });\n    return new Map(entries);\n  }, [services]);\n\n  const inventoryServices = useMemo<ServiceInventoryItem[]>(\n    () =>\n      services\n        .filter((service) => service.is_active !== false)\n        .map((service) => ({\n          id: service.id,\n          name: service.name,\n          category: service.category,\n          serviceType: (service.service_type ??\n            \"unknown\") as ServiceInventoryType,\n          vendorName: service.vendor_name ?? null,\n          unitCost: service.cost_price ?? null,\n          unitPrice: service.selling_price ?? service.price ?? null,\n          unit: normalizeServiceUnit(service.default_unit),\n          defaultUnit: service.default_unit ?? null,\n          isActive: true,\n          vatRate:\n            typeof service.vat_rate === \"number\" &&\n            Number.isFinite(service.vat_rate)\n              ? Number(service.vat_rate)\n              : null,\n          priceIncludesVat: service.price_includes_vat ?? false,\n        })),\n    [services]\n  );\n\n  const existingItems = state.services.items.filter(\n    (item) => item.type === \"existing\"\n  );\n  const customItems = state.services.items.filter(\n    (item) => item.type === \"custom\"\n  );\n\n  const selectedQuantities = useMemo(\n    () =>\n      existingItems.reduce<Record<string, number>>((acc, item) => {\n        if (item.serviceId) {\n          acc[item.serviceId] = Math.max(1, item.quantity ?? 1);\n        }\n        return acc;\n      }, {}),\n    [existingItems]\n  );\n\n  const totals = useMemo(() => {\n    return state.services.items.reduce(\n      (acc, item) => {\n        const quantity = Math.max(1, item.quantity ?? 1);\n        const unitCost = Number(item.unitCost ?? 0);\n        const pricing = calculateLineItemPricing(item);\n        acc.cost += unitCost * quantity;\n        acc.price += pricing.net;\n        acc.vat += pricing.vat;\n        acc.total += pricing.gross;\n        return acc;\n      },\n      { cost: 0, price: 0, vat: 0, total: 0 }\n    );\n  }, [state.services.items]);\n\n  const margin = totals.price - totals.cost;\n\n  const parseQuantityInput = (value: string) => {\n    const numeric = value.replace(/[^0-9]/g, \"\");\n    const parsed = parseInt(numeric, 10);\n    return Number.isFinite(parsed) && parsed > 0 ? parsed : 1;\n  };\n\n  const handleAddExistingService = (serviceId: string) => {\n    const service = serviceMap.get(serviceId);\n    if (!service) return;\n\n    const vatRate =\n      typeof service.vatRate === \"number\" && Number.isFinite(service.vatRate)\n        ? Number(service.vatRate)\n        : defaultVatRate;\n    const vatMode: PackageVatMode = service.priceIncludesVat\n      ? \"inclusive\"\n      : \"exclusive\";\n    const unit = service.unit ?? DEFAULT_SERVICE_UNIT;\n\n    const filteredExisting = existingItems.filter(\n      (item) => item.serviceId !== serviceId\n    );\n    const nextItems: PackageCreationLineItem[] = [\n      ...filteredExisting,\n      {\n        id: serviceId,\n        type: \"existing\",\n        serviceId,\n        name: service.name,\n        quantity: 1,\n        unitCost: service.unitCost,\n        unitPrice: service.unitPrice,\n        vendorName: service.vendor_name ?? null,\n        source: \"catalog\",\n        vatRate,\n        vatMode,\n        unit,\n      },\n      ...customItems,\n    ];\n\n    updateServices({\n      items: nextItems,\n      showQuickAdd: state.services.showQuickAdd,\n    });\n  };\n\n  const handleIncreaseExistingService = (serviceId: string) => {\n    const nextExisting = existingItems.map((item) => {\n      if (item.serviceId !== serviceId) return item;\n      const current = Math.max(1, item.quantity ?? 1);\n      return { ...item, quantity: current + 1 };\n    });\n\n    updateServices({\n      items: [...nextExisting, ...customItems],\n      showQuickAdd: state.services.showQuickAdd,\n    });\n  };\n\n  const handleDecreaseExistingService = (serviceId: string) => {\n    const nextExisting = existingItems.map((item) => {\n      if (item.serviceId !== serviceId) return item;\n      const current = Math.max(1, item.quantity ?? 1);\n      return { ...item, quantity: Math.max(1, current - 1) };\n    });\n\n    updateServices({\n      items: [...nextExisting, ...customItems],\n      showQuickAdd: state.services.showQuickAdd,\n    });\n  };\n\n  const handleSetExistingServiceQuantity = (\n    serviceId: string,\n    quantity: number\n  ) => {\n    const nextExisting = existingItems.map((item) => {\n      if (item.serviceId !== serviceId) return item;\n      return { ...item, quantity: Math.max(1, quantity) };\n    });\n\n    updateServices({\n      items: [...nextExisting, ...customItems],\n      showQuickAdd: state.services.showQuickAdd,\n    });\n  };\n\n  const handleRemoveExistingService = (serviceId: string) => {\n    const nextExisting = existingItems.filter(\n      (item) => item.serviceId !== serviceId\n    );\n    updateServices({\n      items: [...nextExisting, ...customItems],\n      showQuickAdd: state.services.showQuickAdd,\n    });\n  };\n\n  const inventoryLabels = useMemo(\n    () => ({\n      typeMeta: {\n        deliverable: {\n          title: tForms(\"services.types.deliverable\", {\n            defaultValue: t(\"steps.services.inventory.types.deliverable.title\", {\n              defaultValue: \"Deliverables\",\n            }),\n          }),\n          subtitle: tForms(\"services.types.deliverable_hint\", {\n            defaultValue: t(\n              \"steps.services.inventory.types.deliverable.subtitle\",\n              { defaultValue: \"Albums, prints and other client handoffs\" }\n            ),\n          }),\n          icon: PackageIcon,\n          iconBackgroundClassName: \"bg-emerald-50\",\n          iconClassName: \"text-emerald-600\",\n        },\n        coverage: {\n          title: tForms(\"services.types.coverage\", {\n            defaultValue: t(\"steps.services.inventory.types.coverage.title\", {\n              defaultValue: \"Crew services\",\n            }),\n          }),\n          subtitle: tForms(\"services.types.coverage_hint\", {\n            defaultValue: t(\n              \"steps.services.inventory.types.coverage.subtitle\",\n              {\n                defaultValue:\n                  \"People-based coverage like photographers or videographers\",\n              }\n            ),\n          }),\n          icon: Users,\n          iconBackgroundClassName: \"bg-emerald-50\",\n          iconClassName: \"text-emerald-600\",\n        },\n        unknown: {\n          title: t(\"steps.services.inventory.types.unknown.title\", {\n            defaultValue: \"Other services\",\n          }),\n          subtitle: t(\"steps.services.inventory.types.unknown.subtitle\", {\n            defaultValue: \"Items without a service type yet\",\n          }),\n          icon: Layers,\n          iconBackgroundClassName: \"bg-emerald-50\",\n          iconClassName: \"text-emerald-600\",\n        },\n      },\n      add: t(\"steps.services.inventory.add\", { defaultValue: \"Add\" }),\n      decrease: t(\"common:actions.decrease\", { defaultValue: \"Decrease\" }),\n      increase: t(\"common:actions.increase\", { defaultValue: \"Increase\" }),\n      remove: t(\"steps.services.list.remove\", { defaultValue: \"Remove\" }),\n      vendor: t(\"steps.services.list.vendor\", { defaultValue: \"Vendor\" }),\n      unitCost: t(\"steps.services.list.unitCost\", {\n        defaultValue: \"Unit cost\",\n      }),\n      unitPrice: t(\"steps.services.list.unitPrice\", {\n        defaultValue: \"Unit price\",\n      }),\n      uncategorized: t(\"steps.services.inventory.uncategorized\", {\n        defaultValue: \"Other\",\n      }),\n      inactive: t(\"steps.services.inventory.inactive\", {\n        defaultValue: \"Inactive\",\n      }),\n      empty: t(\"steps.services.inventory.empty\", {\n        defaultValue:\n          \"No services in your catalog yet. Create services to add them here.\",\n      }),\n      quantity: t(\"steps.services.list.quantity\", { defaultValue: \"Quantity\" }),\n      selectedTag: (selected: number, total: number) =>\n        t(\"steps.services.inventory.selectedTag\", {\n          selected,\n          total,\n        }),\n      quantityTag: (count: number) =>\n        t(\"steps.services.inventory.quantityTag\", {\n          count,\n        }),\n      retry: t(\"common:actions.retry\", { defaultValue: \"Retry\" }),\n    }),\n    [t, tForms]\n  );\n\n  const vatModeOptions = useMemo(\n    () => [\n      {\n        value: \"inclusive\" as PackageVatMode,\n        label: t(\"steps.services.vatControls.mode.inclusive\"),\n      },\n      {\n        value: \"exclusive\" as PackageVatMode,\n        label: t(\"steps.services.vatControls.mode.exclusive\"),\n      },\n    ],\n    [t]\n  );\n\n  const vatOverrideItems = useMemo<ServiceVatOverridesItem[]>(() => {\n    return state.services.items.map((item) => {\n      const service =\n        item.type === \"existing\" && item.serviceId ? serviceMap.get(item.serviceId) : null;\n      const vatRateValue =\n        typeof item.vatRate === \"number\" && Number.isFinite(item.vatRate)\n          ? String(item.vatRate)\n          : \"\";\n      const vatModeValue: PackageVatMode =\n        item.vatMode === \"inclusive\" || item.vatMode === \"exclusive\"\n          ? item.vatMode\n          : defaultVatMode;\n      const meta: ServiceVatOverridesMeta[] = [];\n      const vendorLabel = item.vendorName\n        ? t(\"steps.services.vatControls.vendorLabel\", { vendor: item.vendorName })\n        : service?.vendor_name\n        ? t(\"steps.services.vatControls.vendorLabel\", { vendor: service.vendor_name })\n        : null;\n      if (vendorLabel) {\n        meta.push({ label: vendorLabel });\n      }\n      const serviceTypeKey =\n        (service?.serviceType as ServiceInventoryType | undefined) ?? \"unknown\";\n      const serviceTypeLabel =\n        serviceTypeKey === \"unknown\"\n          ? t(\"steps.services.inventory.types.unknown.title\")\n          : tForms(`services.types.${serviceTypeKey}`, {\n              defaultValue: t(\n                `steps.services.inventory.types.${serviceTypeKey}.title`\n              ),\n            });\n      meta.push({\n        label: t(\"steps.services.vatControls.typeLabel\", { type: serviceTypeLabel }),\n      });\n      if (item.type === \"custom\") {\n        meta.push({\n          label: t(\"summaryView.services.customTag\"),\n          variant: \"badge\",\n        });\n      }\n      return {\n        id: item.id,\n        name: item.name,\n        vatRate: vatRateValue,\n        vatMode: vatModeValue,\n        meta,\n      };\n    });\n  }, [state.services.items, serviceMap, defaultVatMode, t, tForms]);\n\n  const getUnitLabel = useCallback(\n    (unit?: string | null) =>\n      t(`steps.services.units.short.${normalizeServiceUnit(unit)}`, {\n        defaultValue: t(\n          `steps.services.units.options.${normalizeServiceUnit(unit)}`\n        ),\n      }),\n    [t]\n  );\n\n  const totalSelected = existingItems.length + customItems.length;\n\n  const serviceTableLabels = useMemo(\n    () => ({\n      columns: {\n        name: t(\"steps.services.summary.table.name\", {\n          defaultValue: \"Service\",\n        }),\n        quantity: t(\"steps.services.summary.table.quantity\", {\n          defaultValue: \"Qty\",\n        }),\n        cost: t(\"steps.services.summary.table.cost\", { defaultValue: \"Cost\" }),\n        unitPrice: t(\"summaryView.services.columns.unitPrice\"),\n        lineTotal: t(\"summaryView.services.columns.lineTotal\"),\n      },\n      customTag: t(\"summaryView.services.customTag\"),\n      customVendorFallback: t(\"summaryView.services.customVendorFallback\"),\n    }),\n    [t]\n  );\n\n  const summaryTableRows = useMemo<ServicesTableRow[]>(() => {\n    return state.services.items.map((item) => {\n      const quantity = Math.max(1, item.quantity ?? 1);\n      const unitPriceValue =\n        typeof item.unitPrice === \"number\" && Number.isFinite(item.unitPrice)\n          ? item.unitPrice\n          : null;\n      const pricing = calculateLineItemPricing(item);\n      const service =\n        item.type === \"existing\" && item.serviceId\n          ? serviceMap.get(item.serviceId)\n          : null;\n\n      const vendorName =\n        service?.vendor_name ??\n        // @ts-expect-error legacy camelCase vendor\n        service?.vendorName ??\n        item.vendorName ??\n        null;\n      const displayName = item.name ?? service?.name ?? item.serviceId ?? \"—\";\n      const unitLabel = getUnitLabel(\n        item.unit ?? service?.unit ?? DEFAULT_SERVICE_UNIT\n      );\n\n      const lineCost =\n        typeof item.unitCost === \"number\" && Number.isFinite(item.unitCost)\n          ? Math.round(item.unitCost * quantity * 100) / 100\n          : service?.unitCost\n          ? Math.round(service.unitCost * quantity * 100) / 100\n          : null;\n\n      return {\n        id: item.id,\n        name: displayName,\n        vendor: vendorName,\n        quantity,\n        unitLabel,\n        lineCost,\n        unitPrice: unitPriceValue,\n        lineTotal: Math.round(pricing.gross * 100) / 100,\n        isCustom: item.type === \"custom\",\n      };\n    });\n  }, [serviceMap, state.services.items, t]);\n\n  const updateItem = (\n    itemId: string,\n    updates: Partial<PackageCreationLineItem>\n  ) => {\n    const nextItems = state.services.items.map((item) =>\n      item.id === itemId ? { ...item, ...updates } : item\n    );\n    updateServices({ items: nextItems });\n  };\n\n  const handleVatModeChange = (itemId: string, mode: PackageVatMode) => {\n    updateItem(itemId, { vatMode: mode });\n  };\n\n  const handleVatRateChange = (itemId: string, value: string) => {\n    const trimmed = value.trim();\n    if (!trimmed) {\n      updateItem(itemId, { vatRate: null });\n      return;\n    }\n\n    const numeric = Number(trimmed.replace(/,/g, \".\"));\n    if (Number.isNaN(numeric)) {\n      return;\n    }\n\n    const clamped = Math.min(99.99, Math.max(0, numeric));\n    updateItem(itemId, { vatRate: clamped });\n  };\n\n  const formatPercent = (value: number) =>\n    new Intl.NumberFormat(\"tr-TR\", {\n      minimumFractionDigits: Number.isInteger(value) ? 0 : 1,\n      maximumFractionDigits: 2,\n    }).format(value);\n\n  const vatBreakdown = useMemo(() => {\n    const buckets = new Map<number, number>();\n    state.services.items.forEach((item) => {\n      const pricing = calculateLineItemPricing(item);\n      if (!(pricing.vat > 0)) return;\n      const rate =\n        typeof item.vatRate === \"number\" && Number.isFinite(item.vatRate)\n          ? item.vatRate\n          : 0;\n      const current = buckets.get(rate) ?? 0;\n      buckets.set(rate, current + pricing.vat);\n    });\n\n    return Array.from(buckets.entries())\n      .sort((a, b) => b[0] - a[0])\n      .map(([rate, amount]) => ({ rate, amount }));\n  }, [state.services.items]);\n\n  const removeItem = (itemId: string) => {\n    updateServices({\n      items: state.services.items.filter((item) => item.id !== itemId),\n    });\n    setCustomVatPanels((previous) => {\n      if (!previous[itemId]) {\n        return previous;\n      }\n      const next = { ...previous };\n      delete next[itemId];\n      return next;\n    });\n    if (pendingCustomVatResetId === itemId) {\n      setPendingCustomVatResetId(null);\n    }\n  };\n\n  const handleQuantityChange = (itemId: string, value: string) => {\n    updateItem(itemId, { quantity: parseQuantityInput(value) });\n  };\n\n  const adjustQuantity = (itemId: string, delta: number) => {\n    const target = state.services.items.find((item) => item.id === itemId);\n    const next = Math.max(1, (target?.quantity ?? 1) + delta);\n    updateItem(itemId, { quantity: next });\n  };\n\n  const customFormState: CustomServiceFormState = {\n    name: customName,\n    cost: customCost,\n    price: customPrice,\n    vatRate: customVatRate,\n    vatMode: customVatMode,\n    vatFormOpen: showQuickAddVatForm,\n  };\n\n  const handleCustomFormChange = (updates: Partial<CustomServiceFormState>) => {\n    if (updates.name !== undefined) setCustomName(updates.name);\n    if (updates.cost !== undefined) setCustomCost(updates.cost);\n    if (updates.price !== undefined) setCustomPrice(updates.price);\n    if (updates.vatRate !== undefined) setCustomVatRate(updates.vatRate);\n    if (updates.vatMode !== undefined) setCustomVatMode(updates.vatMode);\n  };\n\n  const customServiceItems = useMemo<CustomServiceItemView[]>(\n    () =>\n      customItems.map((item) => ({\n        id: item.id,\n        name: item.name,\n        quantity: Math.max(1, item.quantity ?? 1),\n        unitCost: item.unitCost ?? null,\n        unitPrice: item.unitPrice ?? null,\n        unitLabel: getUnitLabel(item.unit ?? DEFAULT_SERVICE_UNIT),\n        vatRate:\n          typeof item.vatRate === \"number\" && Number.isFinite(item.vatRate)\n            ? item.vatRate\n            : null,\n        vatMode:\n          item.vatMode === \"inclusive\" || item.vatMode === \"exclusive\"\n            ? item.vatMode\n            : defaultVatMode,\n        vatEditorOpen: Boolean(customVatPanels[item.id]),\n      })),\n    [customItems, customVatPanels, getUnitLabel, defaultVatMode]\n  );\n\n  const customServicesStrings = useMemo(() => {\n    const vatModeLabel = t(`steps.services.vatControls.mode.${defaultVatMode}`);\n    const vatHelperText = t(\"steps.services.custom.vatHelper\", {\n      rate: formatPercent(defaultVatRate),\n      mode: vatModeLabel,\n    });\n    return {\n      nameLabel: t(\"steps.services.custom.nameLabel\"),\n      namePlaceholder: t(\"steps.services.custom.namePlaceholder\"),\n      costLabel: t(\"steps.services.custom.costLabel\"),\n      costPlaceholder: t(\"steps.services.custom.costPlaceholder\"),\n      priceLabel: t(\"steps.services.custom.priceLabel\"),\n      pricePlaceholder: t(\"steps.services.custom.pricePlaceholder\"),\n      listCostLabel: t(\"steps.services.list.unitCost\"),\n      listPriceLabel: t(\"steps.services.list.unitPrice\"),\n      addButton: t(\"steps.services.custom.add\"),\n      cancelButton: t(\"steps.services.custom.cancel\"),\n      vatToggleOpen: t(\"steps.services.custom.vatButtonOpen\"),\n      vatToggleClose: t(\"steps.services.custom.vatButtonClose\"),\n      vatRateLabel: t(\"steps.services.custom.vatRateLabel\"),\n      vatRatePlaceholder: t(\"steps.services.custom.vatRatePlaceholder\"),\n      vatModeLabel: t(\"steps.services.custom.vatModeLabel\"),\n      vatHelper: vatHelperText,\n      vatHelperPerItem: vatHelperText,\n      quantityLabel: t(\"steps.services.list.quantity\"),\n      decreaseAriaLabel: t(\"common:actions.decrease\", {\n        defaultValue: \"Decrease\",\n      }),\n      increaseAriaLabel: t(\"common:actions.increase\", {\n        defaultValue: \"Increase\",\n      }),\n      removeAriaLabel: t(\"steps.services.list.remove\"),\n      customBadgeLabel: t(\"summaryView.services.customTag\"),\n      emptyState: t(\"steps.services.custom.emptyState\", {\n        defaultValue: \"No custom services yet.\",\n      }),\n    };\n  }, [t, defaultVatRate, defaultVatMode]);\n\n  const handleToggleVatControls = () => {\n    if (showVatControls) {\n      if (hasVatOverrides) {\n        setShowVatResetPrompt(true);\n        return;\n      }\n      setShowVatControls(false);\n      return;\n    }\n    setShowVatControls(true);\n  };\n\n  const hasQuickAddVatOverrides = useCallback(() => {\n    const trimmed = customVatRate.trim();\n    const numeric = trimmed\n      ? Number(trimmed.replace(/,/g, \".\"))\n      : defaultVatRate;\n    const normalized = Number.isFinite(numeric)\n      ? Math.min(99.99, Math.max(0, numeric))\n      : defaultVatRate;\n    const rateDiff = Math.abs(normalized - defaultVatRate) > 0.0001;\n    const modeDiff = customVatMode !== defaultVatMode;\n    return rateDiff || modeDiff;\n  }, [customVatRate, customVatMode, defaultVatMode, defaultVatRate]);\n\n  const handleQuickAddVatToggle = () => {\n    if (!showQuickAddVatForm) {\n      setShowQuickAddVatForm(true);\n      return;\n    }\n    if (hasQuickAddVatOverrides()) {\n      setShowQuickAddVatResetPrompt(true);\n      return;\n    }\n    setCustomVatRate(defaultVatRateString);\n    setCustomVatMode(defaultVatMode);\n    setShowQuickAddVatForm(false);\n    setShowQuickAddVatResetPrompt(false);\n  };\n\n  const handleConfirmQuickAddVatReset = () => {\n    setCustomVatRate(defaultVatRateString);\n    setCustomVatMode(defaultVatMode);\n    setShowQuickAddVatForm(false);\n    setShowQuickAddVatResetPrompt(false);\n  };\n\n  const customItemHasVatOverrides = useCallback(\n    (item: PackageCreationLineItem) => {\n      const rate =\n        typeof item.vatRate === \"number\" && Number.isFinite(item.vatRate)\n          ? item.vatRate\n          : defaultVatRate;\n      const mode = item.vatMode ?? defaultVatMode;\n      const rateDiff = Math.abs(rate - defaultVatRate) > 0.0001;\n      const modeDiff = mode !== defaultVatMode;\n      return rateDiff || modeDiff;\n    },\n    [defaultVatMode, defaultVatRate]\n  );\n\n  const handleCustomVatToggle = (itemId: string) => {\n    const item = state.services.items.find((serviceItem) => serviceItem.id === itemId);\n    if (!item) return;\n    const isOpen = Boolean(customVatPanels[itemId]);\n    if (isOpen) {\n      if (customItemHasVatOverrides(item)) {\n        setPendingCustomVatResetId(itemId);\n        return;\n      }\n      setCustomVatPanels((previous) => {\n        const next = { ...previous };\n        delete next[itemId];\n        return next;\n      });\n      return;\n    }\n    setCustomVatPanels((previous) => ({ ...previous, [itemId]: true }));\n  };\n\n  const handleConfirmCustomVatReset = () => {\n    if (!pendingCustomVatResetId) return;\n    updateItem(pendingCustomVatResetId, {\n      vatRate: defaultVatRate,\n      vatMode: defaultVatMode,\n    });\n    setCustomVatPanels((previous) => {\n      const next = { ...previous };\n      delete next[pendingCustomVatResetId];\n      return next;\n    });\n    setPendingCustomVatResetId(null);\n  };\n\n  const resetVatOverrides = useCallback(() => {\n    const resetItems = state.services.items.map((item) => {\n      const service =\n        item.type === \"existing\" && item.serviceId\n          ? serviceMap.get(item.serviceId)\n          : null;\n      const fallbackRate =\n        typeof service?.vatRate === \"number\" && Number.isFinite(service.vatRate)\n          ? service.vatRate\n          : defaultVatRate;\n      const fallbackMode: PackageVatMode = service?.vatMode ?? defaultVatMode;\n\n      return {\n        ...item,\n        vatRate: fallbackRate,\n        vatMode: fallbackMode,\n      };\n    });\n\n    updateServices({ items: resetItems });\n    setShowVatControls(false);\n    setShowVatResetPrompt(false);\n  }, [\n    state.services.items,\n    serviceMap,\n    defaultVatRate,\n    defaultVatMode,\n    updateServices,\n  ]);\n\n  const toggleQuickAdd = () => {\n    const nextOpen = !state.services.showQuickAdd;\n    updateServices({ showQuickAdd: nextOpen });\n    setCustomError(null);\n    setCustomName(\"\");\n    setCustomCost(\"\");\n    setCustomPrice(\"\");\n    setCustomVatRate(defaultVatRateString);\n    setCustomVatMode(defaultVatMode);\n    setShowQuickAddVatForm(false);\n    setShowQuickAddVatResetPrompt(false);\n    setPendingCustomVatResetId(null);\n  };\n\n  const handleAddCustomService = () => {\n    setCustomError(null);\n    const trimmedName = customName.trim();\n    const parsedPrice = Number(customPrice);\n    const parsedCost = customCost.trim() === \"\" ? 0 : Number(customCost);\n    const trimmedVat = customVatRate.trim();\n\n    if (!trimmedName) {\n      setCustomError(\n        t(\"steps.services.custom.errors.name\", {\n          defaultValue: \"Name is required.\",\n        })\n      );\n      return;\n    }\n\n    if (!Number.isFinite(parsedPrice) || parsedPrice <= 0) {\n      setCustomError(\n        t(\"steps.services.custom.errors.price\", {\n          defaultValue: \"Enter a valid price.\",\n        })\n      );\n      return;\n    }\n\n    if (\n      customCost.trim() !== \"\" &&\n      (!Number.isFinite(parsedCost) || parsedCost < 0)\n    ) {\n      setCustomError(\n        t(\"steps.services.custom.errors.cost\", {\n          defaultValue: \"Enter a valid cost.\",\n        })\n      );\n      return;\n    }\n\n    let parsedVatRate = defaultVatRate;\n    if (trimmedVat) {\n      const numericVat = Number(trimmedVat.replace(/,/g, \".\"));\n      if (Number.isNaN(numericVat)) {\n        setCustomError(\n          t(\"steps.services.custom.errors.vat\", {\n            defaultValue: \"Enter a valid VAT rate.\",\n          })\n        );\n        return;\n      }\n      parsedVatRate = Math.min(99.99, Math.max(0, numericVat));\n    }\n\n    const newItem: PackageCreationLineItem = {\n      id: `custom-${Date.now()}-${Math.random().toString(36).slice(2, 8)}`,\n      type: \"custom\",\n      name: trimmedName,\n      quantity: 1,\n      unitCost: Number.isFinite(parsedCost) ? parsedCost : 0,\n      unitPrice: parsedPrice,\n      vendorName: null,\n      source: \"adhoc\",\n      vatRate: parsedVatRate,\n      vatMode: customVatMode,\n      unit: DEFAULT_SERVICE_UNIT,\n    };\n\n    updateServices({\n      items: [...state.services.items, newItem],\n      showQuickAdd: true,\n    });\n\n    setCustomName(\"\");\n    setCustomCost(\"\");\n    setCustomPrice(\"\");\n    setCustomVatRate(defaultVatRateString);\n    setCustomVatMode(defaultVatMode);\n    setShowQuickAddVatForm(false);\n    setShowQuickAddVatResetPrompt(false);\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h2 className=\"text-xl font-semibold tracking-tight text-slate-900\">\n          {t(\"steps.services.title\")}\n        </h2>\n        <p className=\"text-sm text-muted-foreground\">\n          {t(\"steps.services.description\")}\n        </p>\n      </div>\n\n      <ServiceInventorySelector\n        services={inventoryServices}\n        selected={selectedQuantities}\n        labels={inventoryLabels}\n        onAdd={handleAddExistingService}\n        onIncrease={handleIncreaseExistingService}\n        onDecrease={handleDecreaseExistingService}\n        onSetQuantity={handleSetExistingServiceQuantity}\n        onRemove={handleRemoveExistingService}\n        isLoading={servicesQuery.isLoading}\n        error={servicesQuery.error ? t(\"steps.services.picker.error\") : null}\n        onRetry={\n          servicesQuery.error ? () => servicesQuery.refetch() : undefined\n        }\n      />\n      {state.services.items.length > 0 ? (\n        <ServiceVatOverridesSection\n          title={t(\"steps.services.vatControls.title\")}\n          description={t(\"steps.services.vatControls.description\")}\n          tooltipLabel={t(\"steps.services.vatControls.toggleLabel\")}\n          tooltipContent={t(\"steps.services.vatControls.toggleDescription\")}\n          toggleButtonLabel={\n            showVatControls\n              ? t(\"steps.services.vatControls.buttonClose\")\n              : t(\"steps.services.vatControls.buttonOpen\")\n          }\n          isOpen={showVatControls}\n          onToggle={handleToggleVatControls}\n          items={vatOverrideItems}\n          rateLabel={t(\"steps.services.vatControls.rateLabel\")}\n          modeLabel={t(\"steps.services.vatControls.modeLabel\")}\n          modeOptions={vatModeOptions}\n          onRateChange={handleVatRateChange}\n          onModeChange={handleVatModeChange}\n        />\n      ) : null}\n\n      <CustomServicesSection\n        title={t(\"steps.services.custom.managerTitle\")}\n        description={t(\"steps.services.custom.managerDescription\")}\n        tooltipLabel={t(\"steps.services.custom.managerTitle\")}\n        tooltipContent={t(\"steps.services.custom.catalogTooltip\")}\n        toggleButtonLabels={{\n          open: t(\"steps.services.custom.buttonOpen\"),\n          close: t(\"steps.services.custom.buttonClose\"),\n        }}\n        open={state.services.showQuickAdd}\n        onToggle={toggleQuickAdd}\n        form={customFormState}\n        onFormChange={handleCustomFormChange}\n        onSubmit={handleAddCustomService}\n        onCancel={toggleQuickAdd}\n        error={customError}\n        strings={customServicesStrings}\n        vatModeOptions={vatModeOptions}\n        onQuickAddVatToggle={handleQuickAddVatToggle}\n        items={customServiceItems}\n        onItemNameChange={(itemId, value) => updateItem(itemId, { name: value })}\n        onItemCostChange={(itemId, value) =>\n          updateItem(itemId, { unitCost: value === \"\" ? null : Number(value) })\n        }\n        onItemPriceChange={(itemId, value) =>\n          updateItem(itemId, { unitPrice: value === \"\" ? null : Number(value) })\n        }\n        onItemQuantityChange={handleQuantityChange}\n        onItemAdjustQuantity={adjustQuantity}\n        onItemRemove={removeItem}\n        onItemVatToggle={handleCustomVatToggle}\n        onItemVatRateChange={handleVatRateChange}\n        onItemVatModeChange={handleVatModeChange}\n      />\n\n      <div className=\"space-y-3\">\n        <p className=\"text-xs font-medium uppercase tracking-wide text-muted-foreground\">\n          {t(\"steps.services.summary.listHeading\", {\n            defaultValue: \"Selected services\",\n          })}\n        </p>\n        <ServicesTableCard\n          rows={summaryTableRows}\n          totals={undefined}\n          labels={serviceTableLabels}\n          emptyMessage={t(\"steps.services.summary.empty\")}\n          formatCurrency={formatCurrency}\n          className=\"bg-white/80 backdrop-blur\"\n        />\n        {summaryTableRows.length ? (\n          <div className=\"flex justify-end\">\n            <SummaryTotalsCard className=\"sm:w-auto sm:min-w-[320px]\">\n              <SummaryTotalRow\n                label={t(\"steps.services.summary.countLabel\")}\n                value={totalSelected}\n              />\n              <SummaryTotalsSection>\n                <SummaryTotalRow\n                  label={t(\"steps.services.summary.cost\")}\n                  value={formatCurrency(totals.cost)}\n                />\n                <SummaryTotalRow\n                  label={t(\"steps.services.summary.price\")}\n                  value={formatCurrency(totals.price)}\n                />\n              </SummaryTotalsSection>\n              {vatBreakdown.length ? (\n                <SummaryTotalsSection className=\"space-y-1\">\n                  {vatBreakdown.map((entry) => (\n                    <SummaryTotalRow\n                      key={entry.rate}\n                      label={t(\"steps.services.summary.vatBreakdownItem\", {\n                        rate: formatPercent(entry.rate),\n                      })}\n                      value={formatCurrency(entry.amount)}\n                    />\n                  ))}\n                </SummaryTotalsSection>\n              ) : null}\n              {vatBreakdown.length !== 1 ? (\n                <SummaryTotalsSection>\n                  <SummaryTotalRow\n                    label={\n                      vatBreakdown.length > 1\n                        ? t(\"steps.services.summary.vatTotal\", {\n                            defaultValue: \"Total VAT\",\n                          })\n                        : t(\"steps.services.summary.vat\", {\n                            defaultValue: \"VAT\",\n                          })\n                    }\n                    value={formatCurrency(totals.vat)}\n                  />\n                </SummaryTotalsSection>\n              ) : null}\n              <SummaryTotalsDivider />\n              <SummaryTotalsSection className=\"pt-3\">\n                <SummaryTotalRow\n                  label={t(\"steps.services.summary.gross\", {\n                    defaultValue: \"Total\",\n                  })}\n                  value={formatCurrency(totals.total)}\n                  emphasizeLabel\n                />\n                <SummaryTotalRow\n                  label={t(\"steps.services.summary.margin\")}\n                  value={formatCurrency(margin)}\n                  tone={margin >= 0 ? \"positive\" : \"negative\"}\n                  emphasizeLabel\n                />\n              </SummaryTotalsSection>\n            </SummaryTotalsCard>\n          </div>\n        ) : null}\n      </div>\n\n      <AlertDialog\n        open={showVatResetPrompt}\n        onOpenChange={setShowVatResetPrompt}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {t(\"steps.services.vatControls.resetConfirmTitle\")}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\"steps.services.vatControls.resetConfirmDescription\")}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel\n              onClick={() => {\n                setShowVatResetPrompt(false);\n              }}\n            >\n              {t(\"steps.services.vatControls.resetConfirmCancel\")}\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={resetVatOverrides}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              {t(\"steps.services.vatControls.resetConfirmConfirm\")}\n            </AlertDialogAction>\n      </AlertDialogFooter>\n    </AlertDialogContent>\n  </AlertDialog>\n\n      <AlertDialog\n        open={showQuickAddVatResetPrompt}\n        onOpenChange={setShowQuickAddVatResetPrompt}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {t(\"steps.services.vatControls.resetConfirmTitle\")}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\"steps.services.vatControls.resetConfirmDescription\")}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel\n              onClick={() => setShowQuickAddVatResetPrompt(false)}\n            >\n              {t(\"steps.services.vatControls.resetConfirmCancel\")}\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmQuickAddVatReset}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              {t(\"steps.services.vatControls.resetConfirmConfirm\")}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      <AlertDialog\n        open={pendingCustomVatResetId !== null}\n        onOpenChange={(open) => {\n          if (!open) {\n            setPendingCustomVatResetId(null);\n          }\n        }}\n      >\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>\n              {t(\"steps.services.vatControls.resetConfirmTitle\")}\n            </AlertDialogTitle>\n            <AlertDialogDescription>\n              {t(\"steps.services.vatControls.resetConfirmDescription\")}\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel onClick={() => setPendingCustomVatResetId(null)}>\n              {t(\"steps.services.vatControls.resetConfirmCancel\")}\n            </AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleConfirmCustomVatReset}\n              className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n            >\n              {t(\"steps.services.vatControls.resetConfirmConfirm\")}\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/SummaryStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/__tests__/PricingStep.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/__tests__/SummaryStep.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":25,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":25,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[835,838],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[835,838],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { render, screen } from \"@/utils/testUtils\";\nimport { SummaryStep } from \"../SummaryStep\";\nimport type { PackageSnapshot } from \"../../services/packageCreationSnapshot\";\nimport en from \"@/i18n/resources/en/packageCreation.json\";\n\njest.mock(\"react-i18next\", () => ({\n  useTranslation: jest.fn(),\n}));\n\njest.mock(\"../../hooks/usePackageCreationSnapshot\", () => ({\n  usePackageCreationSnapshot: jest.fn(),\n}));\n\njest.mock(\"@/hooks/useOrganizationData\", () => ({\n  useProjectTypes: jest.fn(),\n}));\n\nimport { useTranslation } from \"react-i18next\";\nimport { usePackageCreationSnapshot } from \"../../hooks/usePackageCreationSnapshot\";\nimport { useProjectTypes } from \"@/hooks/useOrganizationData\";\n\nconst getTranslation = (key: string): string | undefined => {\n  const parts = key.split(\".\");\n  let current: any = en;\n  for (const part of parts) {\n    if (current && typeof current === \"object\" && part in current) {\n      current = current[part];\n    } else {\n      return undefined;\n    }\n  }\n  return typeof current === \"string\" ? current : undefined;\n};\n\nconst applyInterpolation = (\n  template: string,\n  options?: Record<string, unknown>\n): string => {\n  if (!options) return template;\n  return template.replace(/\\{\\{\\s*(\\w+)\\s*\\}\\}/g, (match, key) => {\n    const replacement = options[key];\n    return replacement !== undefined ? String(replacement) : match;\n  });\n};\n\nconst baseSnapshot = (): PackageSnapshot => ({\n  basics: {\n    name: \"Sunset Deluxe\",\n    description: \"Tam gün çekim ve albüm\",\n    applicableTypeIds: [\"type-1\"],\n    isActive: true,\n  },\n  services: {\n    items: [\n      {\n        id: \"item-1\",\n        type: \"existing\",\n        role: \"addon\",\n        serviceId: \"svc-1\",\n        name: \"Drone çekimi\",\n        quantity: 1,\n        unitCost: 250,\n        unitPrice: 750,\n        vendorName: \"Freelancer\",\n        vatRate: 0,\n        vatMode: \"exclusive\",\n      },\n    ],\n    totals: {\n      cost: 250,\n      price: 750,\n      vat: 0,\n      total: 750,\n    },\n    defaultAddOnIds: [\"svc-1\"],\n    itemCount: 1,\n    totalQuantity: 1,\n  },\n  delivery: {\n    photosEnabled: true,\n    leadTimeEnabled: true,\n    methodsEnabled: true,\n    estimateType: \"range\",\n    photoCountMin: 250,\n    photoCountMax: 400,\n    leadTimeValue: 6,\n    leadTimeUnit: \"weeks\",\n    methods: [\n      {\n        methodId: \"online-gallery\",\n        name: \"Online gallery\",\n      },\n    ],\n  },\n  pricing: {\n    basePrice: 18000,\n    servicesCostTotal: 250,\n    servicesPriceTotal: 750,\n    servicesVatTotal: 0,\n    servicesGrossTotal: 750,\n    servicesMargin: 500,\n    subtotal: 18750,\n    clientTotal: 18000,\n    includeAddOnsInPrice: true,\n    depositMode: \"percent_subtotal\",\n    depositValue: 25,\n    depositTarget: \"subtotal\",\n    depositAmount: 4500,\n    enableDeposit: true,\n  },\n  meta: {\n    selectedServiceCount: 1,\n    totalSelectedQuantity: 1,\n  },\n});\n\ndescribe(\"SummaryStep\", () => {\n  beforeEach(() => {\n    (useTranslation as jest.Mock).mockReturnValue({\n      t: (\n        key: string,\n        options?: { defaultValue?: string } & Record<string, unknown>\n      ) => applyInterpolation(getTranslation(key) ?? options?.defaultValue ?? key, options),\n    });\n    (useProjectTypes as jest.Mock).mockReturnValue({\n      data: [{ id: \"type-1\", name: \"Wedding\" }],\n    });\n  });\n\n  it(\"renders inclusive client total and deposit summary\", () => {\n    (usePackageCreationSnapshot as jest.Mock).mockReturnValue({\n      snapshot: baseSnapshot(),\n    });\n\n    render(<SummaryStep />);\n\n    expect(screen.getByText(\"Sunset Deluxe\")).toBeInTheDocument();\n    expect(screen.getByText(\"Wedding\")).toBeInTheDocument();\n    const clientTotalRow = screen\n      .getByText(\"Client total\")\n      .parentElement?.parentElement as HTMLElement;\n    expect(clientTotalRow.textContent).toContain(\"₺18.000\");\n    expect(clientTotalRow.textContent).toContain(\n      \"Client total = package price + selected services.\"\n    );\n    const depositRow = screen\n      .getByText(\"Deposit\")\n      .parentElement?.parentElement as HTMLElement;\n    expect(depositRow.textContent).toContain(\"₺4.500\");\n    expect(depositRow.textContent).toContain(\n      \"25% of package + services total\"\n    );\n  });\n\n  it(\"renders add-on mode summary with deposit disabled helper\", () => {\n    const snapshot = baseSnapshot();\n    snapshot.pricing.includeAddOnsInPrice = false;\n    snapshot.pricing.clientTotal = 18750;\n    snapshot.pricing.enableDeposit = false;\n    snapshot.pricing.depositAmount = 0;\n    snapshot.pricing.depositValue = 0;\n\n    (usePackageCreationSnapshot as jest.Mock).mockReturnValue({\n      snapshot,\n    });\n\n    render(<SummaryStep />);\n\n    const clientTotalRow = screen\n      .getByText(\"Client total\")\n      .parentElement?.parentElement as HTMLElement;\n    expect(clientTotalRow.textContent).toContain(\n      \"Package price already includes selected services.\"\n    );\n    expect(clientTotalRow.textContent).toMatch(/₺\\s?18\\.750/);\n    const depositRow = screen\n      .getByText(\"Deposit\")\n      .parentElement?.parentElement as HTMLElement;\n    expect(depositRow.textContent).toContain(\"No deposit collected\");\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/steps/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/package-creation/utils/lineItemPricing.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/components/ProjectCreationWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/components/ProjectCreationWizardSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/components/__tests__/ProjectCreationWizard.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/components/__tests__/ProjectCreationWizardSheet.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/context/ProjectCreationProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Move your React context(s) to a separate file.","line":10,"column":14,"nodeType":"Identifier","messageId":"reactContext","endLine":10,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, ReactNode, useMemo, useReducer } from \"react\";\nimport { projectCreationReducer, createInitialProjectCreationState } from \"../state/projectCreationReducer\";\nimport { ProjectCreationAction, ProjectCreationEntryContext, ProjectCreationState } from \"../types\";\n\ninterface ProjectCreationContextValue {\n  state: ProjectCreationState;\n  dispatch: React.Dispatch<ProjectCreationAction>;\n}\n\nexport const ProjectCreationContext = createContext<ProjectCreationContextValue | undefined>(undefined);\n\ninterface ProjectCreationProviderProps {\n  children: ReactNode;\n  entryContext?: ProjectCreationEntryContext;\n}\n\nexport const ProjectCreationProvider = ({ children, entryContext }: ProjectCreationProviderProps) => {\n  const [state, dispatch] = useReducer(projectCreationReducer, createInitialProjectCreationState(entryContext));\n\n  const value = useMemo(\n    () => ({\n      state,\n      dispatch,\n    }),\n    [state]\n  );\n\n  return <ProjectCreationContext.Provider value={value}>{children}</ProjectCreationContext.Provider>;\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/hooks/useProjectCreationActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/hooks/useProjectCreationContext.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/state/__tests__/ProjectCreationReducer.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/state/projectCreationReducer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/steps/DetailsStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/steps/LeadStep.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":76,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":76,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3032,3035],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3032,3035],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { EnhancedAddLeadDialog } from \"@/components/EnhancedAddLeadDialog\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { LeadStatusBadge } from \"@/components/LeadStatusBadge\";\nimport { useLeadStatuses } from \"@/hooks/useOrganizationData\";\nimport { LeadInitials } from \"@/components/LeadInitials\";\nimport { cn } from \"@/lib/utils\";\nimport { getUserOrganizationId } from \"@/lib/organizationUtils\";\nimport { useProjectCreationActions } from \"../hooks/useProjectCreationActions\";\nimport { useProjectCreationContext } from \"../hooks/useProjectCreationContext\";\nimport { Check, ChevronDown, Loader2, Search, UserPlus } from \"lucide-react\";\n\ninterface LeadOption {\n  id: string;\n  name: string;\n  email?: string | null;\n  phone?: string | null;\n  status?: string | null;\n  status_id?: string | null;\n}\n\nexport const LeadStep = () => {\n  const { t } = useTranslation(\"projectCreation\");\n  const { toast } = useToast();\n  const { state } = useProjectCreationContext();\n  const { updateLead } = useProjectCreationActions();\n  const [leadOptions, setLeadOptions] = useState<LeadOption[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [hasLoadedOnce, setHasLoadedOnce] = useState(false);\n  const [dropdownOpen, setDropdownOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [createLeadOpen, setCreateLeadOpen] = useState(false);\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const latestRequestRef = useRef(0);\n  const { data: leadStatuses = [], isLoading: leadStatusesLoading } = useLeadStatuses();\n\n  const loadLeads = useCallback(\n    async (term: string) => {\n      const requestId = ++latestRequestRef.current;\n      setLoading(true);\n      try {\n        const organizationId = await getUserOrganizationId();\n        if (!organizationId) {\n          if (latestRequestRef.current === requestId) {\n            setLeadOptions([]);\n          }\n          return;\n        }\n\n        const sanitized = term.trim().replace(/[%_]/g, \"\\\\$&\");\n        let query = supabase\n          .from(\"leads\")\n          .select(\"id, name, email, phone, status, status_id\")\n          .eq(\"organization_id\", organizationId)\n          .order(\"updated_at\", { ascending: false })\n          .limit(25);\n\n        if (sanitized) {\n          query = query.or(\n            `name.ilike.%${sanitized}%,email.ilike.%${sanitized}%,phone.ilike.%${sanitized}%`\n          );\n        }\n\n        const { data, error } = await query;\n        if (error) throw error;\n\n        if (latestRequestRef.current === requestId) {\n          setLeadOptions((data as LeadOption[]) || []);\n        }\n      } catch (error: any) {\n        console.error(\"Failed to load leads\", error);\n        if (latestRequestRef.current === requestId) {\n          setLeadOptions([]);\n          setHasLoadedOnce(true);\n        }\n        toast({\n          title: t(\"steps.lead.fetchErrorTitle\"),\n          description: error.message,\n          variant: \"destructive\",\n        });\n      } finally {\n        if (latestRequestRef.current === requestId) {\n          setLoading(false);\n          setHasLoadedOnce(true);\n        }\n      }\n    },\n    [toast, t]\n  );\n\n  useEffect(() => {\n    loadLeads(\"\");\n  }, [loadLeads]);\n\n  useEffect(() => {\n    if (!dropdownOpen) return;\n    const handler = window.setTimeout(() => {\n      loadLeads(searchTerm);\n    }, 250);\n    return () => {\n      window.clearTimeout(handler);\n    };\n  }, [dropdownOpen, searchTerm, loadLeads]);\n\n \n  useEffect(() => {\n    if (!dropdownOpen) return;\n    const handlePointerDown = (event: PointerEvent) => {\n      if (\n        containerRef.current &&\n        !containerRef.current.contains(event.target as Node)\n      ) {\n        setDropdownOpen(false);\n      }\n    };\n    document.addEventListener(\"pointerdown\", handlePointerDown);\n    return () => {\n      document.removeEventListener(\"pointerdown\", handlePointerDown);\n    };\n  }, [dropdownOpen]);\n\n  const selectedLeadOption = useMemo(() => {\n    if (!state.lead.id) return undefined;\n    return leadOptions.find((lead) => lead.id === state.lead.id);\n  }, [leadOptions, state.lead.id]);\n\n  const handleAssignLead = (lead: LeadOption) => {\n    updateLead({\n      id: lead.id,\n      name: lead.name,\n      email: lead.email ?? undefined,\n      phone: lead.phone ?? undefined,\n      notes: \"\",\n      mode: \"existing\",\n    });\n    setDropdownOpen(false);\n    setSearchTerm(\"\");\n  };\n\n  const handleLeadCreated = (lead: LeadOption) => {\n    setCreateLeadOpen(false);\n    const normalized: LeadOption = {\n      id: lead.id,\n      name: lead.name,\n      email: lead.email,\n      phone: lead.phone,\n      status: lead.status,\n      status_id: lead.status_id,\n    };\n    setLeadOptions((prev) => {\n      const without = prev.filter((item) => item.id !== normalized.id);\n      return [normalized, ...without];\n    });\n    handleAssignLead(normalized);\n    void loadLeads(\"\");\n  };\n\n  const showInitialLoading = loading && !hasLoadedOnce && leadOptions.length === 0;\n  const showEmptyState = !loading && hasLoadedOnce && leadOptions.length === 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h2 className=\"text-xl font-semibold tracking-tight\">\n          {t(\"steps.lead.heading\")}\n        </h2>\n        <p className=\"text-sm text-muted-foreground\">\n          {t(\"steps.lead.description\")}\n        </p>\n      </div>\n\n      <div className=\"space-y-3\">\n        <Label className=\"text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n          {t(\"steps.lead.selectExisting\")}\n        </Label>\n        <div className=\"relative\" ref={containerRef}>\n          <Button\n            type=\"button\"\n            onClick={() => setDropdownOpen((prev) => !prev)}\n            className={cn(\n              \"group flex h-12 w-full items-center justify-between rounded-xl border border-border/70 bg-white px-4 py-3 text-left font-semibold text-slate-900 shadow-sm transition hover:border-emerald-400/70 hover:shadow-md focus-visible:ring-2 focus-visible:ring-emerald-300\",\n              dropdownOpen && \"border-emerald-400/80 shadow-emerald-200\",\n              loading && leadOptions.length === 0 && \"cursor-wait opacity-70\"\n            )}\n            disabled={loading && leadOptions.length === 0}\n          >\n            {selectedLeadOption ? (\n              <div className=\"flex w-full items-center justify-between gap-3\">\n                <LeadSummaryPreview\n                  lead={selectedLeadOption}\n                  textColor=\"text-slate-900\"\n                  subtleColor=\"text-muted-foreground\"\n                />\n                {(selectedLeadOption.status || selectedLeadOption.status_id) ? (\n                  <LeadStatusBadge\n                    leadId={selectedLeadOption.id}\n                    currentStatusId={selectedLeadOption.status_id ?? undefined}\n                    currentStatus={selectedLeadOption.status ?? undefined}\n                    editable={false}\n                    size=\"sm\"\n                    statuses={leadStatuses}\n                    statusesLoading={leadStatusesLoading}\n                  />\n                ) : null}\n              </div>\n            ) : loading && !hasLoadedOnce ? (\n              t(\"steps.lead.loading\")\n            ) : (\n              t(\"steps.lead.selectPlaceholder\")\n            )}\n            <ChevronDown className=\"ml-2 h-4 w-4 shrink-0 text-muted-foreground transition group-data-[state=open]:rotate-180\" />\n          </Button>\n\n          {dropdownOpen && (\n            <div className=\"absolute top-full left-0 right-0 z-50 mt-2 rounded-2xl border border-border bg-background shadow-xl\">\n              <div className=\"px-4 py-3\">\n                <div className=\"relative\">\n                  <Search className=\"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                  <Input\n                    value={searchTerm}\n                    onChange={(event) => setSearchTerm(event.target.value)}\n                    placeholder={t(\"steps.lead.searchPlaceholder\")}\n                    className=\"h-11 rounded-xl border border-border bg-white pl-9 text-sm shadow-inner focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100\"\n                    autoFocus\n                  />\n                </div>\n              </div>\n              <div className=\"relative max-h-64 min-h-[10rem] overflow-y-auto border-t border-border/80 bg-white\">\n                {showInitialLoading ? (\n                  <div className=\"flex h-full flex-col items-center justify-center gap-2 px-4 py-6 text-sm text-muted-foreground\">\n                    <Loader2 className=\"h-4 w-4 animate-spin text-emerald-500\" />\n                    {t(\"steps.lead.loading\")}\n                  </div>\n                ) : showEmptyState ? (\n                  <p className=\"px-4 py-6 text-center text-sm text-muted-foreground\">\n                    {searchTerm ? t(\"steps.lead.noResults\") : t(\"steps.lead.emptyState\")}\n                  </p>\n                ) : (\n                  <>\n                    {loading && (\n                      <div className=\"sticky top-0 flex items-center gap-2 bg-white/95 px-4 py-2 text-xs text-muted-foreground backdrop-blur\">\n                        <Loader2 className=\"h-3.5 w-3.5 animate-spin\" />\n                        {t(\"steps.lead.loading\")}\n                      </div>\n                    )}\n                    <div className=\"divide-y\">\n                      {leadOptions.map((lead) => {\n                        const isActive = state.lead.id === lead.id;\n                        return (\n                          <button\n                            key={lead.id}\n                            type=\"button\"\n                            onClick={() => handleAssignLead(lead)}\n                            className={cn(\n                              \"flex w-full items-center justify-between px-4 py-3 text-left transition hover:bg-muted/60\",\n                              isActive && \"bg-emerald-100/40\"\n                            )}\n                          >\n                            <div className=\"flex items-center gap-3\">\n                              <Avatar className=\"h-9 w-9 border border-border/70 bg-muted shadow-sm\">\n                                <AvatarFallback className=\"text-sm font-semibold uppercase text-slate-700\">\n                                  <LeadInitials name={lead.name} fallback=\"?\" maxInitials={2} />\n                                </AvatarFallback>\n                              </Avatar>\n                              <div className=\"flex flex-col\">\n                                <span className=\"text-sm font-semibold text-slate-900\">\n                                  {lead.name}\n                                </span>\n                                {(lead.email || lead.phone) && (\n                                  <span className=\"text-xs text-muted-foreground\">\n                                    {[lead.email, lead.phone].filter(Boolean).join(\" • \")}\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              {(lead.status || lead.status_id) ? (\n                                <LeadStatusBadge\n                                  leadId={lead.id}\n                                  currentStatusId={lead.status_id ?? undefined}\n                                  currentStatus={lead.status ?? undefined}\n                                  editable={false}\n                                  size=\"sm\"\n                                  statuses={leadStatuses}\n                                  statusesLoading={leadStatusesLoading}\n                                />\n                              ) : null}\n                              <Check\n                                className={cn(\n                                  \"h-4 w-4 text-emerald-500 transition\",\n                                  isActive ? \"opacity-100\" : \"opacity-0\"\n                                )}\n                              />\n                            </div>\n                          </button>\n                        );\n                      })}\n                    </div>\n                  </>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n\n        <Button\n          variant=\"outline\"\n          className=\"gap-2\"\n          onClick={() => setCreateLeadOpen(true)}\n        >\n          <UserPlus className=\"h-4 w-4\" />\n          {t(\"steps.lead.createButton\")}\n        </Button>\n\n        {leadOptions.length === 0 && !loading && (\n          <p className=\"text-xs text-muted-foreground\">\n            {t(\"steps.lead.emptyState\")}\n          </p>\n        )}\n      </div>\n\n      <EnhancedAddLeadDialog\n        open={createLeadOpen}\n        onOpenChange={setCreateLeadOpen}\n        onClose={() => setCreateLeadOpen(false)}\n        onSuccess={handleLeadCreated}\n      />\n    </div>\n  );\n};\n\nconst LeadSummaryPreview = ({\n  lead,\n  textColor = \"text-foreground\",\n  subtleColor = \"text-muted-foreground\",\n}: {\n  lead: LeadOption;\n  textColor?: string;\n  subtleColor?: string;\n}) => {\n  return (\n    <div className=\"flex w-full items-center gap-3\">\n      <Avatar className=\"h-9 w-9 border border-border/60 bg-muted shadow-sm\">\n        <AvatarFallback className=\"text-xs font-semibold uppercase text-slate-700\">\n          <LeadInitials name={lead.name} fallback=\"?\" maxInitials={2} />\n        </AvatarFallback>\n      </Avatar>\n      <div className=\"flex flex-col\">\n        <span className={cn(\"text-sm font-medium\", textColor)}>{lead.name}</span>\n        {(lead.email || lead.phone) && (\n          <span className={cn(\"text-xs\", subtleColor)}>\n            {[lead.email, lead.phone].filter(Boolean).join(\" • \")}\n          </span>\n        )}\n      </div>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/steps/PackagesStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/steps/SummaryStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/project-creation/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/services/components/CustomServicesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/services/components/HelperTooltip.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/services/components/ServiceVatOverridesSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/api/leadProjectCreation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/api/savedResources.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/api/sessionCreation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/components/SessionPlanningWizard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/components/SessionPlanningWizardSheet.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/components/__tests__/SessionPlanningWizardSheet.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/context/SessionPlanningOriginalStateContext.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":8,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":8,"endColumn":45}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useContext } from \"react\";\nimport type { SessionPlanningState } from \"../types\";\n\nconst SessionPlanningOriginalStateContext = createContext<SessionPlanningState | null>(null);\n\nexport const SessionPlanningOriginalStateProvider = SessionPlanningOriginalStateContext.Provider;\n\nexport const useSessionPlanningOriginalState = () =>\n  useContext(SessionPlanningOriginalStateContext);\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/context/SessionPlanningProvider.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Move your React context(s) to a separate file.","line":10,"column":14,"nodeType":"Identifier","messageId":"reactContext","endLine":10,"endColumn":36}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, ReactNode, useMemo, useReducer } from \"react\";\nimport { sessionPlanningReducer, createInitialSessionPlanningState } from \"../state/sessionPlanningReducer\";\nimport { SessionPlanningAction, SessionPlanningEntryContext, SessionPlanningState } from \"../types\";\n\ninterface SessionPlanningContextValue {\n  state: SessionPlanningState;\n  dispatch: React.Dispatch<SessionPlanningAction>;\n}\n\nexport const SessionPlanningContext = createContext<SessionPlanningContextValue | undefined>(undefined);\n\ninterface SessionPlanningProviderProps {\n  children: ReactNode;\n  entryContext?: SessionPlanningEntryContext;\n}\n\nexport const SessionPlanningProvider = ({ children, entryContext }: SessionPlanningProviderProps) => {\n  const [state, dispatch] = useReducer(\n    sessionPlanningReducer,\n    createInitialSessionPlanningState(entryContext)\n  );\n\n  const value = useMemo(\n    () => ({\n      state,\n      dispatch\n    }),\n    [state]\n  );\n\n  return <SessionPlanningContext.Provider value={value}>{children}</SessionPlanningContext.Provider>;\n};\n\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/context/SessionSavedResourcesProvider.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":207,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":207,"endColumn":38,"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/context/SessionWorkflowProvider.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/context/sessionWorkflowContext.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/context/sessionWorkflowTypes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/hooks/useSessionPlanningActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/hooks/useSessionPlanningContext.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/hooks/useSessionPlanningEntryContext.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/state/__tests__/SessionPlanningProvider.integration.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/state/__tests__/SessionPlanningReducer.startStep.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/state/sessionPlanningReducer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/LeadStep.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":75,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":75,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3027,3030],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3027,3030],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { Button } from \"@/components/ui/button\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { EnhancedAddLeadDialog } from \"@/components/EnhancedAddLeadDialog\";\nimport { useSessionPlanningActions } from \"../hooks/useSessionPlanningActions\";\nimport { useSessionPlanningContext } from \"../hooks/useSessionPlanningContext\";\nimport { useTranslation } from \"react-i18next\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { getUserOrganizationId } from \"@/lib/organizationUtils\";\nimport { Check, ChevronDown, Loader2, Search, UserPlus } from \"lucide-react\";\nimport { Label } from \"@/components/ui/label\";\nimport { Input } from \"@/components/ui/input\";\nimport { cn } from \"@/lib/utils\";\nimport { LeadStatusBadge } from \"@/components/LeadStatusBadge\";\nimport { useLeadStatuses } from \"@/hooks/useOrganizationData\";\nimport { LeadInitials } from \"@/components/LeadInitials\";\n\ninterface LeadOption {\n  id: string;\n  name: string;\n  email?: string;\n  phone?: string;\n  status?: string | null;\n  status_id?: string | null;\n}\n\nexport const LeadStep = () => {\n  const { state } = useSessionPlanningContext();\n  const { updateLead } = useSessionPlanningActions();\n  const { t } = useTranslation(\"sessionPlanning\");\n  const { toast } = useToast();\n  const [leadOptions, setLeadOptions] = useState<LeadOption[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [hasLoadedOnce, setHasLoadedOnce] = useState(false);\n  const [dropdownOpen, setDropdownOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [createLeadOpen, setCreateLeadOpen] = useState(false);\n  const containerRef = useRef<HTMLDivElement | null>(null);\n  const latestRequestRef = useRef(0);\n  const { data: leadStatuses = [], isLoading: leadStatusesLoading } = useLeadStatuses();\n\n  const loadLeads = useCallback(\n    async (term: string) => {\n      const requestId = ++latestRequestRef.current;\n      setLoading(true);\n      try {\n        const organizationId = await getUserOrganizationId();\n        if (!organizationId) {\n          if (latestRequestRef.current === requestId) {\n            setLeadOptions([]);\n          }\n          return;\n        }\n\n        const sanitized = term.trim().replace(/[%_]/g, \"\\\\$&\");\n        let query = supabase\n          .from(\"leads\")\n          .select(\"id, name, email, phone, status, status_id\")\n          .eq(\"organization_id\", organizationId)\n          .order(\"updated_at\", { ascending: false })\n          .limit(25);\n\n        if (sanitized) {\n          const filter = `name.ilike.%${sanitized}%,email.ilike.%${sanitized}%,phone.ilike.%${sanitized}%`;\n          query = query.or(filter);\n        }\n\n        const { data, error } = await query;\n        if (error) throw error;\n\n        if (latestRequestRef.current === requestId) {\n          setLeadOptions((data as LeadOption[]) || []);\n        }\n      } catch (error: any) {\n        console.error(\"Failed to load leads\", error);\n        if (latestRequestRef.current === requestId) {\n          setLeadOptions([]);\n          setHasLoadedOnce(true);\n        }\n        toast({\n          title: t(\"steps.lead.fetchErrorTitle\"),\n          description: error.message,\n          variant: \"destructive\",\n        });\n      } finally {\n        if (latestRequestRef.current === requestId) {\n          setLoading(false);\n          setHasLoadedOnce(true);\n        }\n      }\n    },\n    [toast, t]\n  );\n\n  useEffect(() => {\n    loadLeads(\"\");\n  }, [loadLeads]);\n\n  useEffect(() => {\n    if (!dropdownOpen) return;\n    const handler = window.setTimeout(() => {\n      loadLeads(searchTerm);\n    }, 250);\n    return () => {\n      window.clearTimeout(handler);\n    };\n  }, [dropdownOpen, searchTerm, loadLeads]);\n\n  useEffect(() => {\n    if (!dropdownOpen) return;\n    const handlePointerDown = (event: PointerEvent) => {\n      if (\n        containerRef.current &&\n        !containerRef.current.contains(event.target as Node)\n      ) {\n        setDropdownOpen(false);\n      }\n    };\n    document.addEventListener(\"pointerdown\", handlePointerDown);\n    return () => {\n      document.removeEventListener(\"pointerdown\", handlePointerDown);\n    };\n  }, [dropdownOpen]);\n\n  const selectedLeadOption = useMemo(() => {\n    if (!state.lead.id) return undefined;\n    return leadOptions.find((lead) => lead.id === state.lead.id);\n  }, [leadOptions, state.lead.id]);\n\n  const handleAssignLead = (lead: LeadOption) => {\n    updateLead({\n      id: lead.id,\n      name: lead.name,\n      email: lead.email,\n      phone: lead.phone,\n      notes: \"\",\n      mode: \"existing\"\n    });\n    setDropdownOpen(false);\n    setSearchTerm(\"\");\n  };\n\n  const handleLeadCreated = (lead: { id: string; name: string; email?: string | null; phone?: string | null; status?: string | null; status_id?: string | null }) => {\n    setCreateLeadOpen(false);\n    const normalized: LeadOption = {\n      id: lead.id,\n      name: lead.name,\n      email: lead.email || undefined,\n      phone: lead.phone || undefined,\n      status: lead.status || undefined,\n      status_id: lead.status_id || undefined\n    };\n    setLeadOptions((prev) => {\n      const without = prev.filter((item) => item.id !== lead.id);\n      return [normalized, ...without];\n    });\n    handleAssignLead(normalized);\n    void loadLeads(\"\");\n  };\n\n  const showInitialLoading = loading && !hasLoadedOnce && leadOptions.length === 0;\n  const showEmptyState = !loading && hasLoadedOnce && leadOptions.length === 0;\n\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"space-y-2\">\n        <h2 className=\"text-xl font-semibold tracking-tight\">{t(\"steps.lead.navigationLabel\")}</h2>\n        <p className=\"text-sm text-muted-foreground\">{t(\"steps.lead.description\")}</p>\n      </div>\n\n      <div className=\"space-y-3\">\n        <Label className=\"text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n          {t(\"steps.lead.selectExisting\")}\n        </Label>\n        <div className=\"relative\" ref={containerRef}>\n          <Button\n            type=\"button\"\n            onClick={() => setDropdownOpen((prev) => !prev)}\n            className={cn(\n              \"group flex h-12 w-full items-center justify-between rounded-xl border border-border/70 bg-white px-4 py-3 text-left font-semibold text-slate-900 shadow-sm transition hover:border-emerald-400/70 hover:shadow-md focus-visible:ring-2 focus-visible:ring-emerald-300\",\n              dropdownOpen && \"border-emerald-400/80 shadow-emerald-200\",\n              loading && leadOptions.length === 0 && \"cursor-wait opacity-70\"\n            )}\n            disabled={loading && leadOptions.length === 0}\n          >\n            {selectedLeadOption ? (\n              <div className=\"flex w-full items-center justify-between gap-3\">\n                <LeadSummaryPreview\n                  lead={selectedLeadOption}\n                  textColor=\"text-slate-900\"\n                  subtleColor=\"text-muted-foreground\"\n                />\n                {selectedLeadOption.status || selectedLeadOption.status_id ? (\n                  <LeadStatusBadge\n                    leadId={selectedLeadOption.id}\n                    currentStatusId={selectedLeadOption.status_id ?? undefined}\n                    currentStatus={selectedLeadOption.status ?? undefined}\n                    editable={false}\n                    size=\"sm\"\n                    statuses={leadStatuses}\n                    statusesLoading={leadStatusesLoading}\n                  />\n                ) : null}\n              </div>\n            ) : loading && !hasLoadedOnce ? (\n              t(\"steps.lead.loading\")\n            ) : (\n              t(\"steps.lead.selectPlaceholder\")\n            )}\n            <ChevronDown className=\"ml-2 h-4 w-4 shrink-0 text-muted-foreground transition group-data-[state=open]:rotate-180\" />\n          </Button>\n\n          {dropdownOpen && (\n            <div className=\"absolute top-full left-0 right-0 z-50 mt-2 overflow-hidden rounded-2xl border border-border bg-background shadow-xl\">\n              <div className=\"px-4 py-3\">\n                <div className=\"relative\">\n                  <Search className=\"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n                  <Input\n                    value={searchTerm}\n                    onChange={(event) => setSearchTerm(event.target.value)}\n                    placeholder={t(\"steps.lead.searchPlaceholder\")}\n                    className=\"h-11 rounded-xl border border-border bg-white pl-9 text-sm shadow-inner focus:border-emerald-400 focus:ring-2 focus:ring-emerald-100\"\n                    autoFocus\n                  />\n                </div>\n              </div>\n              <div className=\"relative max-h-64 min-h-[10rem] overflow-y-auto border-t border-border/80 bg-white\">\n                {showInitialLoading ? (\n                  <div className=\"flex h-full flex-col items-center justify-center gap-2 px-4 py-6 text-sm text-muted-foreground\">\n                    <Loader2 className=\"h-4 w-4 animate-spin text-emerald-500\" />\n                    {t(\"steps.lead.loading\")}\n                  </div>\n                ) : showEmptyState ? (\n                  <p className=\"px-4 py-6 text-center text-sm text-muted-foreground\">\n                    {searchTerm ? t(\"steps.lead.noResults\") : t(\"steps.lead.emptyState\")}\n                  </p>\n                ) : (\n                  <>\n                    {loading && (\n                      <div className=\"sticky top-0 flex items-center gap-2 bg-white/95 px-4 py-2 text-xs text-muted-foreground backdrop-blur\">\n                        <Loader2 className=\"h-3.5 w-3.5 animate-spin\" />\n                        {t(\"steps.lead.loading\")}\n                      </div>\n                    )}\n                    <div className=\"divide-y\">\n                      {leadOptions.map((lead) => {\n                        const isActive = state.lead.id === lead.id;\n                        return (\n                          <button\n                            key={lead.id}\n                            type=\"button\"\n                            onClick={() => handleAssignLead(lead)}\n                            className={cn(\n                              \"flex w-full items-center justify-between px-4 py-3 text-left transition hover:bg-muted/60\",\n                              isActive && \"bg-emerald-100/40\"\n                            )}\n                          >\n                            <div className=\"flex items-center gap-3\">\n                              <Avatar className=\"h-9 w-9 border border-border/70 bg-muted shadow-sm\">\n                                <AvatarFallback className=\"text-sm font-semibold uppercase text-slate-700\">\n                                  <LeadInitials name={lead.name} fallback=\"?\" maxInitials={2} />\n                                </AvatarFallback>\n                              </Avatar>\n                              <div className=\"flex flex-col\">\n                                <span className=\"text-sm font-semibold text-slate-900\">\n                                  {lead.name}\n                                </span>\n                                {(lead.email || lead.phone) && (\n                                  <span className=\"text-xs text-muted-foreground\">\n                                    {[lead.email, lead.phone]\n                                      .filter(Boolean)\n                                      .join(\" • \")}\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                            <div className=\"flex items-center gap-2\">\n                              {(lead.status || lead.status_id) ? (\n                                <LeadStatusBadge\n                                  leadId={lead.id}\n                                  currentStatusId={lead.status_id ?? undefined}\n                                  currentStatus={lead.status ?? undefined}\n                                  editable={false}\n                                  size=\"sm\"\n                                  statuses={leadStatuses}\n                                  statusesLoading={leadStatusesLoading}\n                                />\n                              ) : null}\n                              <Check\n                                className={cn(\n                                  \"h-4 w-4 text-emerald-500 transition\",\n                                  isActive ? \"opacity-100\" : \"opacity-0\"\n                                )}\n                              />\n                            </div>\n                          </button>\n                        );\n                      })}\n                    </div>\n                  </>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n\n        <Button\n          variant=\"outline\"\n          className=\"gap-2\"\n          onClick={() => setCreateLeadOpen(true)}\n        >\n          <UserPlus className=\"h-4 w-4\" />\n          {t(\"steps.lead.createButton\")}\n        </Button>\n\n        {leadOptions.length === 0 && !loading && (\n          <p className=\"text-xs text-muted-foreground\">{t(\"steps.lead.emptyState\")}</p>\n        )}\n      </div>\n\n      <EnhancedAddLeadDialog\n        open={createLeadOpen}\n        onOpenChange={setCreateLeadOpen}\n        onClose={() => setCreateLeadOpen(false)}\n        onSuccess={handleLeadCreated}\n      />\n    </div>\n  );\n};\n\nconst LeadSummaryPreview = ({\n  lead,\n  textColor = \"text-foreground\",\n  subtleColor = \"text-muted-foreground\",\n}: {\n  lead: LeadOption;\n  textColor?: string;\n  subtleColor?: string;\n}) => {\n  return (\n    <div className=\"flex w-full items-center gap-3\">\n      <Avatar className=\"h-9 w-9 border border-border/60 bg-muted shadow-sm\">\n        <AvatarFallback className=\"text-xs font-semibold uppercase text-slate-700\">\n          <LeadInitials name={lead.name} fallback=\"?\" maxInitials={2} />\n        </AvatarFallback>\n      </Avatar>\n      <div className=\"flex flex-col\">\n        <span className={cn(\"text-sm font-medium\", textColor)}>{lead.name}</span>\n        {(lead.email || lead.phone) && (\n          <span className={cn(\"text-xs\", subtleColor)}>\n            {[lead.email, lead.phone].filter(Boolean).join(\" • \")}\n          </span>\n        )}\n      </div>\n    </div>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/LocationStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/NotesStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/ProjectStep.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":100,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":100,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3663,3666],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3663,3666],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { useSessionPlanningActions } from \"../hooks/useSessionPlanningActions\";\nimport { useSessionPlanningContext } from \"../hooks/useSessionPlanningContext\";\nimport { useTranslation } from \"react-i18next\";\nimport { useToast } from \"@/components/ui/use-toast\";\nimport { getUserOrganizationId } from \"@/lib/organizationUtils\";\nimport { Check, ChevronDown, FolderPlus, Search } from \"lucide-react\";\nimport { Label } from \"@/components/ui/label\";\nimport { cn } from \"@/lib/utils\";\nimport { ProjectCreationWizardSheet } from \"@/features/project-creation\";\n\ninterface ProjectOption {\n  id: string;\n  name: string;\n}\n\nexport const ProjectStep = ({ onContinue }: { onContinue?: () => void } = {}) => {\n  const { state } = useSessionPlanningContext();\n  const { updateProject } = useSessionPlanningActions();\n  const { t } = useTranslation(\"sessionPlanning\");\n  const { toast } = useToast();\n  const [projectOptions, setProjectOptions] = useState<ProjectOption[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [dropdownOpen, setDropdownOpen] = useState(false);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  const [hasAnyProject, setHasAnyProject] = useState(false);\n  const [hasLoadedInitial, setHasLoadedInitial] = useState(false);\n  const [isProjectWizardOpen, setProjectWizardOpen] = useState(false);\n  const latestRequestRef = useRef(0);\n  const containerRef = useRef<HTMLDivElement | null>(null);\n\n  const leadId = state.lead.id;\n  const noProjectsAvailable =\n    Boolean(leadId) && hasLoadedInitial && !hasAnyProject;\n  const dropdownDisabled =\n    !leadId || noProjectsAvailable || (loading && projectOptions.length === 0);\n\n  useEffect(() => {\n    if (!leadId && state.project.id) {\n      updateProject({\n        id: undefined,\n        name: \"\",\n        description: \"\",\n        mode: \"existing\",\n        isSkipped: false,\n      });\n    }\n  }, [leadId, state.project.id, updateProject]);\n\n  const loadProjects = useCallback(\n    async (targetLeadId: string, term: string) => {\n      const requestId = ++latestRequestRef.current;\n      const isBaseQuery = term.trim().length === 0;\n      if (!targetLeadId) {\n        setProjectOptions([]);\n        setHasAnyProject(false);\n        setHasLoadedInitial(false);\n        return;\n      }\n      setLoading(true);\n      try {\n        const organizationId = await getUserOrganizationId();\n        if (!organizationId) {\n          if (latestRequestRef.current === requestId) {\n            setProjectOptions([]);\n            if (isBaseQuery) {\n              setHasAnyProject(false);\n              setHasLoadedInitial(true);\n            }\n          }\n          return;\n        }\n\n        const sanitized = term.trim().replace(/[%_]/g, \"\\\\$&\");\n        let query = supabase\n          .from(\"projects\")\n          .select(\"id, name\")\n          .eq(\"lead_id\", targetLeadId)\n          .eq(\"organization_id\", organizationId)\n          .order(\"updated_at\", { ascending: false })\n          .limit(25);\n\n        if (sanitized) {\n          query = query.ilike(\"name\", `%${sanitized}%`);\n        }\n\n        const { data, error } = await query;\n        if (error) throw error;\n\n        if (latestRequestRef.current === requestId) {\n          setProjectOptions((data as ProjectOption[]) || []);\n          if (isBaseQuery) {\n            setHasAnyProject(((data as ProjectOption[]) || []).length > 0);\n            setHasLoadedInitial(true);\n          }\n        }\n      } catch (error: any) {\n        console.error(\"Failed to load projects\", error);\n        if (latestRequestRef.current === requestId) {\n          setProjectOptions([]);\n          if (isBaseQuery) {\n            setHasAnyProject(false);\n            setHasLoadedInitial(true);\n          }\n        }\n        toast({\n          title: t(\"steps.project.fetchErrorTitle\"),\n          description: error.message,\n          variant: \"destructive\",\n        });\n      } finally {\n        if (latestRequestRef.current === requestId) {\n          setLoading(false);\n        }\n      }\n    },\n    [toast, t]\n  );\n\n  useEffect(() => {\n    if (!leadId) {\n      setProjectOptions([]);\n      setHasAnyProject(false);\n      setHasLoadedInitial(false);\n      return;\n    }\n    loadProjects(leadId, \"\");\n  }, [leadId, loadProjects]);\n\n  useEffect(() => {\n    if (!dropdownOpen || !leadId) return;\n    const handler = window.setTimeout(() => {\n      loadProjects(leadId, searchTerm);\n    }, 250);\n    return () => {\n      window.clearTimeout(handler);\n    };\n  }, [dropdownOpen, searchTerm, leadId, loadProjects]);\n\n  useEffect(() => {\n    if (!dropdownOpen) return;\n    const handlePointerDown = (event: PointerEvent) => {\n      if (\n        containerRef.current &&\n        !containerRef.current.contains(event.target as Node)\n      ) {\n        setDropdownOpen(false);\n      }\n    };\n    document.addEventListener(\"pointerdown\", handlePointerDown);\n    return () => {\n      document.removeEventListener(\"pointerdown\", handlePointerDown);\n    };\n  }, [dropdownOpen]);\n\n  const selectedProjectOption = useMemo(() => {\n    if (!state.project.id) return undefined;\n    return projectOptions.find((project) => project.id === state.project.id);\n  }, [projectOptions, state.project.id]);\n\n  const handleSelectProject = (project: ProjectOption) => {\n    updateProject({\n      id: project.id,\n      name: project.name,\n      description: state.project.description,\n      mode: \"existing\",\n      isSkipped: false,\n    });\n    setDropdownOpen(false);\n    setSearchTerm(\"\");\n  };\n\n  const handleProjectCreated = (project?: { id: string; name: string }) => {\n    if (project) {\n      const option = { id: project.id, name: project.name };\n      setProjectOptions((prev) => {\n        const without = prev.filter((item) => item.id !== project.id);\n        return [option, ...without];\n      });\n      handleSelectProject(option);\n    } else if (leadId) {\n      void loadProjects(leadId, \"\");\n    }\n  };\n\n  const handleSkipProject = () => {\n    updateProject({\n      id: undefined,\n      name: \"\",\n      description: \"\",\n      mode: \"existing\",\n      isSkipped: true,\n    });\n    setDropdownOpen(false);\n    setSearchTerm(\"\");\n    onContinue?.();\n  };\n\n  useEffect(() => {\n    if (dropdownOpen && (!leadId || noProjectsAvailable)) {\n      setDropdownOpen(false);\n    }\n  }, [dropdownOpen, leadId, noProjectsAvailable]);\n\n  useEffect(() => {\n    if (!leadId && isProjectWizardOpen) {\n      setProjectWizardOpen(false);\n    }\n  }, [isProjectWizardOpen, leadId]);\n\n  return (\n    <>\n      <ProjectCreationWizardSheet\n        isOpen={isProjectWizardOpen}\n        onOpenChange={setProjectWizardOpen}\n        leadId={leadId || undefined}\n        leadName={state.lead.name}\n        onProjectCreated={handleProjectCreated}\n        entrySource=\"session_planning\"\n      />\n\n      <div className=\"space-y-6\">\n        <div className=\"space-y-2\">\n          <h2 className=\"text-xl font-semibold tracking-tight\">\n            {t(\"steps.project.navigationLabel\")}\n          </h2>\n          <p className=\"text-sm text-muted-foreground\">\n            {t(\"steps.project.description\")}\n          </p>\n        </div>\n\n        <div className=\"space-y-3\">\n        <Label className=\"text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n          {t(\"steps.project.selectExisting\")}\n        </Label>\n        <div className=\"relative\" ref={containerRef}>\n          <Button\n            type=\"button\"\n            onClick={() => {\n              if (dropdownDisabled) return;\n              setDropdownOpen((prev) => !prev);\n            }}\n            className={cn(\n              \"group flex h-12 w-full items-center justify-between rounded-xl border-none bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 px-4 py-3 text-left font-semibold text-white shadow-lg shadow-emerald-500/20 transition focus-visible:ring-2 focus-visible:ring-emerald-300\",\n              dropdownOpen && \"ring-2 ring-emerald-300\",\n              dropdownDisabled && \"cursor-not-allowed opacity-60\"\n            )}\n            disabled={dropdownDisabled}\n          >\n            {selectedProjectOption ? (\n              <span className=\"text-sm font-semibold text-white\">\n                {selectedProjectOption.name}\n              </span>\n            ) : !leadId ? (\n              t(\"steps.project.selectLeadFirst\")\n            ) : loading ? (\n              t(\"steps.project.loading\")\n            ) : (\n              t(\"steps.project.selectPlaceholder\")\n            )}\n            <ChevronDown className=\"ml-2 h-4 w-4 shrink-0 opacity-80 transition group-data-[state=open]:rotate-180\" />\n          </Button>\n\n          {dropdownOpen && (\n            <div className=\"absolute top-full left-0 right-0 z-50 mt-2 overflow-hidden rounded-2xl border border-emerald-200/40 bg-white shadow-2xl shadow-emerald-900/10\">\n              <div className=\"bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 px-4 py-3 text-sm font-semibold text-white\">\n                {t(\"steps.project.searchHeading\")}\n              </div>\n              <div className=\"px-4 py-3\">\n                <div className=\"relative\">\n                  <Search className=\"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-emerald-500\" />\n                  <Input\n                    value={searchTerm}\n                    onChange={(event) => setSearchTerm(event.target.value)}\n                    placeholder={t(\"steps.project.searchPlaceholder\")}\n                    className=\"h-11 rounded-xl border border-emerald-300/60 bg-white pl-9 text-sm shadow-inner shadow-emerald-900/5 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-200\"\n                    autoFocus\n                  />\n                </div>\n              </div>\n              <div className=\"max-h-64 overflow-y-auto border-t border-slate-100\">\n                {loading ? (\n                  <p className=\"px-4 py-6 text-center text-sm text-muted-foreground\">\n                    {t(\"steps.project.loading\")}\n                  </p>\n                ) : projectOptions.length === 0 ? (\n                  <p className=\"px-4 py-6 text-center text-sm text-muted-foreground\">\n                    {searchTerm\n                      ? t(\"steps.project.noResults\")\n                      : t(\"steps.project.emptyState\")}\n                  </p>\n                ) : (\n                  projectOptions.map((project) => {\n                    const isActive = state.project.id === project.id;\n                    return (\n                      <button\n                        key={project.id}\n                        type=\"button\"\n                        onClick={() => handleSelectProject(project)}\n                        className={cn(\n                          \"flex w-full items-center justify-between px-4 py-3 text-left transition hover:bg-emerald-50/70\",\n                          isActive && \"bg-emerald-500/10\"\n                        )}\n                      >\n                        <span className=\"text-sm font-semibold text-slate-900\">\n                          {project.name}\n                        </span>\n                        <Check\n                          className={cn(\n                            \"h-4 w-4 text-emerald-500 transition\",\n                            isActive ? \"opacity-100\" : \"opacity-0\"\n                          )}\n                        />\n                      </button>\n                    );\n                  })\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n\n        {noProjectsAvailable && (\n          <div className=\"rounded-2xl border border-border/70 bg-white px-4 py-6 text-sm text-muted-foreground shadow-sm\">\n            {t(\"steps.project.noProjects\")}\n          </div>\n        )}\n\n        <div className=\"flex flex-wrap items-center gap-3\">\n          <Button\n            variant=\"outline\"\n            className=\"h-11 gap-2\"\n            disabled={!leadId}\n            onClick={() => {\n              if (!leadId) return;\n              setProjectWizardOpen(true);\n            }}\n          >\n            <FolderPlus className=\"h-4 w-4\" />\n            {t(\"steps.project.createButton\")}\n          </Button>\n\n          <Button\n            type=\"button\"\n            variant=\"ghost\"\n            className=\"h-11 px-4 text-sm font-medium text-muted-foreground transition hover:bg-emerald-50 hover:text-emerald-600\"\n            onClick={handleSkipProject}\n          >\n            {t(\"steps.project.skipButton\")}\n          </Button>\n        </div>\n\n        {leadId && projectOptions.length === 0 && !loading && !noProjectsAvailable && (\n          <p className=\"text-xs text-muted-foreground\">\n            {t(\"steps.project.emptyState\")}\n          </p>\n        )}\n        </div>\n      </div>\n    </>\n  );\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/ScheduleStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/SessionTypeStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/steps/SummaryStep.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/session-planning/utils/sanitizeNotes.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/features/wizard/components/WizardStepList.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/use-mobile.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useAccessibility.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useCalendarPerformanceMonitor.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useDataTable.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useDebounce.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useEntityActions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useEntityData.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useKanbanSettings.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useLeadDetailData.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useLeadStatusActions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useMilestoneNotifications.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":32,"column":46,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":32,"endColumn":49,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1164,1167],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1164,1167],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useMilestoneNotifications } from \"../useMilestoneNotifications\";\n\nconst triggerProjectMilestoneMock = jest.fn();\n\njest.mock(\"@/hooks/useNotificationTriggers\", () => ({\n  useNotificationTriggers: () => ({\n    triggerProjectMilestone: (...args: unknown[]) => triggerProjectMilestoneMock(...args),\n  }),\n}));\n\ndescribe(\"useMilestoneNotifications\", () => {\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it(\"logs a warning when invoking the deprecated sender\", async () => {\n    const consoleSpy = jest.spyOn(console, \"log\").mockImplementation(() => {});\n\n    const { sendPendingMilestoneNotifications } = useMilestoneNotifications();\n    await sendPendingMilestoneNotifications();\n\n    expect(consoleSpy).toHaveBeenCalledWith(\n      \"Legacy milestone notification method called - please use triggerProjectMilestone directly\"\n    );\n    consoleSpy.mockRestore();\n  });\n\n  it(\"re-exports triggerProjectMilestone from the notification triggers hook\", async () => {\n    const { triggerProjectMilestone } = useMilestoneNotifications();\n\n    const payload = { projectId: \"proj-1\", milestoneId: \"milestone-2\" };\n    await triggerProjectMilestone(payload as any);\n\n    expect(triggerProjectMilestoneMock).toHaveBeenCalledWith(payload);\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useNotificationTriggers.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useOrganizationData.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useOrganizationQuickSettings.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useOrganizationSettings.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useOrganizationTimezone.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useProjectPayments.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useProjectSessionsSummary.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useReminderActions.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useSessionActions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useSessionEditForm.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useSessionForm.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useSessionReminderScheduling.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useSettingsSection.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useSmartTimeRange.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useTemplateBuilder.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useTemplateValidation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useUserPreferences.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/__tests__/useWorkflowTriggers.test.ts","messages":[{"ruleId":"react-hooks/rules-of-hooks","severity":2,"message":"React Hook \"useToast\" cannot be called at the top level. React Hooks must be called in a React function component or a custom React Hook function.","line":30,"column":20,"nodeType":"Identifier","endLine":30,"endColumn":28}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"jest.mock(\"@/integrations/supabase/client\", () => {\n  const invoke = jest.fn();\n  return {\n    supabase: {\n      functions: {\n        invoke,\n      },\n    },\n    __esModule: true,\n    _invokeMock: invoke,\n  };\n});\n\njest.mock(\"@/hooks/use-toast\", () => {\n  const toast = jest.fn();\n  return {\n    useToast: () => ({ toast }),\n    __esModule: true,\n    _toastMock: toast,\n  };\n});\n\nimport { useWorkflowTriggers } from \"../useWorkflowTriggers\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nconst VALID_SESSION_ID = \"123e4567-e89b-12d3-a456-426614174000\";\nconst VALID_ORG_ID = \"123e4567-e89b-12d3-a456-426614174001\";\nconst invokeMock = supabase.functions.invoke as jest.Mock;\nconst toastMock = (useToast() as { toast: jest.Mock }).toast;\n\nbeforeEach(() => {\n  invokeMock.mockReset();\n  toastMock.mockReset();\n});\n\ndescribe(\"useWorkflowTriggers\", () => {\n  describe(\"triggerWorkflow\", () => {\n    it(\"rejects when required parameters are missing\", async () => {\n      const { triggerWorkflow } = useWorkflowTriggers();\n\n      await expect(\n        triggerWorkflow(\"session_scheduled\", \"session\", \"\", VALID_ORG_ID)\n      ).rejects.toThrow(\"Missing required parameters\");\n      expect(invokeMock).not.toHaveBeenCalled();\n    });\n\n    it(\"rejects when ids fail UUID validation\", async () => {\n      const { triggerWorkflow } = useWorkflowTriggers();\n\n      await expect(\n        triggerWorkflow(\"session_scheduled\", \"session\", \"not-a-uuid\", VALID_ORG_ID)\n      ).rejects.toThrow(\"Invalid entity ID format\");\n\n      await expect(\n        triggerWorkflow(\"session_scheduled\", \"session\", VALID_SESSION_ID, \"invalid-org\")\n      ).rejects.toThrow(\"Invalid organization ID format\");\n\n      expect(invokeMock).not.toHaveBeenCalled();\n    });\n\n    it(\"surfaces Supabase errors and shows a destructive toast\", async () => {\n      const { triggerWorkflow } = useWorkflowTriggers();\n\n      const supabaseError = new Error(\"RPC exploded\");\n      invokeMock.mockResolvedValueOnce({ data: null, error: supabaseError });\n\n      await expect(\n        triggerWorkflow(\"session_completed\", \"session\", VALID_SESSION_ID, VALID_ORG_ID)\n      ).rejects.toThrow(\"RPC exploded\");\n\n      expect(toastMock).toHaveBeenCalledWith({\n        title: \"Workflow Error\",\n        description: \"RPC exploded\",\n        variant: \"destructive\",\n      });\n    });\n\n    it(\"does not toast when Supabase reports no workflows\", async () => {\n      const { triggerWorkflow } = useWorkflowTriggers();\n\n      const noWorkflowError = new Error(\"No workflows found for this trigger\");\n      invokeMock.mockResolvedValueOnce({ data: null, error: noWorkflowError });\n\n      await expect(\n        triggerWorkflow(\"session_completed\", \"session\", VALID_SESSION_ID, VALID_ORG_ID)\n      ).rejects.toThrow(\"No workflows found for this trigger\");\n\n      expect(toastMock).not.toHaveBeenCalled();\n    });\n\n    it(\"resolves with result payload when invocation succeeds\", async () => {\n      const { triggerWorkflow } = useWorkflowTriggers();\n\n      invokeMock.mockResolvedValueOnce({\n        data: { result: { triggered_workflows: 0, detail: \"ok\" } },\n        error: null,\n      });\n\n      await expect(\n        triggerWorkflow(\"session_completed\", \"session\", VALID_SESSION_ID, VALID_ORG_ID)\n      ).resolves.toEqual({ triggered_workflows: 0, detail: \"ok\" });\n\n      expect(toastMock).not.toHaveBeenCalled();\n    });\n  });\n\n  describe(\"trigger wrappers\", () => {\n    beforeEach(() => {\n      invokeMock.mockResolvedValue({\n        data: { result: { triggered_workflows: 1 } },\n        error: null,\n      });\n    });\n\n    it(\"enriches session scheduled trigger payload with session metadata\", async () => {\n      const { triggerSessionScheduled } = useWorkflowTriggers();\n\n      await triggerSessionScheduled(VALID_SESSION_ID, VALID_ORG_ID, {\n        session_date: \"2024-01-01\",\n        session_time: \"09:00\",\n        location: \"Studio\",\n        custom: \"value\",\n      });\n\n      expect(invokeMock).toHaveBeenCalledWith(\"workflow-executor\", {\n        body: expect.objectContaining({\n          trigger_type: \"session_scheduled\",\n          trigger_entity_type: \"session\",\n          trigger_entity_id: VALID_SESSION_ID,\n          organization_id: VALID_ORG_ID,\n          trigger_data: expect.objectContaining({\n            session_date: \"2024-01-01\",\n            session_time: \"09:00\",\n            location: \"Studio\",\n            custom: \"value\",\n          }),\n        }),\n      });\n    });\n\n    it(\"passes through project status change payload\", async () => {\n      const { triggerProjectStatusChange } = useWorkflowTriggers();\n\n      await triggerProjectStatusChange(\n        VALID_SESSION_ID,\n        VALID_ORG_ID,\n        \"proposal\",\n        \"booked\",\n        { project_name: \"Wedding\" }\n      );\n\n      expect(invokeMock).toHaveBeenCalledWith(\"workflow-executor\", {\n        body: expect.objectContaining({\n          trigger_type: \"project_status_change\",\n          trigger_entity_type: \"project\",\n          trigger_data: expect.objectContaining({\n            old_status: \"proposal\",\n            new_status: \"booked\",\n            project_name: \"Wedding\",\n          }),\n        }),\n      });\n    });\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/use-mobile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/use-toast.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useAccessibility.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useCalendarPerformanceMonitor.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useDataTable.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useDebounce.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useEntityActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useEntityData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useKanbanSettings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadDetailData.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":36,"column":17,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":36,"endColumn":20,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1240,1243],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1240,1243],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useMemo } from \"react\";\nimport { useQuery, UseQueryResult } from \"@tanstack/react-query\";\nimport { useOrganization } from \"@/contexts/OrganizationContext\";\nimport {\n  fetchLeadById,\n  fetchLeadSessions,\n  fetchLeadProjectSummary,\n  fetchLatestLeadActivity,\n  LeadDetailRecord,\n  LeadSessionRecord,\n  LeadProjectSummaryPayload,\n  AggregatedPaymentSummary,\n  ProjectSummary\n} from \"@/services/LeadDetailService\";\nimport { useLeadStatuses } from \"./useOrganizationData\";\n\nconst ACTIVE_SESSION_STATUSES = new Set([\"planned\", \"upcoming\", \"confirmed\", \"scheduled\"]);\n\ninterface SessionMetrics {\n  todayCount: number;\n  todayNext: LeadSessionRecord | null;\n  nextUpcoming: LeadSessionRecord | null;\n  overdueCount: number;\n}\n\nexport interface LeadDetailQueryResult {\n  lead: LeadDetailRecord | null;\n  leadQuery: UseQueryResult<LeadDetailRecord | null, unknown>;\n  sessions: LeadSessionRecord[];\n  sessionsQuery: UseQueryResult<LeadSessionRecord[], unknown>;\n  projectSummary: ProjectSummary;\n  aggregatedPayments: AggregatedPaymentSummary;\n  summaryQuery: UseQueryResult<LeadProjectSummaryPayload, unknown>;\n  latestLeadActivity: string | null;\n  latestActivityQuery: UseQueryResult<string | null, unknown>;\n  leadStatuses: any[];\n  sessionMetrics: SessionMetrics;\n  latestSessionUpdate: string | null;\n  hasProjects: boolean;\n  isLoading: boolean;\n  refetchAll: () => Promise<void>;\n}\n\nconst DEFAULT_SUMMARY: ProjectSummary = { count: 0, latestUpdate: null };\nconst DEFAULT_PAYMENTS: AggregatedPaymentSummary = {\n  totalPaid: 0,\n  total: 0,\n  remaining: 0,\n  currency: \"TRY\"\n};\nconst DEFAULT_METRICS: SessionMetrics = {\n  todayCount: 0,\n  todayNext: null,\n  nextUpcoming: null,\n  overdueCount: 0\n};\n\nfunction sortSessions(sessions: LeadSessionRecord[]): LeadSessionRecord[] {\n  const sorted = [...sessions];\n\n  sorted.sort((a, b) => {\n    const aStatus = (a.status || \"\").toLowerCase();\n    const bStatus = (b.status || \"\").toLowerCase();\n\n    const aIsPlanned = aStatus === \"planned\";\n    const bIsPlanned = bStatus === \"planned\";\n\n    if (aIsPlanned !== bIsPlanned) {\n      return aIsPlanned ? -1 : 1;\n    }\n\n    const aDate = a.session_date ? new Date(a.session_date).getTime() : 0;\n    const bDate = b.session_date ? new Date(b.session_date).getTime() : 0;\n\n    return bDate - aDate;\n  });\n\n  return sorted;\n}\n\nfunction computeSessionMetrics(sessions: LeadSessionRecord[]): SessionMetrics {\n  if (!sessions.length) {\n    return DEFAULT_METRICS;\n  }\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n  const todayKey = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, \"0\")}-${String(\n    today.getDate()\n  ).padStart(2, \"0\")}`;\n\n  const activeSessions = sessions\n    .map((session) => {\n      if (!session.session_date) return null;\n      const normalizedStatus = (session.status || \"\").toLowerCase();\n      if (!ACTIVE_SESSION_STATUSES.has(normalizedStatus)) return null;\n\n      const date = (() => {\n        const timePart = (session.session_time ?? \"\").trim();\n        if (timePart) {\n          const candidate = new Date(`${session.session_date}T${timePart}`);\n          if (!Number.isNaN(candidate.getTime())) return candidate;\n        }\n\n        const fallback = new Date(session.session_date);\n        return Number.isNaN(fallback.getTime()) ? null : fallback;\n      })();\n\n      if (!date) return null;\n      return { session, date };\n    })\n    .filter((value): value is { session: LeadSessionRecord; date: Date } => Boolean(value))\n    .sort((a, b) => a.date.getTime() - b.date.getTime());\n\n  const todays: LeadSessionRecord[] = [];\n  let nextUpcoming: LeadSessionRecord | null = null;\n  let overdueCount = 0;\n\n  for (const entry of activeSessions) {\n    const sessionKey = entry.session.session_date\n      ? entry.session.session_date.slice(0, 10)\n      : null;\n\n    if (!sessionKey) continue;\n\n    if (sessionKey < todayKey) {\n      overdueCount += 1;\n      continue;\n    }\n\n    if (sessionKey === todayKey) {\n      todays.push(entry.session);\n      continue;\n    }\n\n    if (!nextUpcoming) {\n      nextUpcoming = entry.session;\n    }\n  }\n\n  return {\n    todayCount: todays.length,\n    todayNext: todays[0] ?? null,\n    nextUpcoming,\n    overdueCount\n  };\n}\n\nfunction computeLatestSessionUpdate(sessions: LeadSessionRecord[]): string | null {\n  if (!sessions.length) return null;\n\n  return sessions.reduce<string | null>((latest, session) => {\n    const candidate = session.updated_at || session.created_at || null;\n    if (!candidate) return latest;\n    if (!latest) return candidate;\n    return new Date(candidate).getTime() > new Date(latest).getTime() ? candidate : latest;\n  }, null);\n}\n\nexport function useLeadDetailData(leadId?: string): LeadDetailQueryResult {\n  const { activeOrganizationId, loading: orgLoading } = useOrganization();\n  const {\n    data: leadStatuses = [],\n    isLoading: statusesLoading\n  } = useLeadStatuses();\n\n  const leadQuery = useQuery({\n    queryKey: [\"lead\", leadId],\n    queryFn: () => fetchLeadById(leadId!),\n    enabled: !!leadId,\n    staleTime: 5 * 60 * 1000\n  });\n\n  const sessionsQuery = useQuery({\n    queryKey: [\"lead\", leadId, \"sessions\", activeOrganizationId],\n    queryFn: () => fetchLeadSessions(leadId!, activeOrganizationId),\n    enabled: !!leadId && !orgLoading,\n    staleTime: 2 * 60 * 1000\n  });\n\n  const summaryQuery = useQuery({\n    queryKey: [\"lead\", leadId, \"project-summary\", activeOrganizationId],\n    queryFn: () => fetchLeadProjectSummary(leadId!, activeOrganizationId!),\n    enabled: !!leadId && !!activeOrganizationId,\n    staleTime: 2 * 60 * 1000\n  });\n\n  const latestActivityQuery = useQuery({\n    queryKey: [\"lead\", leadId, \"latest-activity\"],\n    queryFn: () => fetchLatestLeadActivity(leadId!),\n    enabled: !!leadId,\n    staleTime: 60 * 1000\n  });\n\n  const sessions = useMemo(() => {\n    if (!sessionsQuery.data) return [];\n    return sortSessions(sessionsQuery.data).map((session) => ({\n      ...session,\n      project_name: session.projects?.name ?? undefined\n    }));\n  }, [sessionsQuery.data]);\n\n  const sessionMetrics = useMemo(() => computeSessionMetrics(sessions), [sessions]);\n  const latestSessionUpdate = useMemo(() => computeLatestSessionUpdate(sessions), [sessions]);\n\n  const projectSummary = summaryQuery.data?.summary ?? DEFAULT_SUMMARY;\n  const aggregatedPayments = summaryQuery.data?.payments ?? DEFAULT_PAYMENTS;\n\n  const isLoading =\n    leadQuery.isLoading ||\n    sessionsQuery.isLoading ||\n    summaryQuery.isLoading ||\n    latestActivityQuery.isLoading ||\n    statusesLoading ||\n    orgLoading;\n\n  const refetchAll = useCallback(async () => {\n    await Promise.all([\n      leadQuery.refetch(),\n      sessionsQuery.refetch(),\n      summaryQuery.refetch(),\n      latestActivityQuery.refetch()\n    ]);\n  }, [leadQuery, sessionsQuery, summaryQuery, latestActivityQuery]);\n\n  return {\n    lead: leadQuery.data ?? null,\n    leadQuery,\n    sessions,\n    sessionsQuery,\n    projectSummary,\n    aggregatedPayments,\n    summaryQuery,\n    latestLeadActivity: latestActivityQuery.data ?? null,\n    latestActivityQuery,\n    leadStatuses,\n    sessionMetrics,\n    latestSessionUpdate,\n    hasProjects: summaryQuery.data?.hasProjects ?? false,\n    isLoading,\n    refetchAll\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadFieldDefinitions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadFieldValues.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadStatusActions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadStatusWorkflows.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":13,"column":16,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":13,"endColumn":19,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[428,431],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[428,431],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useWorkflowTriggers } from '@/hooks/useWorkflowTriggers';\n\nexport function useLeadStatusWorkflows() {\n  const { triggerLeadStatusChange } = useWorkflowTriggers();\n\n  const triggerLeadStatusWorkflow = async (\n    leadId: string,\n    organizationId: string,\n    oldStatusName: string,\n    newStatusName: string,\n    leadData?: any\n  ) => {\n    try {\n      await triggerLeadStatusChange(leadId, organizationId, oldStatusName, newStatusName, leadData);\n    } catch (error) {\n      console.error('Error triggering lead status workflow:', error);\n    }\n  };\n\n  return {\n    triggerLeadStatusWorkflow\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadTableColumns.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadUpdate.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":19,"column":37,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":19,"endColumn":40,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[563,566],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[563,566],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useToast } from '@/hooks/use-toast';\n\ninterface UseLeadUpdateProps {\n  leadId: string;\n  onSuccess?: () => void;\n}\n\nexport function useLeadUpdate({ leadId, onSuccess }: UseLeadUpdateProps) {\n  const [isUpdating, setIsUpdating] = useState(false);\n  const { toast } = useToast();\n\n  const updateCoreField = async (fieldKey: string, value: string | null) => {\n    if (isUpdating) return;\n    \n    setIsUpdating(true);\n    try {\n      const updates: Record<string, any> = {\n        [fieldKey]: value || null,\n        updated_at: new Date().toISOString()\n      };\n\n      const { error } = await supabase\n        .from('leads')\n        .update(updates)\n        .eq('id', leadId);\n\n      if (error) throw error;\n\n      toast({\n        title: \"Field updated\",\n        description: \"The field has been updated successfully.\",\n      });\n\n      onSuccess?.();\n    } catch (error) {\n      console.error('Error updating core field:', error);\n      toast({\n        title: \"Update failed\",\n        description: \"Failed to update the field. Please try again.\",\n        variant: \"destructive\",\n      });\n      throw error;\n    } finally {\n      setIsUpdating(false);\n    }\n  };\n\n  const updateCustomField = async (fieldKey: string, value: string | null) => {\n    if (isUpdating) return;\n    \n    setIsUpdating(true);\n    try {\n      const { error } = await supabase\n        .from('lead_field_values')\n        .upsert({\n          lead_id: leadId,\n          field_key: fieldKey,\n          value: value || null,\n          updated_at: new Date().toISOString()\n        }, {\n          onConflict: 'lead_id,field_key'\n        });\n\n      if (error) throw error;\n\n      toast({\n        title: \"Field updated\",\n        description: \"The custom field has been updated successfully.\",\n      });\n\n      onSuccess?.();\n    } catch (error) {\n      console.error('Error updating custom field:', error);\n      toast({\n        title: \"Update failed\",\n        description: \"Failed to update the custom field. Please try again.\",\n        variant: \"destructive\",\n      });\n      throw error;\n    } finally {\n      setIsUpdating(false);\n    }\n  };\n\n  return {\n    isUpdating,\n    updateCoreField,\n    updateCustomField\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLeadsWithCustomFields.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchLeadsWithCustomFields'. Either include it or remove the dependency array.","line":95,"column":6,"nodeType":"ArrayExpression","endLine":95,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchLeadsWithCustomFields]","fix":{"range":[2882,2884],"text":"[fetchLeadsWithCustomFields]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { getUserOrganizationId } from '@/lib/organizationUtils';\nimport { useToast } from '@/hooks/use-toast';\n\nexport interface LeadWithCustomFields {\n  id: string;\n  name: string;\n  email: string;\n  phone: string;\n  status: string;\n  status_id: string;\n  updated_at: string;\n  created_at: string;\n  due_date?: string;\n  notes?: string;\n  custom_fields: Record<string, string | null>;\n  lead_statuses?: {\n    id: string;\n    name: string;\n    color: string;\n    is_system_final: boolean;\n  };\n}\n\nexport function useLeadsWithCustomFields() {\n  const [leads, setLeads] = useState<LeadWithCustomFields[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n  const { toast } = useToast();\n\n  const fetchLeadsWithCustomFields = async () => {\n    try {\n      setLoading(true);\n      setError(null);\n\n      const organizationId = await getUserOrganizationId();\n      if (!organizationId) {\n        throw new Error('No active organization found');\n      }\n\n      // Fetch leads with status information\n      const { data: leadsData, error: leadsError } = await supabase\n        .from('leads')\n        .select(`\n          *,\n          lead_statuses(id, name, color, is_system_final)\n        `)\n        .eq('organization_id', organizationId)\n        .order('updated_at', { ascending: false });\n\n      if (leadsError) throw leadsError;\n\n      // Fetch all custom field values for these leads\n      const leadIds = leadsData?.map(lead => lead.id) || [];\n      const { data: fieldValues, error: fieldValuesError } = await supabase\n        .from('lead_field_values')\n        .select('lead_id, field_key, value')\n        .in('lead_id', leadIds);\n\n      if (fieldValuesError) throw fieldValuesError;\n\n      // Group field values by lead_id\n      const fieldValuesByLead = (fieldValues || []).reduce((acc, fv) => {\n        if (!acc[fv.lead_id]) {\n          acc[fv.lead_id] = {};\n        }\n        acc[fv.lead_id][fv.field_key] = fv.value;\n        return acc;\n      }, {} as Record<string, Record<string, string | null>>);\n\n      // Combine leads with their custom field values\n      const leadsWithFields: LeadWithCustomFields[] = (leadsData || []).map(lead => ({\n        ...lead,\n        custom_fields: fieldValuesByLead[lead.id] || {},\n      }));\n\n      setLeads(leadsWithFields);\n    } catch (err) {\n      console.error('Error fetching leads with custom fields:', err);\n      const errorMessage = err instanceof Error ? err.message : 'Failed to fetch leads';\n      setError(errorMessage);\n      toast({\n        title: \"Error fetching leads\",\n        description: errorMessage,\n        variant: \"destructive\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchLeadsWithCustomFields();\n  }, []);\n\n  return {\n    leads,\n    loading,\n    error,\n    refetch: fetchLeadsWithCustomFields\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useLifecycle.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useMilestoneNotifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useModalNavigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useNotificationTriggers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOnboardingBulletproofTest.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":102,"column":14,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":102,"endColumn":17,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[4986,4989],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[4986,4989],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"// V3 BULLETPROOF TEST FOR ONBOARDING SYSTEM\n// This file comprehensively tests all critical paths and edge cases\n\nimport { ONBOARDING_STEPS, TOTAL_STEPS } from \"@/constants/onboarding\";\n\nexport const runOnboardingBulletproofTestV3 = () => {\n  // Development-only test suite for onboarding system\n  if (process.env.NODE_ENV !== 'development') return;\n  \n  // Test 1: Verify step definitions\n  console.log(`✅ Step Count: ${TOTAL_STEPS} steps defined`);\n  console.log(`✅ Steps Array Length: ${ONBOARDING_STEPS.length}`);\n  console.log(`✅ Steps Match: ${TOTAL_STEPS === ONBOARDING_STEPS.length ? 'PASS' : 'FAIL'}`);\n  \n  // Test 2: Verify all steps have required properties\n  ONBOARDING_STEPS.forEach((step, index) => {\n    const hasRequiredProps = step.id && step.title && step.description && step.route && step.buttonText && step.duration;\n    console.log(`✅ Step ${index + 1} completeness: ${hasRequiredProps ? 'PASS' : 'FAIL'}`);\n  });\n  \n  // Test 3: Verify step IDs are sequential\n  const sequentialIds = ONBOARDING_STEPS.every((step, index) => step.id === index + 1);\n  console.log(`✅ Sequential Step IDs: ${sequentialIds ? 'PASS' : 'FAIL'}`);\n  \n  // Test 4: V3 Critical flow tests \n  const v3CriticalFlows = [\n    '🎯 NEW USER FLOW:',\n    '  - New user → Welcome modal appears → Start guided setup → Navigate to getting-started',\n    '  - New user → Welcome modal appears → Close modal → Modal marked as shown (no re-show)',\n    '  - New user → Welcome modal appears → Skip with sample data → Navigate to dashboard',\n    '🔄 RESTART FLOW:',\n    '  - Restart button → Direct guided setup (bypass modal) → Navigate to getting-started',\n    '  - No modal flickering or race conditions during restart',\n    '🚪 EXIT FLOW:',\n    '  - Exit button → Complete onboarding → Auto-redirect (no manual navigation)',\n    '  - No flickering or navigation loops',\n    '🔒 SESSION MANAGEMENT:',\n    '  - Modal shown once per session → Session tracking prevents re-show',\n    '  - Page refresh → Session state reset → Modal can show again if needed',\n    '⚡ STATE TRANSITIONS:',\n    '  - not_started → in_progress (via startGuidedSetup)',\n    '  - in_progress → completed (via completeOnboarding)',\n    '  - any_state → in_progress (via resetOnboarding with bypass)',\n    '  - Atomic database updates prevent race conditions'\n  ];\n  \n  console.log('\\n🎯 V3 CRITICAL FLOWS TO TEST:');\n  v3CriticalFlows.forEach((flow, index) => {\n    if (flow.startsWith('🎯') || flow.startsWith('🔄') || flow.startsWith('🚪') || flow.startsWith('🔒') || flow.startsWith('⚡')) {\n      console.log(`\\n${flow}`);\n    } else {\n      console.log(`${flow}`);\n    }\n  });\n  \n  // Test 5: V3 Enhanced edge cases\n  const v3EdgeCases = [\n    'User manually changes database onboarding_stage during session',\n    'User has invalid current_onboarding_step value (sanitized automatically)',\n    'Database connection fails during state fetch (graceful fallback)',\n    'User_settings record doesn\\'t exist (auto-created with defaults)',\n    'Step completion called when not in guided setup (safely ignored)', \n    'Step completion called beyond total steps (range validation)',\n    'Multiple rapid step completions (atomic updates prevent conflicts)',\n    'Page refresh during onboarding (session state reset)',\n    'Navigation while in guided setup (route protection active)',\n    'Modal closed without action (session tracking prevents re-show)',\n    'Restart during active guided setup (direct bypass to guided mode)',\n    'Exit during tutorial steps (completes onboarding properly)',\n    'Multiple browser tabs with same user (state synchronization)',\n    'Network interruption during state updates (error handling)',\n    'Component unmount during async operations (cleanup handling)'\n  ];\n  \n  console.log('\\n⚠️  V3 EDGE CASES HANDLED:');\n  v3EdgeCases.forEach((edge, index) => {\n    console.log(`${index + 1}. ${edge}`);\n  });\n  \n  // Test 6: V3 Session tracking validation\n  console.log('\\n🔐 V3 SESSION TRACKING FEATURES:');\n  console.log('1. sessionModalShown flag prevents multiple modal displays');\n  console.log('2. markModalShown() function tracks modal display without starting setup');\n  console.log('3. Session state resets on page refresh (new browser session)');\n  console.log('4. Enhanced shouldShowWelcomeModal includes session tracking');\n  console.log('5. Restart flow bypasses modal entirely via direct guided setup');\n  \n  // Test 7: V3 Enhanced logging\n  console.log('\\n📝 V3 ENHANCED LOGGING:');\n  console.log('1. All state transitions logged with V3 prefix');\n  console.log('2. Component-level logging for modal display logic');\n  console.log('3. Button-level logging for user actions');\n  console.log('4. Database operation logging with error details');\n  console.log('5. Session tracking logging for debugging');\n  \n  console.log('\\n✅ V3 BULLETPROOF SYSTEM READY - NO MORE MODAL FLICKERING!');\n  return true;\n};\n\n// Export for testing in development\nif (typeof window !== 'undefined') {\n  (window as any).testOnboardingV3 = runOnboardingBulletproofTestV3;\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOptimizedCalendarData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOptimizedCalendarEvents.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOptimizedCalendarNavigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOptimizedCalendarViewport.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOptimizedTouchHandlers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOptimizedViewport.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOrganizationData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOrganizationQuickSettings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOrganizationSettings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useOrganizationTimezone.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProfile.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProjectActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProjectHeaderSummary.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":87,"column":22,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":87,"endColumn":25,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2334,2337],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2334,2337],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useState } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\n\nexport interface ProjectHeaderPaymentSummary {\n  totalPaid: number;\n  total: number;\n  remaining: number;\n  currency: string;\n}\n\nexport interface ProjectHeaderTodoSummary {\n  total: number;\n  completed: number;\n}\n\nexport interface ProjectHeaderServicesSummary {\n  total: number;\n  names: string[];\n  totalValue: number;\n}\n\ninterface ProjectHeaderSummaryState {\n  payments: ProjectHeaderPaymentSummary;\n  todos: ProjectHeaderTodoSummary;\n  services: ProjectHeaderServicesSummary;\n}\n\nconst DEFAULT_SUMMARY: ProjectHeaderSummaryState = {\n  payments: {\n    totalPaid: 0,\n    total: 0,\n    remaining: 0,\n    currency: \"TRY\"\n  },\n  todos: {\n    total: 0,\n    completed: 0\n  },\n  services: {\n    total: 0,\n    names: [],\n    totalValue: 0\n  }\n};\n\nexport function useProjectHeaderSummary(projectId?: string | null, refreshToken?: number) {\n  const [summary, setSummary] = useState<ProjectHeaderSummaryState>(DEFAULT_SUMMARY);\n  const [loading, setLoading] = useState(false);\n\n  const fetchSummary = useCallback(async () => {\n    if (!projectId) {\n      setSummary(DEFAULT_SUMMARY);\n      return;\n    }\n\n    setLoading(true);\n    try {\n      const [projectResponse, servicesResponse, paymentsResponse, todosResponse] = await Promise.all([\n        supabase.from(\"projects\").select(\"base_price\").eq(\"id\", projectId).single(),\n        supabase\n          .from(\"project_services\")\n          .select(`\n            billing_type,\n            services!inner (\n              id,\n              name,\n              selling_price,\n              price\n            )\n          `)\n          .eq(\"project_id\", projectId),\n        supabase\n          .from(\"payments\")\n          .select(\"amount, status\")\n          .eq(\"project_id\", projectId),\n        supabase.from(\"todos\").select(\"id, is_completed\").eq(\"project_id\", projectId)\n      ]);\n\n      if (projectResponse.error) throw projectResponse.error;\n      if (servicesResponse.error) throw servicesResponse.error;\n      if (paymentsResponse.error) throw paymentsResponse.error;\n      if (todosResponse.error) throw todosResponse.error;\n\n      const basePrice = Number(projectResponse.data?.base_price) || 0;\n\n      const serviceEntries = (servicesResponse.data || [])\n        .map((entry: any) => {\n          const service = entry.services;\n          if (!service) return null;\n          return {\n            billing_type: entry.billing_type as string,\n            service: service as {\n              id: string;\n              name: string;\n              selling_price?: number | null;\n              price?: number | null;\n            }\n          };\n        })\n        .filter(Boolean) as Array<{\n          billing_type: string;\n          service: {\n            id: string;\n            name: string;\n            selling_price?: number | null;\n            price?: number | null;\n          };\n        }>;\n      const serviceNames = serviceEntries.map(entry => entry.service.name).filter(Boolean);\n      const servicesTotal = serviceEntries.reduce((total, entry) => {\n        if (entry.billing_type !== \"extra\") {\n          return total;\n        }\n        const value = entry.service.selling_price ?? entry.service.price ?? 0;\n        return total + Number(value) || total;\n      }, 0);\n\n      const paymentRows = paymentsResponse.data || [];\n      const totalPaid = paymentRows.reduce((total, payment) => {\n        if (payment.status === \"paid\") {\n          return total + Number(payment.amount) || total;\n        }\n        return total;\n      }, 0);\n\n      const totalProjectValue = basePrice + servicesTotal;\n      const remaining = Math.max(0, totalProjectValue - totalPaid);\n\n      const todoRows = todosResponse.data || [];\n      const completedTodos = todoRows.filter(todo => todo.is_completed).length;\n\n      setSummary({\n        payments: {\n          totalPaid,\n          total: totalProjectValue,\n          remaining,\n          currency: \"TRY\"\n        },\n        todos: {\n          total: todoRows.length,\n          completed: completedTodos\n        },\n        services: {\n          total: serviceNames.length,\n          names: serviceNames,\n          totalValue: servicesTotal\n        }\n      });\n    } catch (error) {\n      console.error(\"Failed to load project header summary:\", error);\n      setSummary(DEFAULT_SUMMARY);\n    } finally {\n      setLoading(false);\n    }\n  }, [projectId]);\n\n  useEffect(() => {\n    fetchSummary();\n  }, [fetchSummary, refreshToken]);\n\n  return {\n    summary,\n    loading,\n    refresh: fetchSummary\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProjectPayments.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPaymentSummary'. Either include it or remove the dependency array.","line":85,"column":6,"nodeType":"ArrayExpression","endLine":85,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPaymentSummary, projectId, refreshTrigger]","fix":{"range":[2383,2410],"text":"[fetchPaymentSummary, projectId, refreshTrigger]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface PaymentSummary {\n  totalPaid: number;\n  totalProject: number;\n  remaining: number;\n  currency: string;\n}\n\nexport const useProjectPayments = (projectId: string, refreshTrigger?: number) => {\n  const [paymentSummary, setPaymentSummary] = useState<PaymentSummary>({\n    totalPaid: 0,\n    totalProject: 0,\n    remaining: 0,\n    currency: 'TRY',\n  });\n  const [loading, setLoading] = useState(true);\n\n  const fetchPaymentSummary = async () => {\n    try {\n      // Get project base price\n      const { data: projectData, error: projectError } = await supabase\n        .from('projects')\n        .select('base_price')\n        .eq('id', projectId)\n        .single();\n\n      if (projectError) throw projectError;\n\n      // Get total cost of added services\n      const { data: servicesData, error: servicesError } = await supabase\n        .from('project_services')\n        .select(`\n          services!inner (\n            selling_price,\n            price\n          )\n        `)\n        .eq('project_id', projectId);\n\n      if (servicesError) throw servicesError;\n\n      // Get total paid amount\n      const { data: paymentsData, error: paymentsError } = await supabase\n        .from('payments')\n        .select('amount')\n        .eq('project_id', projectId)\n        .eq('status', 'paid');\n\n      if (paymentsError) throw paymentsError;\n\n      const basePrice = projectData?.base_price || 0;\n      const servicesCost = servicesData?.reduce((sum, ps) => {\n        const service = ps.services;\n        const price = service.selling_price || service.price || 0;\n        return sum + Number(price);\n      }, 0) || 0;\n      \n      const totalProject = basePrice + servicesCost;\n      const totalPaid = paymentsData?.reduce((sum, payment) => sum + Number(payment.amount), 0) || 0;\n      const remaining = Math.max(0, totalProject - totalPaid);\n\n      setPaymentSummary({\n        totalPaid,\n        totalProject,\n        remaining,\n        currency: 'TRY',\n      });\n    } catch (error) {\n      console.error('Error fetching payment summary:', error);\n      setPaymentSummary({\n        totalPaid: 0,\n        totalProject: 0,\n        remaining: 0,\n        currency: 'TRY',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchPaymentSummary();\n  }, [projectId, refreshTrigger]);\n\n  return { paymentSummary, loading, refetch: fetchPaymentSummary };\n};","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProjectProgress.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchTodoProgress'. Either include it or remove the dependency array.","line":43,"column":6,"nodeType":"ArrayExpression","endLine":43,"endColumn":33,"suggestions":[{"desc":"Update the dependencies array to be: [fetchTodoProgress, projectId, refreshTrigger]","fix":{"range":[1184,1211],"text":"[fetchTodoProgress, projectId, refreshTrigger]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\n\ninterface TodoProgress {\n  total: number;\n  completed: number;\n  percentage: number;\n}\n\nexport const useProjectProgress = (projectId: string, refreshTrigger?: number) => {\n  const [progress, setProgress] = useState<TodoProgress>({\n    total: 0,\n    completed: 0,\n    percentage: 0,\n  });\n  const [loading, setLoading] = useState(true);\n\n  const fetchTodoProgress = async () => {\n    try {\n      const { data, error } = await supabase\n        .from('todos')\n        .select('is_completed')\n        .eq('project_id', projectId);\n\n      if (error) throw error;\n\n      const todos = data || [];\n      const total = todos.length;\n      const completed = todos.filter(todo => todo.is_completed).length;\n      const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;\n\n      setProgress({ total, completed, percentage });\n    } catch (error) {\n      console.error('Error fetching todo progress:', error);\n      setProgress({ total: 0, completed: 0, percentage: 0 });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchTodoProgress();\n  }, [projectId, refreshTrigger]);\n\n  return { progress, loading, refetch: fetchTodoProgress };\n};","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProjectSessionsSummary.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useProjectStatusController.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":176,"column":23,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":176,"endColumn":26,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5977,5980],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5977,5980],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useNotificationTriggers } from \"@/hooks/useNotificationTriggers\";\nimport { useOrganization } from \"@/contexts/OrganizationContext\";\nimport { useWorkflowTriggers } from \"@/hooks/useWorkflowTriggers\";\nimport { useFormsTranslation } from \"@/hooks/useTypedTranslation\";\n\nexport interface ProjectStatus {\n  id: string;\n  name: string;\n  color: string;\n}\n\ninterface UseProjectStatusControllerOptions {\n  projectId: string;\n  currentStatusId?: string | null;\n  onStatusChange?: () => void;\n  statuses?: ProjectStatus[];\n  statusesLoading?: boolean;\n}\n\ninterface UseProjectStatusControllerResult {\n  statuses: ProjectStatus[];\n  currentStatus: ProjectStatus | null;\n  loading: boolean;\n  isUpdating: boolean;\n  handleStatusChange: (newStatusId: string) => Promise<void>;\n}\n\nexport function useProjectStatusController({\n  projectId,\n  currentStatusId,\n  onStatusChange,\n  statuses: passedStatuses,\n  statusesLoading\n}: UseProjectStatusControllerOptions): UseProjectStatusControllerResult {\n  const [statuses, setStatuses] = useState<ProjectStatus[]>([]);\n  const [currentStatus, setCurrentStatus] = useState<ProjectStatus | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [isUpdating, setIsUpdating] = useState(false);\n  const { toast } = useToast();\n  const { triggerProjectMilestone } = useNotificationTriggers();\n  const { activeOrganization } = useOrganization();\n  const { triggerProjectStatusChange } = useWorkflowTriggers();\n  const { t: tForms } = useFormsTranslation();\n\n  const fetchProjectStatuses = useCallback(async () => {\n    try {\n      const { data, error } = await supabase\n        .from(\"project_statuses\")\n        .select(\"*\")\n        .order(\"sort_order\", { ascending: true });\n\n      if (error) throw error;\n      setStatuses(data || []);\n    } catch (error) {\n      console.error(\"Error fetching project statuses:\", error);\n      toast({\n        title: tForms(\"status.errorUpdatingStatus\"),\n        description: tForms(\"status.statusNotFound\"),\n        variant: \"destructive\"\n      });\n    } finally {\n      setLoading(false);\n    }\n  }, [toast, tForms]);\n\n  useEffect(() => {\n    if (passedStatuses === undefined) {\n      fetchProjectStatuses();\n      return;\n    }\n\n    setStatuses(passedStatuses);\n    if (typeof statusesLoading === \"boolean\") {\n      setLoading(statusesLoading);\n    } else {\n      setLoading(false);\n    }\n  }, [fetchProjectStatuses, passedStatuses, statusesLoading]);\n\n  useEffect(() => {\n    if (currentStatusId && statuses.length > 0) {\n      const status = statuses.find(statusItem => statusItem.id === currentStatusId);\n      setCurrentStatus(status || null);\n    } else if (!currentStatusId) {\n      setCurrentStatus(null);\n    }\n  }, [currentStatusId, statuses]);\n\n  const handleStatusChange = useCallback(\n    async (newStatusId: string) => {\n      if (currentStatus && newStatusId === currentStatus.id) return;\n\n      setIsUpdating(true);\n      try {\n        const { data: userData } = await supabase.auth.getUser();\n        if (!userData.user) throw new Error(\"User not authenticated\");\n\n        const nextStatus = statuses.find(statusItem => statusItem.id === newStatusId);\n        if (!nextStatus) throw new Error(tForms(\"status.statusNotFound\"));\n        const organizationId = activeOrganization?.id ?? null;\n\n        const { data: projectData, error: projectError } = await supabase\n          .from(\"projects\")\n          .select(\"lead_id\")\n          .eq(\"id\", projectId)\n          .single();\n\n        if (projectError) throw projectError;\n\n        const { error: updateError } = await supabase\n          .from(\"projects\")\n          .update({ status_id: newStatusId })\n          .eq(\"id\", projectId);\n\n        if (updateError) throw updateError;\n\n        if (organizationId && currentStatus) {\n          const { error: activityError } = await supabase\n            .from(\"activities\")\n            .insert({\n              content: `Status changed from \"${currentStatus.name}\" to \"${nextStatus.name}\"`,\n              type: \"status_change\",\n              project_id: projectId,\n              lead_id: projectData.lead_id,\n              user_id: userData.user.id,\n              organization_id: organizationId\n            });\n\n          if (activityError) {\n            console.error(\"Error logging activity:\", activityError);\n          }\n        } else if (organizationId) {\n          const { error: activityError } = await supabase\n            .from(\"activities\")\n            .insert({\n              content: `Status set to \"${nextStatus.name}\"`,\n              type: \"status_change\",\n              project_id: projectId,\n              lead_id: projectData.lead_id,\n              user_id: userData.user.id,\n              organization_id: organizationId\n            });\n\n          if (activityError) {\n            console.error(\"Error logging activity:\", activityError);\n          }\n        }\n\n        setCurrentStatus(nextStatus);\n        onStatusChange?.();\n\n        toast({\n          title: tForms(\"status.statusUpdated\"),\n          description: `Project status ${currentStatus ? \"changed\" : \"set\"} to \"${nextStatus.name}\"`\n        });\n\n        if (organizationId && currentStatus?.id) {\n          await triggerProjectMilestone(projectId, currentStatus.id, newStatusId, organizationId);\n        }\n\n        if (organizationId && currentStatus?.id) {\n          try {\n            await triggerProjectStatusChange(projectId, organizationId, currentStatus.name, nextStatus.name, {\n              old_status_id: currentStatus.id,\n              new_status_id: newStatusId,\n              project_id: projectId,\n              lead_id: projectData.lead_id\n            });\n          } catch (workflowError) {\n            console.error(\"Error triggering project status workflow:\", workflowError);\n          }\n        }\n      } catch (error: any) {\n        toast({\n          title: tForms(\"status.errorUpdatingStatus\"),\n          description: error.message,\n          variant: \"destructive\"\n        });\n      } finally {\n        setIsUpdating(false);\n      }\n    },\n    [\n      activeOrganization?.id,\n      currentStatus,\n      onStatusChange,\n      projectId,\n      statuses,\n      tForms,\n      toast,\n      triggerProjectMilestone,\n      triggerProjectStatusChange\n    ]\n  );\n\n  return useMemo(\n    () => ({\n      statuses,\n      currentStatus,\n      loading,\n      isUpdating,\n      handleStatusChange\n    }),\n    [currentStatus, handleStatusChange, isUpdating, loading, statuses]\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useReminderActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSessionActions.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSessionEditForm.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":234,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":234,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[7318,7321],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[7318,7321],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { useWorkflowTriggers } from \"@/hooks/useWorkflowTriggers\";\nimport { useSessionReminderScheduling } from \"@/hooks/useSessionReminderScheduling\";\nimport { sessionSchema, sanitizeInput, sanitizeHtml } from \"@/lib/validation\";\nimport { ZodError } from \"zod\";\nimport { getUserOrganizationId } from \"@/lib/organizationUtils\";\nimport { generateSessionName } from \"@/lib/sessionUtils\";\n\n\ninterface SessionEditFormData {\n  session_name: string;\n  session_date: string;\n  session_time: string;\n  notes: string;\n  location: string;\n  project_id?: string;\n}\n\ninterface UseSessionEditFormProps {\n  sessionId: string;\n  leadId: string;\n  leadName: string;\n  initialData: {\n    session_name?: string;\n    session_date: string;\n    session_time: string;\n    notes?: string;\n    location?: string;\n    project_id?: string;\n  };\n  onSuccess?: () => void;\n}\n\nexport function useSessionEditForm({ \n  sessionId, \n  leadId, \n  leadName, \n  initialData, \n  onSuccess \n}: UseSessionEditFormProps) {\n  const [loading, setLoading] = useState(false);\n  const [errors, setErrors] = useState<Record<string, string>>({});\n  const [formData, setFormData] = useState<SessionEditFormData>({\n    session_name: initialData.session_name || \"\",\n    session_date: initialData.session_date,\n    session_time: initialData.session_time,\n    notes: initialData.notes || \"\",\n    location: initialData.location || \"\",\n    project_id: initialData.project_id || \"\"\n  });\n\n  const { triggerSessionRescheduled } = useWorkflowTriggers();\n  const { rescheduleSessionReminders } = useSessionReminderScheduling();\n\n  // Update form data when initial data changes (using primitive dependencies)\n  useEffect(() => {\n    setFormData(prev => {\n      const newData = {\n        session_name: initialData.session_name || \"\",\n        session_date: initialData.session_date,\n        session_time: initialData.session_time,\n        notes: initialData.notes || \"\",\n        location: initialData.location || \"\",\n        project_id: initialData.project_id || \"\"\n      };\n      \n      // Only update if data actually changed to prevent unnecessary rerenders\n      if (JSON.stringify(prev) !== JSON.stringify(newData)) {\n        return newData;\n      }\n      return prev;\n    });\n  }, [\n    initialData.session_name,\n    initialData.session_date,\n    initialData.session_time,\n    initialData.notes,\n    initialData.location,\n    initialData.project_id\n  ]);\n\n\n  const handleInputChange = (field: keyof SessionEditFormData, value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n    \n    // Clear field-specific errors when user starts typing\n    if (errors[field]) {\n      setErrors(prev => {\n        const newErrors = { ...prev };\n        delete newErrors[field];\n        return newErrors;\n      });\n    }\n  };\n\n  const resetForm = () => {\n    setFormData({\n      session_name: initialData.session_name || \"\",\n      session_date: initialData.session_date,\n      session_time: initialData.session_time,\n      notes: initialData.notes || \"\",\n      location: initialData.location || \"\",\n      project_id: initialData.project_id || \"\"\n    });\n    setErrors({});\n  };\n\n  const isDirty = Boolean(\n    formData.session_name !== (initialData.session_name || \"\") ||\n    formData.session_date !== initialData.session_date ||\n    formData.session_time !== initialData.session_time ||\n    formData.notes !== (initialData.notes || \"\") ||\n    formData.location !== (initialData.location || \"\") ||\n    formData.project_id !== (initialData.project_id || \"\")\n  );\n\n  const isValid = Boolean(\n    formData.session_date &&\n    formData.session_time &&\n    Object.keys(errors).length === 0\n  );\n\n  const validateForm = async () => {\n    setErrors({});\n    \n    try {\n      await sessionSchema.parseAsync({\n        session_date: sanitizeInput(formData.session_date),\n        session_time: sanitizeInput(formData.session_time),\n        notes: formData.notes ? await sanitizeHtml(formData.notes) : undefined\n      });\n      return true;\n    } catch (error) {\n      if (error instanceof ZodError) {\n        const newErrors: Record<string, string> = {};\n        error.issues.forEach((err) => {\n          const field = err.path[0] as string;\n          newErrors[field] = err.message;\n        });\n        setErrors(newErrors);\n      }\n      return false;\n    }\n  };\n\n  const submitForm = async () => {\n    if (!(await validateForm())) {\n      toast({\n        title: \"Validation error\",\n        description: \"Please fix the validation errors before saving.\",\n        variant: \"destructive\"\n      });\n      return false;\n    }\n\n    if (!isValid) {\n      toast({\n        title: \"Validation error\",\n        description: \"Date and time are required.\",\n        variant: \"destructive\"\n      });\n      return false;\n    }\n\n    setLoading(true);\n    try {\n      // Check if date/time changed for workflow trigger\n      const dateTimeChanged = \n        formData.session_date !== initialData.session_date || \n        formData.session_time !== initialData.session_time;\n      const oldDateTime = `${initialData.session_date} ${initialData.session_time}`;\n      const newDateTime = `${formData.session_date} ${formData.session_time}`;\n\n      // Generate session name if empty\n      const finalSessionName = formData.session_name.trim() || \n        generateSessionName(leadName || \"Client\");\n\n      const { error } = await supabase\n        .from('sessions')\n        .update({\n          session_name: sanitizeInput(finalSessionName),\n          session_date: sanitizeInput(formData.session_date),\n          session_time: sanitizeInput(formData.session_time),\n          notes: formData.notes ? await sanitizeHtml(formData.notes) : null,\n          location: formData.location.trim() || null,\n          project_id: formData.project_id || null\n        })\n        .eq('id', sessionId);\n\n      if (error) throw error;\n\n      // Trigger workflow for session rescheduled if date/time changed\n      if (dateTimeChanged) {\n        try {\n          const organizationId = await getUserOrganizationId();\n          if (organizationId) {\n            await triggerSessionRescheduled(sessionId, organizationId, oldDateTime, newDateTime, {\n              session_date: formData.session_date,\n              session_time: formData.session_time,\n              location: formData.location,\n              client_name: leadName,\n              lead_id: leadId,\n              project_id: formData.project_id || null\n            });\n          }\n        } catch (workflowError) {\n          console.error('Error triggering rescheduled workflow:', workflowError);\n          // Don't block session update if workflow fails\n        }\n      }\n\n      // Reschedule session reminders if date/time changed\n      if (dateTimeChanged) {\n        try {\n          await rescheduleSessionReminders(sessionId);\n        } catch (reminderError) {\n          console.error('Error rescheduling session reminders:', reminderError);\n          // Don't block session update if reminder scheduling fails\n        }\n      }\n\n      toast({\n        title: \"Success\",\n        description: \"Session updated successfully.\"\n      });\n\n      onSuccess?.();\n      return true;\n    } catch (error: any) {\n      toast({\n        title: \"Error updating session\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return {\n    formData,\n    loading,\n    errors,\n    isDirty,\n    isValid,\n    handleInputChange,\n    resetForm,\n    submitForm\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSessionForm.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":138,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":138,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3976,3979],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3976,3979],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState } from \"react\";\nimport { toast } from \"@/hooks/use-toast\";\nimport { useWorkflowTriggers } from \"@/hooks/useWorkflowTriggers\";\nimport { useSessionReminderScheduling } from \"@/hooks/useSessionReminderScheduling\";\nimport { createSession } from \"@/features/session-planning/api/sessionCreation\";\n\ninterface SessionFormData {\n  session_name: string;\n  session_date: string;\n  session_time: string;\n  notes: string;\n  location: string;\n  project_id?: string;\n}\n\ninterface UseSessionFormProps {\n  leadId: string;\n  leadName: string;\n  projectId?: string;\n  onSuccess?: () => void;\n}\n\nexport function useSessionForm({ leadId, leadName, projectId, onSuccess }: UseSessionFormProps) {\n  const [loading, setLoading] = useState(false);\n  const [formData, setFormData] = useState<SessionFormData>({\n    session_name: \"\",\n    session_date: \"\",\n    session_time: \"\",\n    notes: \"\",\n    location: \"\",\n    project_id: projectId || \"\"\n  });\n\n  const { triggerSessionScheduled } = useWorkflowTriggers();\n  const { scheduleSessionReminders } = useSessionReminderScheduling();\n\n  const handleInputChange = (field: keyof SessionFormData, value: string) => {\n    setFormData(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n\n  const resetForm = () => {\n    setFormData({\n      session_name: \"\",\n      session_date: \"\",\n      session_time: \"\",\n      notes: \"\",\n      location: \"\",\n      project_id: projectId || \"\"\n    });\n  };\n\n  const isDirty = Boolean(\n    formData.session_name.trim() ||\n    formData.session_date.trim() ||\n    formData.session_time.trim() ||\n    formData.notes.trim() ||\n    formData.location.trim()\n  );\n\n  const isValid = Boolean(\n    formData.session_name.trim() &&\n    formData.session_date &&\n    formData.session_time\n  );\n\n  const submitForm = async () => {\n    if (!isValid) {\n      toast({\n        title: \"Validation error\",\n        description: \"Session name, date and time are required.\",\n        variant: \"destructive\"\n      });\n      return false;\n    }\n\n    setLoading(true);\n    try {\n      const resolvedProjectId = formData.project_id || projectId || undefined;\n\n      const { sessionId, organizationId } = await createSession(\n        {\n          leadId,\n          leadName,\n          sessionName: formData.session_name.trim(),\n          sessionDate: formData.session_date,\n          sessionTime: formData.session_time,\n          notes: formData.notes,\n          location: formData.location,\n          projectId: resolvedProjectId\n        },\n        {\n          updateLeadStatus: !resolvedProjectId,\n          createActivity: !resolvedProjectId\n        }\n      );\n\n      // Trigger workflow for session scheduled\n      try {\n        console.log(`🚀 Triggering session_scheduled workflow for session: ${sessionId}`);\n        const workflowResult = await triggerSessionScheduled(sessionId, organizationId, {\n          session_date: formData.session_date,\n          session_time: formData.session_time,\n          location: formData.location,\n          client_name: leadName,\n          lead_id: leadId,\n          project_id: resolvedProjectId,\n          status: 'planned'\n        });\n        console.log(`✅ Session workflow result:`, workflowResult);\n      } catch (workflowError) {\n        console.error('❌ Error triggering session_scheduled workflow:', workflowError);\n        toast({\n          title: \"Warning\", \n          description: \"Session created successfully, but notifications may not be sent.\",\n          variant: \"default\"\n        });\n      }\n\n      // Schedule session reminders\n      try {\n        console.log(`⏰ Scheduling reminders for session: ${sessionId}`);\n        await scheduleSessionReminders(sessionId);\n      } catch (reminderError) {\n        console.error('❌ Error scheduling session reminders:', reminderError);\n      }\n\n      toast({\n        title: \"Success\",\n        description: \"Session scheduled successfully.\"\n      });\n\n      resetForm();\n      onSuccess?.();\n      return true;\n    } catch (error: any) {\n      toast({\n        title: \"Error scheduling session\",\n        description: error.message,\n        variant: \"destructive\"\n      });\n      return false;\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return {\n    formData,\n    loading,\n    isDirty,\n    isValid,\n    handleInputChange,\n    resetForm,\n    submitForm\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSessionReminderScheduling.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSettingsCategorySection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSettingsNavigation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSettingsSection.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSettingsSectionWithContext.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":72,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":75,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[432,435],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[432,435],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from \"react\";\nimport { useSettingsSection } from \"./useSettingsSection\";\nimport { useSettingsContext } from \"@/contexts/SettingsContext\";\n\ninterface SettingsSectionWithContextOptions<T> {\n  sectionId: string;\n  sectionName: string;\n  initialValues: T;\n  onSave: (values: T) => Promise<void>;\n  autoSave?: boolean;\n  throttleMs?: number;\n}\n\nexport function useSettingsSectionWithContext<T extends Record<string, any>>(\n  options: SettingsSectionWithContextOptions<T>\n) {\n  const { addDirtySection, removeDirtySection } = useSettingsContext();\n  const section = useSettingsSection(options);\n\n  // Track dirty state in context\n  useEffect(() => {\n    if (section.isDirty) {\n      addDirtySection(options.sectionId);\n    } else {\n      removeDirtySection(options.sectionId);\n    }\n  }, [section.isDirty, options.sectionId, addDirtySection, removeDirtySection]);\n\n  // Override handleSave to update context\n  const handleSave = async () => {\n    await section.handleSave();\n    removeDirtySection(options.sectionId);\n  };\n\n  // Override handleCancel to update context\n  const handleCancel = () => {\n    section.handleCancel();\n    removeDirtySection(options.sectionId);\n  };\n\n  return {\n    ...section,\n    handleSave,\n    handleCancel\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useSmartTimeRange.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTemplateBuilder.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTemplateOperations.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTemplateValidation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTemplateVariables.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchVariables'. Either include it or remove the dependency array.","line":26,"column":6,"nodeType":"ArrayExpression","endLine":26,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [activeOrganization?.id, fetchVariables]","fix":{"range":[789,813],"text":"[activeOrganization?.id, fetchVariables]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useOrganization } from \"@/contexts/OrganizationContext\";\nimport { TemplateVariable } from \"@/types/templateBuilder\";\n\ninterface BusinessInfo {\n  name: string;\n  logo_url: string | null;\n  primary_brand_color: string;\n  phone?: string;\n  email?: string;\n  address?: string;\n  website?: string;\n}\n\nexport function useTemplateVariables() {\n  const [variables, setVariables] = useState<TemplateVariable[]>([]);\n  const [businessInfo, setBusinessInfo] = useState<BusinessInfo | null>(null);\n  const [loading, setLoading] = useState(true);\n  const { activeOrganization } = useOrganization();\n\n  useEffect(() => {\n    if (activeOrganization?.id) {\n      fetchVariables();\n    }\n  }, [activeOrganization?.id]);\n\n  const fetchVariables = async () => {\n    if (!activeOrganization?.id) return;\n\n    try {\n      setLoading(true);\n\n      // Fetch organization settings for business info\n      const { data: orgSettings } = await supabase\n        .from(\"organization_settings\")\n        .select(\"photography_business_name, logo_url, primary_brand_color\")\n        .eq(\"organization_id\", activeOrganization.id)\n        .single();\n\n      // Fetch lead field definitions for dynamic variables\n      const { data: leadFields } = await supabase\n        .from(\"lead_field_definitions\")\n        .select(\"field_key, label, field_type\")\n        .eq(\"organization_id\", activeOrganization.id)\n        .order(\"sort_order\");\n\n      // Set business info\n      if (orgSettings) {\n        setBusinessInfo({\n          name: orgSettings.photography_business_name || \"Your Business\",\n          logo_url: orgSettings.logo_url,\n          primary_brand_color: orgSettings.primary_brand_color || \"#1EB29F\",\n        });\n      }\n\n      // Build template variables\n      const templateVariables: TemplateVariable[] = [\n        // Business variables (only real ones from organization_settings)\n        {\n          key: \"business_name\",\n          label: \"Business Name\",\n          category: \"business\"\n        },\n\n        // Lead variables from field definitions\n        ...(leadFields?.map(field => ({\n          key: `lead_${field.field_key}`,\n          label: `Lead ${field.label}`,\n          category: \"lead\" as const\n        })) || []),\n\n        // Static lead variables that exist in database\n        {\n          key: \"lead_status\",\n          label: \"Lead Status\",\n          category: \"lead\"\n        },\n        {\n          key: \"lead_due_date\",\n          label: \"Lead Due Date\", \n          category: \"lead\"\n        },\n        {\n          key: \"lead_created_date\",\n          label: \"Lead Created Date\",\n          category: \"lead\"\n        },\n        {\n          key: \"lead_updated_date\",\n          label: \"Lead Updated Date\",\n          category: \"lead\"\n        },\n\n        // Session variables (real database fields)\n        {\n          key: \"session_date\",\n          label: \"Session Date\",\n          category: \"session\"\n        },\n        {\n          key: \"session_time\", \n          label: \"Session Time\",\n          category: \"session\"\n        },\n        {\n          key: \"session_location\",\n          label: \"Session Location\",\n          category: \"session\"\n        },\n        {\n          key: \"session_notes\",\n          label: \"Session Notes\",\n          category: \"session\"\n        },\n        {\n          key: \"session_status\",\n          label: \"Session Status\",\n          category: \"session\"\n        },\n\n        // Project variables (real database fields)\n        {\n          key: \"project_name\",\n          label: \"Project Name\",\n          category: \"project\"\n        },\n        {\n          key: \"project_type\",\n          label: \"Project Type\", \n          category: \"project\"\n        },\n        {\n          key: \"project_status\",\n          label: \"Project Status\",\n          category: \"project\"\n        },\n        {\n          key: \"project_due_date\",\n          label: \"Project Due Date\",\n          category: \"project\"\n        },\n\n        // System variables\n        {\n          key: \"current_date\",\n          label: \"Current Date\",\n          category: \"custom\"\n        },\n        {\n          key: \"current_time\",\n          label: \"Current Time\", \n          category: \"custom\"\n        }\n      ];\n\n      setVariables(templateVariables);\n    } catch (error) {\n      console.error(\"Error fetching template variables:\", error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const getVariableValue = (key: string, mockData?: Record<string, string>): string => {\n    // If mock data is provided, use it first\n    if (mockData && mockData[key]) {\n      return mockData[key];\n    }\n\n    // Business variables (only real ones)\n    if (key === \"business_name\") return businessInfo?.name || \"Your Business\";\n\n    // Lead variables with fallbacks\n    if (key.startsWith(\"lead_\")) {\n      const fieldKey = key.replace(\"lead_\", \"\");\n      if (fieldKey === \"name\") return \"John Smith\";\n      if (fieldKey === \"email\") return \"john@example.com\";\n      if (fieldKey === \"phone\") return \"-\"; // Show dash for empty phone\n      if (fieldKey === \"notes\") return \"Sample notes\";\n      if (fieldKey === \"status\") return \"New\";\n      if (fieldKey === \"due_date\") return new Date().toLocaleDateString();\n      if (fieldKey === \"created_date\") return new Date().toLocaleDateString();\n      if (fieldKey === \"updated_date\") return new Date().toLocaleDateString();\n      // For custom fields, return placeholder\n      return `Sample ${fieldKey}`;\n    }\n\n    // Session variables (real database fields)\n    if (key === \"session_date\") return new Date().toLocaleDateString();\n    if (key === \"session_time\") return \"2:00 PM\";  \n    if (key === \"session_location\") return \"Studio Location\";\n    if (key === \"session_notes\") return \"Bring comfortable clothes\";\n    if (key === \"session_status\") return \"Planned\";\n\n    // Project variables (real database fields)\n    if (key === \"project_name\") return \"Wedding Photography\";\n    if (key === \"project_type\") return \"Wedding\";\n    if (key === \"project_status\") return \"In Progress\";\n    if (key === \"project_due_date\") return new Date().toLocaleDateString();\n\n    // System variables\n    if (key === \"current_date\") return new Date().toLocaleDateString();\n    if (key === \"current_time\") return new Date().toLocaleTimeString();\n\n    return `{${key}}`;\n  };\n\n  return {\n    variables,\n    businessInfo,\n    loading,\n    getVariableValue,\n    refetch: fetchVariables\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTemplates.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useThrottledRefetchOnFocus.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTranslationFiles.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTutorialExit.ts","messages":[{"ruleId":"no-empty","severity":2,"message":"Empty block statement.","line":23,"column":30,"nodeType":"BlockStatement","messageId":"unexpected","endLine":23,"endColumn":32,"suggestions":[{"messageId":"suggestComment","data":{"type":"block"},"fix":{"range":[799,799],"text":" /* empty */ "},"desc":"Add comment inside empty block statement."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useCallback } from \"react\";\nimport { useLocation, useNavigate } from \"react-router-dom\";\nimport { usePortalReset } from \"@/contexts/PortalResetContext\";\n\ninterface UseTutorialExitOptions {\n  currentStepTitle?: string;\n  onExitComplete?: () => void;\n}\n\nexport function useTutorialExit({ currentStepTitle, onExitComplete }: UseTutorialExitOptions = {}) {\n  const [isExiting, setIsExiting] = useState(false);\n  const navigate = useNavigate();\n  const location = useLocation();\n  const { reset } = usePortalReset();\n\n  const handleExitNow = useCallback(() => {\n    if (isExiting) return;\n    setIsExiting(true);\n    console.debug(\"[useTutorialExit] Long-press confirmed, exiting tutorial\");\n    try {\n      onExitComplete?.();\n    } finally {\n      try { reset(); } catch {}\n      requestAnimationFrame(() => {\n        requestAnimationFrame(() => {\n          if (location.pathname !== \"/getting-started\") {\n            navigate(\"/getting-started\", { replace: true });\n          }\n          setTimeout(() => setIsExiting(false), 0);\n        });\n      });\n    }\n  }, [isExiting, onExitComplete, reset, location.pathname, navigate]);\n\n  useEffect(() => {\n    return () => setIsExiting(false);\n  }, []);\n\n  return {\n    currentStepTitle,\n    isExiting,\n    handleExitNow\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useTypedTranslation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useUserPreferences.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":157,"column":25,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":157,"endColumn":28,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5097,5100],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5097,5100],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { OnboardingStage } from \"@/constants/onboarding\";\n\nexport interface UserPreferences {\n  // User Settings\n  userId: string;\n  activeOrganizationId: string | null;\n  \n  // Onboarding Data\n  onboardingStage: OnboardingStage;\n  currentOnboardingStep: number;\n  welcomeModalShown: boolean;\n  \n  // Organization Settings\n  organizationId: string | null;\n  businessName: string;\n  logoUrl: string | null;\n  primaryBrandColor: string;\n  timezone: string;\n  dateFormat: string;\n  timeFormat: string;\n  \n  // User Profile\n  displayName: string | null;\n  avatarUrl: string | null;\n  \n  // Timestamps\n  lastUpdated: string;\n}\n\nconst PREFERENCES_CACHE_KEY = \"user-preferences\";\nconst CACHE_TTL = 12 * 60 * 60 * 1000; // 12 hours in ms\n\n// Fetch all user preferences in a single optimized query\nasync function fetchUserPreferences(userId: string): Promise<UserPreferences> {\n  console.log(\"🔄 fetchUserPreferences: Starting unified fetch for user\", userId);\n  \n  // Single query to get essential onboarding data (only columns we know exist)\n  const { data, error } = await supabase\n    .from('user_settings')\n    .select(`\n      user_id,\n      onboarding_stage,\n      current_onboarding_step,\n      welcome_modal_shown,\n      updated_at\n    `)\n    .eq('user_id', userId)\n    .maybeSingle();\n\n  if (error) {\n    console.error(\"🔄 fetchUserPreferences: Database error:\", error);\n    throw error;\n  }\n\n  // Create default preferences for new users\n  if (!data) {\n    console.log(\"🔄 fetchUserPreferences: No data found, creating defaults\");\n    \n    // Create minimal default user settings (only essential columns)\n    const { error: insertError } = await supabase\n      .from('user_settings')\n      .insert({\n        user_id: userId,\n        onboarding_stage: 'not_started',\n        current_onboarding_step: 1,\n        welcome_modal_shown: false\n      });\n\n    if (insertError) {\n      console.error(\"🔄 fetchUserPreferences: Error creating defaults:\", insertError);\n      throw insertError;\n    }\n\n    // Return default preferences\n    return {\n      userId,\n      activeOrganizationId: null,\n      onboardingStage: 'not_started' as OnboardingStage,\n      currentOnboardingStep: 1,\n      welcomeModalShown: false,\n      organizationId: null,\n      businessName: '',\n      logoUrl: null,\n      primaryBrandColor: '#1EB29F',\n      timezone: 'UTC',\n      dateFormat: 'DD/MM/YYYY',\n      timeFormat: '12-hour',\n      displayName: null,\n      avatarUrl: null,\n      lastUpdated: new Date().toISOString()\n    };\n  }\n\n  const preferences: UserPreferences = {\n    userId: data.user_id,\n    activeOrganizationId: null, // Will get from organization context\n    onboardingStage: (data.onboarding_stage as OnboardingStage) || 'not_started',\n    currentOnboardingStep: data.current_onboarding_step || 1,\n    welcomeModalShown: data.welcome_modal_shown || false,\n    organizationId: null, // Will get from organization context\n    businessName: '', // Will get from organization settings\n    logoUrl: null, // Will get from organization settings\n    primaryBrandColor: '#1EB29F', // Will get from organization settings\n    timezone: 'UTC', // Will get from organization settings\n    dateFormat: 'DD/MM/YYYY', // Will get from organization settings\n    timeFormat: '12-hour', // Default value\n    displayName: null, // Will get from profiles table\n    avatarUrl: null, // Will get from profiles table\n    lastUpdated: data.updated_at || new Date().toISOString()\n  };\n\n  console.log(\"🔄 fetchUserPreferences: Successfully fetched preferences\", {\n    onboardingStage: preferences.onboardingStage,\n    welcomeModalShown: preferences.welcomeModalShown,\n    currentStep: preferences.currentOnboardingStep\n  });\n\n  return preferences;\n}\n\nexport function useUserPreferences() {\n  const { user } = useAuth();\n  const queryClient = useQueryClient();\n\n  const query = useQuery({\n    queryKey: [PREFERENCES_CACHE_KEY, user?.id],\n    queryFn: () => fetchUserPreferences(user!.id),\n    enabled: !!user?.id,\n    staleTime: CACHE_TTL, // Consider data fresh for 12 hours\n    gcTime: CACHE_TTL * 2, // Keep in cache for 24 hours\n    refetchOnWindowFocus: false, // Don't refetch on window focus\n    refetchOnReconnect: true, // Do refetch on reconnect\n    retry: 3,\n    retryDelay: (attemptIndex) => Math.min(1000 * 2 ** attemptIndex, 30000)\n  });\n\n  // Update preferences function with optimistic updates\n  const updatePreferences = async (updates: Partial<UserPreferences>) => {\n    if (!user?.id) return;\n\n    console.log(\"🔄 updatePreferences: Updating with optimistic update\", updates);\n\n    // Optimistic update\n    queryClient.setQueryData(\n      [PREFERENCES_CACHE_KEY, user.id],\n      (old: UserPreferences | undefined) => {\n        if (!old) return old;\n        return { ...old, ...updates, lastUpdated: new Date().toISOString() };\n      }\n    );\n\n    try {\n      // Update database (only onboarding-related columns for now)\n      const updateData: any = {};\n      \n      if (updates.onboardingStage !== undefined) updateData.onboarding_stage = updates.onboardingStage;\n      if (updates.currentOnboardingStep !== undefined) updateData.current_onboarding_step = updates.currentOnboardingStep;\n      if (updates.welcomeModalShown !== undefined) updateData.welcome_modal_shown = updates.welcomeModalShown;\n      \n      // Only update if we have data to update\n      if (Object.keys(updateData).length === 0) {\n        console.log(\"🔄 updatePreferences: No onboarding data to update, skipping\");\n        return;\n      }\n\n      const { error } = await supabase\n        .from('user_settings')\n        .update(updateData)\n        .eq('user_id', user.id);\n\n      if (error) throw error;\n\n      console.log(\"🔄 updatePreferences: Database updated successfully\");\n      \n      // Invalidate and refetch to ensure consistency\n      queryClient.invalidateQueries({ queryKey: [PREFERENCES_CACHE_KEY, user.id] });\n      \n    } catch (error) {\n      console.error(\"🔄 updatePreferences: Error updating preferences:\", error);\n      \n      // Revert optimistic update on error\n      queryClient.invalidateQueries({ queryKey: [PREFERENCES_CACHE_KEY, user.id] });\n      throw error;\n    }\n  };\n\n  // Forced refresh function for login/logout/org switch\n  const forceRefresh = () => {\n    console.log(\"🔄 forceRefresh: Forcing preferences refresh\");\n    queryClient.invalidateQueries({ queryKey: [PREFERENCES_CACHE_KEY] });\n  };\n\n  // Clear cache function\n  const clearCache = () => {\n    console.log(\"🔄 clearCache: Clearing preferences cache\");\n    queryClient.removeQueries({ queryKey: [PREFERENCES_CACHE_KEY] });\n  };\n\n  return {\n    data: query.data,\n    isLoading: query.isLoading,\n    error: query.error,\n    updatePreferences,\n    forceRefresh,\n    clearCache,\n    // Convenience computed values\n    isReady: !query.isLoading && !!query.data,\n    cacheStatus: query.isStale ? 'stale' : 'fresh'\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useUserRole.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useUserSettings.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useWorkflowHealth.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchWorkflowHealth'. Either include it or remove the dependency array.","line":198,"column":6,"nodeType":"ArrayExpression","endLine":198,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchWorkflowHealth]","fix":{"range":[6277,6279],"text":"[fetchWorkflowHealth]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from 'react';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useToast } from '@/hooks/use-toast';\nimport { getUserOrganizationId } from '@/lib/organizationUtils';\n\ninterface WorkflowMetrics {\n  id: string;\n  organization_id: string;\n  date: string;\n  total_executions: number;\n  successful_executions: number;\n  failed_executions: number;\n  average_execution_time_ms: number;\n}\n\ninterface WorkflowHealth {\n  totalWorkflows: number;\n  activeWorkflows: number;\n  pausedWorkflows: number;\n  recentExecutions: number;\n  successRate: number;\n  averageExecutionTime: number;\n  failedExecutions: number;\n  stuckExecutions: number;\n  metrics: WorkflowMetrics[];\n}\n\nexport function useWorkflowHealth() {\n  const [health, setHealth] = useState<WorkflowHealth | null>(null);\n  const [loading, setLoading] = useState(true);\n  const { toast } = useToast();\n\n  const fetchWorkflowHealth = async () => {\n    try {\n      setLoading(true);\n      const organizationId = await getUserOrganizationId();\n      if (!organizationId) return;\n\n      // Get workflow counts\n      const { data: workflows, error: workflowsError } = await supabase\n        .from('workflows')\n        .select('id, is_active')\n        .eq('organization_id', organizationId);\n\n      if (workflowsError) throw workflowsError;\n\n      // Get execution metrics for the last 7 days\n      const sevenDaysAgo = new Date();\n      sevenDaysAgo.setDate(sevenDaysAgo.getDate() - 7);\n\n      const { data: metrics, error: metricsError } = await supabase\n        .from('workflow_execution_metrics')\n        .select('*')\n        .eq('organization_id', organizationId)\n        .gte('date', sevenDaysAgo.toISOString().split('T')[0])\n        .order('date', { ascending: false });\n\n      if (metricsError) throw metricsError;\n\n      // Get recent executions (last 24 hours)\n      const yesterday = new Date();\n      yesterday.setDate(yesterday.getDate() - 1);\n\n      const { data: recentExecutions, error: executionsError } = await supabase\n        .from('workflow_executions')\n        .select('id, status, started_at, completed_at')\n        .eq('workflows.organization_id', organizationId)\n        .gte('created_at', yesterday.toISOString());\n\n      if (executionsError) {\n        console.warn('Could not fetch recent executions:', executionsError);\n      }\n\n      // Check for stuck executions (running for more than 5 minutes)\n      const fiveMinutesAgo = new Date();\n      fiveMinutesAgo.setMinutes(fiveMinutesAgo.getMinutes() - 5);\n\n      const { data: stuckExecutions, error: stuckError } = await supabase\n        .from('workflow_executions')\n        .select('id')\n        .eq('status', 'running')\n        .lt('started_at', fiveMinutesAgo.toISOString());\n\n      if (stuckError) {\n        console.warn('Could not check for stuck executions:', stuckError);\n      }\n\n      // Calculate health metrics\n      const totalWorkflows = workflows?.length || 0;\n      const activeWorkflows = workflows?.filter(w => w.is_active).length || 0;\n      const pausedWorkflows = totalWorkflows - activeWorkflows;\n\n      const totalMetrics = metrics?.reduce((acc, m) => ({\n        total_executions: acc.total_executions + m.total_executions,\n        successful_executions: acc.successful_executions + m.successful_executions,\n        failed_executions: acc.failed_executions + m.failed_executions,\n        total_execution_time: acc.total_execution_time + (m.average_execution_time_ms * m.total_executions),\n      }), {\n        total_executions: 0,\n        successful_executions: 0,\n        failed_executions: 0,\n        total_execution_time: 0,\n      }) || {\n        total_executions: 0,\n        successful_executions: 0,\n        failed_executions: 0,\n        total_execution_time: 0,\n      };\n\n      const successRate = totalMetrics.total_executions > 0 \n        ? (totalMetrics.successful_executions / totalMetrics.total_executions) * 100 \n        : 100;\n\n      const averageExecutionTime = totalMetrics.total_executions > 0\n        ? totalMetrics.total_execution_time / totalMetrics.total_executions\n        : 0;\n\n      setHealth({\n        totalWorkflows,\n        activeWorkflows,\n        pausedWorkflows,\n        recentExecutions: recentExecutions?.length || 0,\n        successRate,\n        averageExecutionTime,\n        failedExecutions: totalMetrics.failed_executions,\n        stuckExecutions: stuckExecutions?.length || 0,\n        metrics: metrics || [],\n      });\n\n    } catch (error) {\n      console.error('Error fetching workflow health:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to load workflow health metrics',\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const cleanupStuckExecutions = async () => {\n    try {\n      const { data, error } = await supabase.rpc('cleanup_workflow_executions');\n      \n      if (error) throw error;\n\n      toast({\n        title: 'Success',\n        description: `Cleaned up ${data || 0} stuck executions`,\n      });\n\n      // Refresh health metrics\n      await fetchWorkflowHealth();\n    } catch (error) {\n      console.error('Error cleaning up executions:', error);\n      toast({\n        title: 'Error',\n        description: 'Failed to cleanup stuck executions',\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const getHealthStatus = (): 'healthy' | 'warning' | 'critical' => {\n    if (!health) return 'warning';\n    \n    if (health.stuckExecutions > 0) return 'critical';\n    if (health.successRate < 80) return 'critical';\n    if (health.successRate < 95) return 'warning';\n    if (health.activeWorkflows === 0 && health.totalWorkflows > 0) return 'warning';\n    \n    return 'healthy';\n  };\n\n  const getHealthColor = () => {\n    const status = getHealthStatus();\n    switch (status) {\n      case 'healthy': return 'text-green-600';\n      case 'warning': return 'text-yellow-600';\n      case 'critical': return 'text-red-600';\n      default: return 'text-gray-600';\n    }\n  };\n\n  const getHealthIcon = () => {\n    const status = getHealthStatus();\n    switch (status) {\n      case 'healthy': return '✅';\n      case 'warning': return '⚠️';\n      case 'critical': return '🚨';\n      default: return '❓';\n    }\n  };\n\n  useEffect(() => {\n    fetchWorkflowHealth();\n  }, []);\n\n  return {\n    health,\n    loading,\n    fetchWorkflowHealth,\n    cleanupStuckExecutions,\n    getHealthStatus,\n    getHealthColor,\n    getHealthIcon,\n    refetch: fetchWorkflowHealth,\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useWorkflowTriggers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useWorkflows.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/hooks/useWorkingHours.ts","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchWorkingHours'. Either include it or remove the dependency array.","line":85,"column":6,"nodeType":"ArrayExpression","endLine":85,"endColumn":8,"suggestions":[{"desc":"Update the dependencies array to be: [fetchWorkingHours]","fix":{"range":[2151,2153],"text":"[fetchWorkingHours]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { supabase } from \"@/integrations/supabase/client\";\nimport { useToast } from \"@/hooks/use-toast\";\n\ninterface WorkingHour {\n  id?: string;\n  day_of_week: number;\n  enabled: boolean;\n  start_time: string | null;\n  end_time: string | null;\n}\n\nexport function useWorkingHours() {\n  const [workingHours, setWorkingHours] = useState<WorkingHour[]>([]);\n  const [loading, setLoading] = useState(true);\n  const { toast } = useToast();\n\n  const fetchWorkingHours = async () => {\n    try {\n      setLoading(true);\n      const { data: { user } } = await supabase.auth.getUser();\n      \n      if (!user) {\n        setLoading(false);\n        return;\n      }\n\n      const { data, error } = await supabase\n        .from('working_hours')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('day_of_week');\n\n      if (error) throw error;\n\n      setWorkingHours(data || []);\n    } catch (error) {\n      console.error('Error fetching working hours:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to load working hours\",\n        variant: \"destructive\",\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const updateWorkingHour = async (dayOfWeek: number, updates: Partial<WorkingHour>) => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser();\n      \n      if (!user) throw new Error(\"No user found\");\n\n      const { data, error } = await supabase\n        .from('working_hours')\n        .update(updates)\n        .eq('user_id', user.id)\n        .eq('day_of_week', dayOfWeek)\n        .select()\n        .single();\n\n      if (error) throw error;\n\n      setWorkingHours(prev => \n        prev.map(wh => \n          wh.day_of_week === dayOfWeek ? { ...wh, ...updates } : wh\n        )\n      );\n\n      return { success: true };\n    } catch (error) {\n      console.error('Error updating working hour:', error);\n      toast({\n        title: \"Error\",\n        description: \"Failed to update working hours\",\n        variant: \"destructive\",\n      });\n      return { success: false, error };\n    }\n  };\n\n  useEffect(() => {\n    fetchWorkingHours();\n  }, []);\n\n  return {\n    workingHours,\n    loading,\n    updateWorkingHour,\n    refetch: fetchWorkingHours\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/i18n/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/i18n/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/integrations/supabase/__tests__/client.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/integrations/supabase/client.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/integrations/supabase/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/AllProjectsLegacy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/ProjectDetailLegacy.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/common/EntityDetailLayout.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/common/EntityFilters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/common/EntityForm.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/common/EntityListView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/common/FormField.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/common/LoadingStates.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/optimized/AccessibleGlobalSearch.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/optimized/MemoizedKanbanCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/optimized/OptimizedProjectsPage.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/optimized/VirtualizedList.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":150,"column":17,"nodeType":"Identifier","messageId":"namedExport","endLine":150,"endColumn":35}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';\nimport { performanceMonitor } from '@/utils/performance';\n\ninterface VirtualizedListProps<T> {\n  items: T[];\n  renderItem: (item: T, index: number) => React.ReactNode;\n  itemHeight: number;\n  containerHeight: number;\n  overscan?: number;\n  className?: string;\n  'aria-label'?: string;\n}\n\n/**\n * High-performance virtualized list component\n * Only renders items that are currently visible\n */\nexport function VirtualizedList<T>({\n  items,\n  renderItem,\n  itemHeight,\n  containerHeight,\n  overscan = 5,\n  className = '',\n  'aria-label': ariaLabel = 'Virtual list'\n}: VirtualizedListProps<T>) {\n  const [scrollTop, setScrollTop] = useState(0);\n  const scrollElementRef = useRef<HTMLDivElement>(null);\n\n  // Calculate visible range with memoization\n  const { startIndex, endIndex, visibleItems } = useMemo(() => {\n    performanceMonitor.startTiming('VirtualizedList.calculateRange');\n    \n    const start = Math.max(0, Math.floor(scrollTop / itemHeight) - overscan);\n    const end = Math.min(\n      items.length - 1,\n      Math.ceil((scrollTop + containerHeight) / itemHeight) + overscan\n    );\n    \n    const visible = items.slice(start, end + 1);\n    \n    performanceMonitor.endTiming('VirtualizedList.calculateRange');\n    \n    return {\n      startIndex: start,\n      endIndex: end,\n      visibleItems: visible\n    };\n  }, [scrollTop, itemHeight, containerHeight, overscan, items]);\n\n  // Optimized scroll handler with requestAnimationFrame\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\n    const target = e.currentTarget;\n    requestAnimationFrame(() => {\n      setScrollTop(target.scrollTop);\n    });\n  }, []);\n\n  // Keyboard navigation support\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n    if (!scrollElementRef.current) return;\n\n    const container = scrollElementRef.current;\n    let newScrollTop = scrollTop;\n\n    switch (e.key) {\n      case 'ArrowDown':\n        e.preventDefault();\n        newScrollTop = Math.min(\n          (items.length - 1) * itemHeight,\n          scrollTop + itemHeight\n        );\n        break;\n      case 'ArrowUp':\n        e.preventDefault();\n        newScrollTop = Math.max(0, scrollTop - itemHeight);\n        break;\n      case 'PageDown':\n        e.preventDefault();\n        newScrollTop = Math.min(\n          (items.length - 1) * itemHeight,\n          scrollTop + containerHeight\n        );\n        break;\n      case 'PageUp':\n        e.preventDefault();\n        newScrollTop = Math.max(0, scrollTop - containerHeight);\n        break;\n      case 'Home':\n        if (e.ctrlKey) {\n          e.preventDefault();\n          newScrollTop = 0;\n        }\n        break;\n      case 'End':\n        if (e.ctrlKey) {\n          e.preventDefault();\n          newScrollTop = (items.length - 1) * itemHeight;\n        }\n        break;\n    }\n\n    if (newScrollTop !== scrollTop) {\n      container.scrollTop = newScrollTop;\n    }\n  }, [scrollTop, itemHeight, containerHeight, items.length]);\n\n  // Total height for scrollbar\n  const totalHeight = items.length * itemHeight;\n\n  return (\n    <div\n      ref={scrollElementRef}\n      className={`overflow-auto ${className}`}\n      style={{ height: containerHeight }}\n      onScroll={handleScroll}\n      onKeyDown={handleKeyDown}\n      tabIndex={0}\n      role=\"list\"\n      aria-label={ariaLabel}\n      aria-rowcount={items.length}\n    >\n      <div style={{ height: totalHeight, position: 'relative' }}>\n        <div\n          style={{\n            transform: `translateY(${startIndex * itemHeight}px)`,\n            position: 'absolute',\n            width: '100%'\n          }}\n        >\n          {visibleItems.map((item, index) => (\n            <div\n              key={startIndex + index}\n              style={{ height: itemHeight }}\n              role=\"listitem\"\n              aria-rowindex={startIndex + index + 1}\n            >\n              {renderItem(item, startIndex + index)}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n\n/**\n * Hook for managing virtualized list state\n */\nexport function useVirtualizedList<T>(\n  items: T[],\n  itemHeight: number,\n  containerHeight: number\n) {\n  const [scrollTop, setScrollTop] = useState(0);\n\n  const scrollToIndex = useCallback((index: number) => {\n    const targetScrollTop = Math.max(0, Math.min(\n      index * itemHeight,\n      (items.length - 1) * itemHeight\n    ));\n    setScrollTop(targetScrollTop);\n  }, [itemHeight, items.length]);\n\n  const scrollToTop = useCallback(() => {\n    setScrollTop(0);\n  }, []);\n\n  const scrollToBottom = useCallback(() => {\n    setScrollTop((items.length - 1) * itemHeight);\n  }, [items.length, itemHeight]);\n\n  return {\n    scrollTop,\n    scrollToIndex,\n    scrollToTop,\n    scrollToBottom\n  };\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/template-builder/ImageManager.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadAssets'. Either include it or remove the dependency array.","line":76,"column":6,"nodeType":"ArrayExpression","endLine":76,"endColumn":30,"suggestions":[{"desc":"Update the dependencies array to be: [activeOrganization.id, loadAssets]","fix":{"range":[2330,2354],"text":"[activeOrganization.id, loadAssets]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { useState, useEffect } from 'react';\nimport { Image as ImageIcon, Trash2, Edit3, Copy } from 'lucide-react';\nimport { Button } from '@/components/ui/button';\nimport { Input } from '@/components/ui/input';\nimport { useToast } from '@/hooks/use-toast';\nimport { supabase } from '@/integrations/supabase/client';\nimport { useOrganization } from '@/contexts/OrganizationContext';\nimport { useMessagesTranslation } from '@/hooks/useTypedTranslation';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n  AlertDialogTrigger,\n} from '@/components/ui/alert-dialog';\nimport { useTranslation } from 'react-i18next';\n\ninterface TemplateAsset {\n  id: string;\n  file_name: string;\n  file_path: string;\n  content_type: string;\n  file_size: number;\n  alt_text: string | null;\n  created_at: string;\n}\n\ninterface ImageManagerProps {\n  onImageSelect: (imageUrl: string, altText?: string) => void;\n  templateId?: string;\n  className?: string;\n}\n\nexport function ImageManager({ onImageSelect, templateId, className }: ImageManagerProps) {\n  const [assets, setAssets] = useState<TemplateAsset[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [editingAlt, setEditingAlt] = useState<string | null>(null);\n  const [altText, setAltText] = useState('');\n  const { toast } = useToast();\n  const { t: tMessages } = useMessagesTranslation();\n  const { activeOrganization } = useOrganization();\n  const { t } = useTranslation(\"pages\");\n  const { t: tCommon } = useTranslation(\"common\");\n\n  const loadAssets = async () => {\n    if (!activeOrganization?.id) return;\n\n    try {\n      setLoading(true);\n      const { data, error } = await supabase\n        .from('template_assets')\n        .select('*')\n        .eq('organization_id', activeOrganization.id)\n        .order('created_at', { ascending: false });\n\n      if (error) throw error;\n      setAssets(data || []);\n    } catch (error) {\n      console.error('Error loading assets:', error);\n      toast({\n        title: tCommon('toast.error'),\n        description: t('templateBuilder.imageManager.messages.loadError'),\n        variant: 'destructive',\n      });\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    loadAssets();\n  }, [activeOrganization?.id]);\n\n  const deleteAsset = async (asset: TemplateAsset) => {\n    try {\n      // Delete from storage\n      const { error: storageError } = await supabase.storage\n        .from('template-images')\n        .remove([asset.file_path]);\n\n      if (storageError) throw storageError;\n\n      // Delete from database\n      const { error: dbError } = await supabase\n        .from('template_assets')\n        .delete()\n        .eq('id', asset.id);\n\n      if (dbError) throw dbError;\n\n      setAssets(prev => prev.filter(a => a.id !== asset.id));\n      \n      toast({\n        title: tCommon('toast.success'),\n        description: t('templateBuilder.imageManager.messages.deleteSuccess'),\n      });\n    } catch (error) {\n      console.error('Error deleting asset:', error);\n      toast({\n        title: tCommon('toast.error'),\n        description: t('templateBuilder.imageManager.messages.deleteError'),\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const updateAltText = async (assetId: string, newAltText: string) => {\n    try {\n      const { error } = await supabase\n        .from('template_assets')\n        .update({ alt_text: newAltText })\n        .eq('id', assetId);\n\n      if (error) throw error;\n\n      setAssets(prev => prev.map(asset => \n        asset.id === assetId ? { ...asset, alt_text: newAltText } : asset\n      ));\n\n      toast({\n        title: tCommon('toast.success'),\n        description: t('templateBuilder.imageManager.messages.altSuccess'),\n      });\n    } catch (error) {\n      console.error('Error updating alt text:', error);\n      toast({\n        title: tCommon('toast.error'),\n        description: t('templateBuilder.imageManager.messages.altError'),\n        variant: 'destructive',\n      });\n    }\n  };\n\n  const getImageUrl = (filePath: string) => {\n    const { data: { publicUrl } } = supabase.storage\n      .from('template-images')\n      .getPublicUrl(filePath);\n    return publicUrl;\n  };\n\n  const copyImageUrl = (filePath: string) => {\n    const url = getImageUrl(filePath);\n    navigator.clipboard.writeText(url);\n    toast({\n      title: tCommon('toast.success'),\n      description: t('templateBuilder.imageManager.messages.copySuccess'),\n    });\n  };\n\n  const formatFileSize = (bytes: number) => {\n    if (bytes === 0) return '0 Bytes';\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  };\n\n  if (loading) {\n    return (\n      <div className={`space-y-4 ${className}`}>\n        <div className=\"flex items-center gap-2\">\n          <ImageIcon className=\"w-5 h-5\" />\n          <h3 className=\"font-medium\">{t('templateBuilder.imageManager.loading')}</h3>\n        </div>\n        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n          {[...Array(6)].map((_, i) => (\n            <div key={i} className=\"aspect-square bg-muted animate-pulse rounded-lg\" />\n          ))}\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`space-y-4 ${className}`}>\n      <div className=\"flex items-center gap-2\">\n        <ImageIcon className=\"w-5 h-5\" />\n        <h3 className=\"font-medium\">{t('templateBuilder.imageManager.titleWithCount', { count: assets.length })}</h3>\n      </div>\n\n      {assets.length === 0 ? (\n        <div className=\"text-center py-8 text-muted-foreground\">\n          <ImageIcon className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n          <p>{t('templateBuilder.imageManager.empty.title')}</p>\n          <p className=\"text-sm\">{t('templateBuilder.imageManager.empty.description')}</p>\n        </div>\n      ) : (\n        <div className=\"grid grid-cols-2 md:grid-cols-3 gap-4\">\n          {assets.map((asset) => (\n            <div key={asset.id} className=\"group relative bg-card border rounded-lg overflow-hidden\">\n              <div className=\"aspect-square relative\">\n                <img\n                  src={getImageUrl(asset.file_path)}\n                  alt={asset.alt_text || asset.file_name}\n                  className=\"w-full h-full object-cover cursor-pointer hover:scale-105 transition-transform\"\n                  onClick={() => onImageSelect(getImageUrl(asset.file_path), asset.alt_text || undefined)}\n                />\n                \n                {/* Overlay with actions */}\n                <div className=\"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center gap-2\">\n                  <Button\n                    size=\"sm\"\n                    variant=\"secondary\"\n                    onClick={() => onImageSelect(getImageUrl(asset.file_path), asset.alt_text || undefined)}\n                  >\n                    {t('templateBuilder.imageManager.actions.insert')}\n                  </Button>\n                  <Button\n                    size=\"sm\"\n                    variant=\"outline\"\n                    onClick={() => copyImageUrl(asset.file_path)}\n                  >\n                    <Copy className=\"w-4 h-4\" />\n                  </Button>\n                  <AlertDialog>\n                    <AlertDialogTrigger asChild>\n                      <Button size=\"sm\" variant=\"destructive\">\n                        <Trash2 className=\"w-4 h-4\" />\n                      </Button>\n                    </AlertDialogTrigger>\n                    <AlertDialogContent>\n                      <AlertDialogHeader>\n                        <AlertDialogTitle>{t('templateBuilder.imageManager.actions.deleteTitle')}</AlertDialogTitle>\n                        <AlertDialogDescription>\n                          {tMessages('confirm.deleteImage')} {tMessages('confirm.cannotUndo')}\n                        </AlertDialogDescription>\n                      </AlertDialogHeader>\n                      <AlertDialogFooter>\n                        <AlertDialogCancel>{tCommon('buttons.cancel')}</AlertDialogCancel>\n                        <AlertDialogAction onClick={() => deleteAsset(asset)}>\n                          {tCommon('buttons.delete')}\n                        </AlertDialogAction>\n                      </AlertDialogFooter>\n                    </AlertDialogContent>\n                  </AlertDialog>\n                </div>\n              </div>\n\n              {/* Image info */}\n              <div className=\"p-3 space-y-2\">\n                <div className=\"flex items-center justify-between\">\n                  <p className=\"text-sm font-medium truncate\">{asset.file_name}</p>\n                  <Button\n                    size=\"sm\"\n                    variant=\"ghost\"\n                    onClick={() => {\n                      setEditingAlt(asset.id);\n                      setAltText(asset.alt_text || '');\n                    }}\n                  >\n                    <Edit3 className=\"w-3 h-3\" />\n                  </Button>\n                </div>\n                \n                {editingAlt === asset.id ? (\n                  <div className=\"flex gap-1\">\n                    <Input\n                      value={altText}\n                      onChange={(e) => setAltText(e.target.value)}\n                      placeholder={t('templateBuilder.imageManager.actions.altPlaceholder')}\n                      className=\"text-xs h-7\"\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') {\n                          updateAltText(asset.id, altText);\n                          setEditingAlt(null);\n                        }\n                        if (e.key === 'Escape') {\n                          setEditingAlt(null);\n                        }\n                      }}\n                      autoFocus\n                    />\n                    <Button\n                      size=\"sm\"\n                      onClick={() => {\n                        updateAltText(asset.id, altText);\n                        setEditingAlt(null);\n                      }}\n                      className=\"h-7 px-2\"\n                    >\n                      {tCommon('buttons.save')}\n                    </Button>\n                  </div>\n                ) : (\n                  <p className=\"text-xs text-muted-foreground truncate\">\n                    {asset.alt_text || t('templateBuilder.imageManager.messages.noAltText')}\n                  </p>\n                )}\n                \n                <p className=\"text-xs text-muted-foreground\">\n                  {formatFileSize(asset.file_size)}\n                </p>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/template-builder/TemplateEditor.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/components/template-builder/TemplateEditorWithTest.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/pages/AllLeadsRefactored.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/pages/AllProjectsRefactored.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":95,"column":39,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":95,"endColumn":42,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[3743,3746],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[3743,3746],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect, useMemo, useCallback } from \"react\";\nimport { useNavigate, useSearchParams } from \"react-router-dom\";\nimport { Button } from \"@/components/ui/button\";\nimport { LayoutGrid, List, Archive, Settings, Plus } from \"lucide-react\";\nimport { EntityListView } from \"@/legacy/components/common/EntityListView\";\nimport { ErrorBoundary } from \"@/components/common/ErrorBoundary\";\nimport { TableLoadingState } from \"@/legacy/components/common/LoadingStates\";\nimport { ProjectService, ProjectWithDetails } from \"@/services/ProjectService\";\nimport { useEntityData } from \"@/hooks/useEntityData\";\nimport { ViewProjectDialog } from \"@/components/ViewProjectDialog\";\nimport { ProjectSheetView } from \"@/components/ProjectSheetView\";\nimport ProjectKanbanBoard from \"@/components/ProjectKanbanBoard\";\nimport { ProjectStatusBadge } from \"@/components/ProjectStatusBadge\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\nimport { KanbanSettingsSheet } from \"@/components/KanbanSettingsSheet\";\nimport { PROJECT_STATUS } from \"@/constants/entityConstants\";\nimport { formatDate } from \"@/lib/utils\";\nimport { useTranslation } from \"react-i18next\";\nimport { ProjectCreationWizardSheet } from \"@/features/project-creation\";\n\ntype ViewMode = 'board' | 'list' | 'archived';\n\nconst AllProjectsRefactored = () => {\n  const [viewMode, setViewMode] = useState<ViewMode>('board');\n  const [viewingProject, setViewingProject] = useState<ProjectWithDetails | null>(null);\n  const [showViewDialog, setShowViewDialog] = useState(false);\n  const [quickViewProject, setQuickViewProject] = useState<ProjectWithDetails | null>(null);\n  const [showQuickView, setShowQuickView] = useState(false);\n  const [isProjectWizardOpen, setProjectWizardOpen] = useState(false);\n  const navigate = useNavigate();\n  const [searchParams, setSearchParams] = useSearchParams();\n  const isMobile = useIsMobile();\n  const { t } = useTranslation([\"pages\", \"navigation\"]);\n\n  // Tutorial state\n  const [showTutorial, setShowTutorial] = useState(false);\n  const [currentTutorialStep, setCurrentTutorialStep] = useState(0);\n  \n  // Services\n  const projectService = useMemo(() => new ProjectService(), []);\n  const fetchProjects = useCallback(() => projectService.fetchProjectsWithDetails(), [projectService]);\n\n  // Data hooks\n  const { \n    data: allProjects, \n    loading, \n    refetch: refetchProjects \n  } = useEntityData<ProjectWithDetails>({\n    fetchFn: fetchProjects\n  });\n\n  // Separate projects and archived projects\n  const { projects, archivedProjects } = useMemo(() => {\n    const archived = allProjects.filter(p => \n      p.project_status?.name.toLowerCase() === PROJECT_STATUS.ARCHIVED\n    );\n    const active = allProjects.filter(p => \n      p.project_status?.name.toLowerCase() !== PROJECT_STATUS.ARCHIVED\n    );\n    \n    return {\n      projects: active,\n      archivedProjects: archived\n    };\n  }, [allProjects]);\n\n  const displayProjects = viewMode === 'archived' ? archivedProjects : projects;\n\n  useEffect(() => {\n    const tutorial = searchParams.get('tutorial');\n    if (tutorial?.includes('true')) {\n      setShowTutorial(true);\n      const url = new URL(window.location.href);\n      url.searchParams.delete('tutorial');\n      window.history.replaceState({}, '', url.toString());\n    }\n  }, [searchParams]);\n\n  const handleProjectClick = (project: ProjectWithDetails) => {\n    navigate(`/projects/${project.id}`);\n  };\n\n  const handleQuickView = (project: ProjectWithDetails) => {\n    setQuickViewProject(project);\n    setShowQuickView(true);\n  };\n\n  const handleViewFullDetails = () => {\n    if (quickViewProject) {\n      navigate(`/projects/${quickViewProject.id}`);\n      setShowQuickView(false);\n    }\n  };\n\n  const handleSearchResult = (result: any) => {\n    if (result.type === 'project') {\n      navigate(`/projects/${result.id}`);\n    } else if (result.type === 'lead') {\n      navigate(`/leads/${result.id}`);\n    }\n  };\n\n  const handleViewChange = (view: ViewMode) => {\n    setViewMode(view);\n  };\n\n  const handleProjectUpdate = (updatedProject: ProjectWithDetails) => {\n    refetchProjects();\n  };\n\n  // Create columns for list view\n  const projectColumns = [\n    {\n      key: 'name',\n      header: 'Project Name',\n      sortable: true,\n      render: (project: ProjectWithDetails) => (\n        <div className=\"font-medium\">{project.name}</div>\n      )\n    },\n    {\n      key: 'lead_name',\n      header: 'Client',\n      sortable: true,\n      render: (project: ProjectWithDetails) => (\n        <div>{project.lead?.name || '-'}</div>\n      )\n    },\n    {\n      key: 'project_type',\n      header: 'Type',\n      sortable: true,\n      render: (project: ProjectWithDetails) => (\n        <div>{project.project_type?.name || '-'}</div>\n      )\n    },\n    {\n      key: 'status',\n      header: 'Status',\n      sortable: true,\n      render: (project: ProjectWithDetails) => (\n        <ProjectStatusBadge \n          projectId={project.id}\n          currentStatusId={project.status_id}\n          onStatusChange={() => refetchProjects()}\n          editable={false}\n          className=\"text-sm\"\n        />\n      )\n    },\n    {\n      key: 'sessions',\n      header: 'Sessions',\n      render: (project: ProjectWithDetails) => (\n        <div className=\"text-sm\">\n          {project.session_count || 0} sessions\n        </div>\n      )\n    },\n    {\n      key: 'created_at',\n      header: 'Created',\n      sortable: true,\n      render: (project: ProjectWithDetails) => (\n        <div className=\"text-sm text-muted-foreground\">\n          {formatDate(project.created_at)}\n        </div>\n      )\n    }\n  ];\n\n  const viewModeButtons = (\n    <div className=\"flex items-center gap-1\">\n      <Button\n        variant={viewMode === 'board' ? 'default' : 'outline'}\n        size=\"sm\"\n        onClick={() => handleViewChange('board')}\n        className=\"flex items-center gap-2\"\n      >\n        <LayoutGrid className=\"h-4 w-4\" />\n        {t(\"projects.board_view\")}\n      </Button>\n      <Button\n        variant={viewMode === 'list' ? 'default' : 'outline'}\n        size=\"sm\"\n        onClick={() => handleViewChange('list')}\n        className=\"flex items-center gap-2\"\n      >\n        <List className=\"h-4 w-4\" />\n        {t(\"projects.list_view\")}\n      </Button>\n      <Button\n        variant={viewMode === 'archived' ? 'default' : 'outline'}\n        size=\"sm\"\n        onClick={() => handleViewChange('archived')}\n        className=\"flex items-center gap-2\"\n      >\n        <Archive className=\"h-4 w-4\" />\n        {t(\"projects.archived_view\")} ({archivedProjects.length})\n      </Button>\n      <Button\n        variant=\"default\"\n        size=\"sm\"\n        onClick={() => setProjectWizardOpen(true)}\n        className=\"flex items-center gap-2\"\n      >\n        <Plus className=\"h-4 w-4\" />\n        {t(\"common:buttons.add_project\")}\n      </Button>\n      <KanbanSettingsSheet>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          className=\"flex items-center gap-2\"\n        >\n          <Settings className=\"h-4 w-4\" />\n          <span className=\"hidden sm:inline\">{t(\"navigation:settings\")}</span>\n        </Button>\n      </KanbanSettingsSheet>\n    </div>\n  );\n\n  if (loading) {\n    return <TableLoadingState />;\n  }\n\n  // Board/Kanban view\n  if (viewMode === 'board') {\n    return (\n      <>\n        <ProjectCreationWizardSheet\n          isOpen={isProjectWizardOpen}\n          onOpenChange={setProjectWizardOpen}\n          entrySource=\"legacy_board\"\n          onProjectCreated={refetchProjects}\n        />\n        <ErrorBoundary>\n        <div className=\"min-h-screen p-4 sm:p-6\">\n          <div className=\"mb-6 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4\">\n            <div>\n              <h1 className=\"text-2xl font-bold\">{t(\"projects.title\")}</h1>\n              <p className=\"text-muted-foreground\">{t(\"projects.page_subtitle\")}</p>\n            </div>\n            {viewModeButtons}\n          </div>\n          \n        <ProjectKanbanBoard\n          projects={projects}\n          onProjectsChange={refetchProjects}\n          onProjectUpdate={handleProjectUpdate}\n          onQuickView={handleQuickView}\n        />\n        </div>\n\n        <ViewProjectDialog \n          project={viewingProject}\n          open={showViewDialog}\n          onOpenChange={setShowViewDialog}\n          onProjectUpdated={refetchProjects}\n          leadName={viewingProject?.lead?.name || \"\"}\n        />\n        <ProjectSheetView \n          project={quickViewProject}\n          open={showQuickView}\n          onOpenChange={setShowQuickView}\n          onProjectUpdated={refetchProjects}\n          leadName={quickViewProject?.lead?.name || \"\"}\n          onViewFullDetails={handleViewFullDetails}\n        />\n        </ErrorBoundary>\n      </>\n    );\n  }\n\n  // List view\n  return (\n    <>\n      <ProjectCreationWizardSheet\n        isOpen={isProjectWizardOpen}\n        onOpenChange={setProjectWizardOpen}\n        entrySource=\"legacy_list\"\n        onProjectCreated={refetchProjects}\n      />\n      <ErrorBoundary>\n      <EntityListView\n        title=\"Projects\"\n        subtitle={viewMode === 'archived' ? \"Archived projects\" : \"Manage your photography projects\"}\n        data={displayProjects}\n        columns={projectColumns}\n        loading={loading}\n        onRowClick={handleProjectClick}\n        onAddClick={() => setProjectWizardOpen(true)}\n        addButtonText={t(\"common:buttons.add_project\")}\n        headerActions={viewModeButtons}\n        itemsPerPage={20}\n      />\n\n      <ViewProjectDialog \n        project={viewingProject}\n        open={showViewDialog}\n        onOpenChange={setShowViewDialog}\n        onProjectUpdated={refetchProjects}\n        leadName={viewingProject?.lead?.name || \"\"}\n      />\n      <ProjectSheetView \n        project={quickViewProject}\n        open={showQuickView}\n        onOpenChange={setShowQuickView}\n        onProjectUpdated={refetchProjects}\n        leadName={quickViewProject?.lead?.name || \"\"}\n        onViewFullDetails={handleViewFullDetails}\n      />\n      </ErrorBoundary>\n    </>\n  );\n};\n\nexport default AllProjectsRefactored;\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/pages/AllProjectsSimplified.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/pages/LeadFormExample.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/pages/ProjectDetailRefactored.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/pages/Settings.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/legacy/utils/validationUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/__tests__/organizationSettingsCache.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/accounting/__tests__/vat.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/accounting/vat.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/auditLog.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/dateFormatUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/dateFormatUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/dateUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/dateUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/debug.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/featureFlags.ts","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'no-eval').","line":11,"column":5,"severity":1,"nodeType":null,"fix":{"range":[363,398],"text":" "}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"const FEATURE_FLAG_PREFIX = \"VITE_FEATURE_\";\n\nconst toEnvKey = (flag: string) => {\n  const normalized = flag.replace(/[^a-z0-9]/gi, \"_\").toUpperCase();\n  return `${FEATURE_FLAG_PREFIX}${normalized}`;\n};\n\nconst resolveEnv = (): Record<string, string | undefined> => {\n  // Accessing import.meta breaks under Jest (CommonJS). Eval keeps bundlers happy.\n  try {\n    // eslint-disable-next-line no-eval\n    const meta = (0, eval)(\"import.meta\");\n    if (meta && typeof meta === \"object\" && \"env\" in meta) {\n      return (meta as Record<string, unknown>).env as Record<string, string | undefined>;\n    }\n  } catch {\n    // ignore, fall back to process.env below\n  }\n\n  if (typeof process !== \"undefined\" && process.env) {\n    return process.env as Record<string, string | undefined>;\n  }\n\n  return {};\n};\n\nexport const isFeatureEnabled = (flag: string, defaultValue = false): boolean => {\n  const key = toEnvKey(flag);\n  const env = resolveEnv();\n  const raw = env[key];\n\n  if (raw === \"true\") return true;\n  if (raw === \"false\") return false;\n\n  if (typeof window !== \"undefined\") {\n    try {\n      const override = window.localStorage.getItem(`flag:${flag}`);\n      if (override === \"true\") return true;\n      if (override === \"false\") return false;\n    } catch (error) {\n      console.warn(\"Feature flag localStorage lookup failed\", error);\n    }\n  }\n\n  return defaultValue;\n};\n\nexport const FEATURE_FLAGS = {\n  sessionWizardV1: \"session_wizard_v1\",\n} as const;\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/inputUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/inputUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/leadFieldValidation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/leadFieldValidation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/leadStatusColors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/organizationSettingsCache.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/organizationUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/organizationUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/paymentColors.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/paymentColors.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/payments/depositUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/projects/buildProjectSummaryItems.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/projects/buildProjectSummaryItems.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/projects/sortOrder.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/services/units.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/sessionSorting.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/sessionSorting.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/sessionUtils.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":37,"column":49,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":37,"endColumn":52,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1054,1057],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1054,1057],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { getDisplaySessionName, generateSessionName } from \"./sessionUtils\";\n\ndescribe(\"sessionUtils\", () => {\n  describe(\"getDisplaySessionName\", () => {\n    it(\"returns trimmed session name when provided\", () => {\n      expect(\n        getDisplaySessionName({\n          session_name: \"  Sunset Shoot \",\n        })\n      ).toBe(\"Sunset Shoot\");\n    });\n\n    it(\"falls back to project type when session name missing\", () => {\n      expect(\n        getDisplaySessionName({\n          projects: {\n            project_types: {\n              name: \"Engagement\",\n            },\n          },\n        })\n      ).toBe(\"Engagement Session\");\n    });\n\n    it(\"uses lead name when project type unavailable\", () => {\n      expect(\n        getDisplaySessionName({\n          leads: {\n            name: \"Taylor Swift\",\n          },\n        })\n      ).toBe(\"Taylor Swift Session\");\n    });\n\n    it(\"returns generic fallback when no contextual data present\", () => {\n      expect(getDisplaySessionName({})).toBe(\"Session\");\n      expect(getDisplaySessionName(undefined as any)).toBe(\"Session\");\n    });\n  });\n\n  describe(\"generateSessionName\", () => {\n    it(\"returns default label when project name is empty or whitespace\", () => {\n      expect(generateSessionName(\"\")).toBe(\"New Session\");\n      expect(generateSessionName(\"   \")).toBe(\"New Session\");\n    });\n\n    it(\"returns trimmed project name with Session suffix\", () => {\n      expect(generateSessionName(\"  Family Portraits \")).toBe(\n        \"Family Portraits Session\"\n      );\n    });\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/sessionUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/sessions/buildSessionSummaryItems.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/sessions/buildSessionSummaryItems.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/settingsHelpContent.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/statusBadgeStyles.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/telemetry.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/templateBlockUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/templatePlaceholders.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/templateUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/templateUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/toastHelpers.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/utils.test.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":34,"column":27,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":34,"endColumn":30,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[726,729],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[726,729],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/validation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/lib/validation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/AllLeads.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/AllProjects.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Analytics.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Auth.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Calendar.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/GettingStarted.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":61,"column":35,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":61,"endColumn":38,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2144,2147],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2144,2147],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useState, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";  \nimport { HelpCircle, ArrowRight, CheckCircle, Clock } from \"lucide-react\";\nimport { SampleDataModal } from \"@/components/SampleDataModal\";\nimport { RestartGuidedModeButton } from \"@/components/RestartGuidedModeButton\";\nimport { ExitGuidanceModeButton } from \"@/components/ExitGuidanceModeButton\";\nimport { GuidedStepProgress } from \"@/components/GuidedStepProgress\";\nimport { useAuth } from \"@/contexts/AuthContext\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useOnboarding } from \"@/contexts/OnboardingContext\";\nimport { useTranslation } from \"react-i18next\";\n\n// Remove duplicate step definitions - now using centralized ones from hook\n\nconst GettingStarted = () => {\n  const { t } = useTranslation('pages');\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const [showSampleDataModal, setShowSampleDataModal] = useState(false);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const { \n    loading, \n    isInGuidedSetup, \n    isOnboardingComplete,\n    currentStepInfo,\n    nextStepInfo,\n    completedSteps,\n    isAllStepsComplete,\n    totalSteps,\n    currentStep,\n    completeOnboarding\n  } = useOnboarding();\n\n  // If guided setup is complete, redirect to dashboard\n  useEffect(() => {\n    if (!loading && (!isInGuidedSetup || isOnboardingComplete)) {\n      navigate('/', { replace: true });\n    }\n  }, [loading, isInGuidedSetup, isOnboardingComplete, navigate]);\n  \n  // Handle completion\n  const handleComplete = async () => {\n    try {\n      await completeOnboarding();\n      navigate('/', { replace: true });\n    } catch (error) {\n      console.error('Error completing onboarding:', error);\n    }\n  };\n\n  // Animation on mount and when currentStep changes\n  useEffect(() => {\n    if (!loading) {\n      setIsAnimating(true);\n      const timer = setTimeout(() => setIsAnimating(false), 300);\n      return () => clearTimeout(timer);\n    }\n  }, [currentStep, loading]);\n\n  const handleStepAction = (step: any) => {\n    if (step.id === 1 || step.id === 4 || step.id === 5) {\n      navigate(`${step.route}${step.route.includes('?') ? '' : '?tutorial=true'}`);\n    } else {\n      navigate(step.route);\n    }\n  };\n\n  if (loading) {\n    return <div className=\"min-h-screen bg-background flex items-center justify-center\">{t('onboarding.getting_started.loading')}</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <div className=\"bg-card border-b border-border\">\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n          <div className=\"flex flex-col sm:flex-row sm:justify-between sm:items-center py-6 gap-6\">\n            <div className=\"text-center sm:text-left\">\n              <h1 className=\"text-xl sm:text-2xl font-bold text-foreground\">{t('onboarding.getting_started.welcome_title')}</h1>\n              <p className=\"text-sm text-muted-foreground mt-2\">{t('onboarding.getting_started.welcome_subtitle')}</p>\n            </div>\n            <div className=\"flex items-center justify-center sm:justify-end gap-3\">\n              <Button variant=\"outline\" size=\"sm\">\n                <HelpCircle className=\"w-4 h-4 mr-2\" />\n                {t('onboarding.getting_started.need_help')}\n              </Button>\n              <Button \n                variant=\"outline\" \n                size=\"sm\"\n                onClick={() => setShowSampleDataModal(true)}\n              >\n                {t('onboarding.getting_started.skip_setup')}\n              </Button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 pb-safe\">\n        {/* Progress Section */}\n        <div className={`mb-6 sm:mb-8 ${isAnimating ? 'animate-fade-in' : ''}`}>\n          <Card>\n            <CardHeader className=\"pb-4\">\n              <CardTitle className=\"flex items-center gap-2 text-lg sm:text-xl\">\n                {t('onboarding.getting_started.setup_progress')}\n                {completedSteps.length > 0 && (\n                  <CheckCircle className=\"w-5 h-5 text-green-500\" />\n                )}\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"space-y-4\">\n                <GuidedStepProgress \n                  currentValue={currentStep - 1}\n                  targetValue={currentStep - 1}\n                  totalSteps={totalSteps}\n                  animate={true}\n                />\n                <div className=\"flex flex-col gap-2 text-sm text-muted-foreground\">\n                  <div className=\"font-medium\">\n                    <span className=\"text-foreground\">{t('onboarding.getting_started.now_label')}</span> {currentStepInfo ? t(`onboarding.steps.step_${currentStepInfo.id}.title`) : t('onboarding.getting_started.all_tasks_complete')}\n                  </div>\n                  {nextStepInfo && (\n                    <div>\n                      <span className=\"text-foreground\">{t('onboarding.getting_started.next_label')}</span> {t(`onboarding.steps.step_${nextStepInfo.id}.title`)}\n                    </div>\n                  )}\n                </div>\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Learning Path Header */}\n        <div className=\"mb-6 sm:mb-8 text-center\">\n          <h2 className=\"text-xl sm:text-2xl font-semibold text-foreground mb-2\">\n            {t('onboarding.getting_started.your_learning_path')}\n          </h2>\n          <p className=\"text-sm sm:text-base text-muted-foreground\">\n            {t('onboarding.getting_started.learning_path_subtitle')}\n          </p>\n        </div>\n\n        {/* Completed Steps */}\n        {completedSteps.length > 0 && (\n          <div className={`mb-4 ${isAnimating ? 'animate-scale-in' : ''}`}>\n            <div className=\"space-y-2\">\n              {completedSteps.map((step, index) => (\n                <div key={step.id} className=\"flex items-center gap-3 py-2 px-3 rounded-lg bg-muted/30 border border-border/50\">\n                  <div className=\"flex items-center justify-center w-6 h-6 rounded-full bg-green-500 text-white flex-shrink-0\">\n                    <CheckCircle className=\"w-3 h-3\" />\n                  </div>\n                  <div className=\"flex-1 min-w-0\">\n                    <p className=\"text-sm font-medium text-muted-foreground truncate\">\n                      {t(`onboarding.steps.step_${step.id}.title`)}\n                    </p>\n                  </div>\n                  <div className=\"text-xs text-green-600 dark:text-green-400 font-medium flex-shrink-0\">\n                    ✓\n                  </div>\n                </div>\n              ))}\n            </div>\n          </div>\n        )}\n\n        {/* Current Task */}\n        {currentStepInfo && (\n          <div className={`mb-6 sm:mb-8 ${isAnimating ? 'animate-fade-in' : ''}`}>\n            <Card className=\"border-primary/20 bg-gradient-to-r from-primary/5 to-accent/5\">\n              <CardContent className=\"p-4 md:p-6\">\n                <div className=\"flex items-center justify-between\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex items-center gap-4 mb-3\">\n                      <div className=\"flex items-center justify-center w-10 h-10 rounded-full bg-primary text-primary-foreground text-lg font-bold animate-pulse\">\n                        {currentStepInfo.id}\n                      </div>\n                      <div className=\"flex items-center gap-3\">\n                        <CardTitle className=\"text-xl\">\n                          {t(`onboarding.steps.step_${currentStepInfo.id}.title`)}\n                        </CardTitle>\n                        <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-muted text-muted-foreground\">\n                          <Clock className=\"w-3 h-3 mr-1\" />\n                          {t(`onboarding.steps.step_${currentStepInfo.id}.duration`)}\n                        </span>\n                      </div>\n                    </div>\n                    <CardDescription className=\"text-base text-muted-foreground ml-14\">\n                      {t(`onboarding.steps.step_${currentStepInfo.id}.description`)}\n                    </CardDescription>\n                  </div>\n                  <div className=\"ml-8\">\n                    <Button \n                      size=\"lg\" \n                      onClick={() => handleStepAction(currentStepInfo)}\n                      className=\"hover-scale\"\n                    >\n                      {t(`onboarding.steps.step_${currentStepInfo.id}.button`)}\n                      <ArrowRight className=\"w-4 h-4 ml-2\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Next Step Preview */}\n        {nextStepInfo && (\n          <div className=\"mb-6 sm:mb-8\">\n            <div className=\"flex items-center gap-2 mb-4\">\n              <div className=\"h-px bg-border flex-1\"></div>\n              <span className=\"text-xs text-muted-foreground uppercase tracking-wide px-3\">{t('onboarding.getting_started.coming_next')}</span>\n              <div className=\"h-px bg-border flex-1\"></div>\n            </div>\n            \n            <Card className=\"opacity-50 pointer-events-none grayscale-[0.3] hover:opacity-60 transition-opacity\">\n              <CardContent className=\"p-4 md:p-6\">\n                {/* Mobile-first responsive layout for next step preview */}\n                <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n                  <div className=\"flex-1\">\n                    <div className=\"flex flex-col sm:flex-row sm:items-center gap-3 mb-3\">\n                      <div className=\"flex items-center gap-3\">\n                        <div className=\"flex items-center justify-center w-10 h-10 rounded-full border-2 border-muted-foreground/30 text-muted-foreground text-lg font-bold flex-shrink-0\">\n                          {nextStepInfo.id}\n                        </div>\n                        <CardTitle className=\"text-lg sm:text-xl text-muted-foreground leading-tight\">\n                          {t(`onboarding.steps.step_${nextStepInfo.id}.title`)}\n                        </CardTitle>\n                      </div>\n                      <span className=\"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-muted/50 text-muted-foreground/80 w-fit\">\n                        <Clock className=\"w-3 h-3 mr-1\" />\n                        {t(`onboarding.steps.step_${nextStepInfo.id}.duration`)}\n                      </span>\n                    </div>\n                    <CardDescription className=\"text-sm sm:text-base text-muted-foreground/80 pl-0 sm:pl-13\">\n                      {t(`onboarding.steps.step_${nextStepInfo.id}.description`)}\n                    </CardDescription>\n                  </div>\n                  <div className=\"flex-shrink-0\">\n                    <Button \n                      size=\"lg\"\n                      variant=\"outline\"\n                      disabled\n                      className=\"opacity-50 w-full sm:w-auto\"\n                    >\n                      {t(`onboarding.steps.step_${nextStepInfo.id}.button`)}\n                      <ArrowRight className=\"w-4 h-4 ml-2\" />\n                    </Button>\n                  </div>\n                </div>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n\n        {/* Completion */}\n        {isAllStepsComplete && (\n          <div className={`text-center ${isAnimating ? 'animate-scale-in' : ''}`}>\n            <Card className=\"border-green-200 bg-green-50 dark:border-green-800 dark:bg-green-950/20\">\n              <CardContent className=\"py-12\">\n                <CheckCircle className=\"w-16 h-16 text-green-500 mx-auto mb-4 animate-pulse\" />\n                <h2 className=\"text-2xl font-bold text-green-700 dark:text-green-400 mb-2\">\n                  {t('onboarding.getting_started.congratulations')}\n                </h2>\n                <p className=\"text-green-600 dark:text-green-300 mb-6\">\n                  {t('onboarding.getting_started.setup_complete')}\n                </p>\n                <Button \n                  size=\"lg\" \n                  className=\"bg-green-600 hover:bg-green-700 hover-scale\"\n                  onClick={handleComplete}\n                >\n                  {t('onboarding.getting_started.go_to_dashboard')}\n                  <ArrowRight className=\"w-4 h-4 ml-2\" />\n                </Button>\n              </CardContent>\n            </Card>\n          </div>\n        )}\n      </div>\n\n      <SampleDataModal \n        open={showSampleDataModal}\n        onClose={() => setShowSampleDataModal(false)}\n      />\n\n      <RestartGuidedModeButton />\n      <ExitGuidanceModeButton />\n    </div>\n  );\n};\n\nexport default GettingStarted;","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Index.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/LeadDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/NotFound.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Payments.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/ProjectDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/ReminderDetails.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/SessionDetail.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/TemplateBuilder.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Templates.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/UpcomingSessions.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/Workflows.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/AllLeads.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/AllProjects.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Analytics.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Auth.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Calendar.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/GettingStarted.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Index.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/LeadDetail.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/NotFound.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Payments.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/ProjectDetail.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/ReminderDetails.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/SessionDetail.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/TemplateBuilder.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Templates.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/UpcomingSessions.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/__tests__/Workflows.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/admin/Localization.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/admin/System.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/admin/Users.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/admin/__tests__/Localization.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/admin/__tests__/System.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/admin/__tests__/Users.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/leads/hooks/__tests__/useLeadsFilters.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/leads/hooks/useLeadsData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/leads/hooks/useLeadsFilters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/PaymentsDateControls.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/PaymentsMetricsSummary.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/PaymentsTableSection.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/PaymentsTrendChart.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/__tests__/PaymentsDateControls.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/__tests__/PaymentsMetricsSummary.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/__tests__/PaymentsTableSection.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/components/__tests__/PaymentsTrendChart.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/constants.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/hooks/__tests__/usePaymentsData.test.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":38,"column":18,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":38,"endColumn":21,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[845,848],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[845,848],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { act, renderHook, waitFor } from \"@testing-library/react\";\n\njest.mock(\"@/integrations/supabase/client\", () => {\n  const from = jest.fn();\n  return {\n    supabase: {\n      from,\n      rpc: jest.fn(),\n      auth: {\n        getUser: jest.fn(),\n        signIn: jest.fn(),\n        signOut: jest.fn(),\n      },\n    },\n  };\n});\n\nimport { supabase } from \"@/integrations/supabase/client\";\nimport type {\n  Payment,\n  PaymentStatusFilter,\n  PaymentTypeFilter,\n  SortDirection,\n  SortField,\n} from \"../../types\";\nimport { PROJECT_SELECT_FIELDS } from \"../../constants\";\nimport { usePaymentsData } from \"../usePaymentsData\";\n\nconst supabaseFromMock = supabase.from as jest.Mock;\n\ntype QueryResult = {\n  data: unknown;\n  error: unknown;\n  count?: number | null;\n};\n\nconst createQueryBuilder = <T extends QueryResult>(result: T) => {\n  const builder: any = {\n    select: jest.fn(() => builder),\n    ilike: jest.fn(() => builder),\n    in: jest.fn(() => builder),\n    or: jest.fn(() => builder),\n    gte: jest.fn(() => builder),\n    lte: jest.fn(() => builder),\n    order: jest.fn(() => builder),\n    range: jest.fn(() => builder),\n    eq: jest.fn(() => builder),\n  };\n\n  builder.then = (onFulfilled?: (value: T) => unknown, onRejected?: (reason: unknown) => unknown) =>\n    Promise.resolve(result).then(onFulfilled, onRejected);\n  builder.catch = (onRejected?: (reason: unknown) => unknown) =>\n    Promise.resolve(result).catch(onRejected);\n  builder[Symbol.toStringTag] = \"Promise\";\n  return builder;\n};\n\ntype QueryBuilder = ReturnType<typeof createQueryBuilder>;\n\ntype QueueMap = Record<\"payments\" | \"projects\" | \"leads\", QueryBuilder[]>;\n\ndescribe(\"usePaymentsData\", () => {\n  const baseProps = {\n    page: 1,\n    pageSize: 2,\n    sortField: \"project_name\" as SortField,\n    sortDirection: \"asc\" as SortDirection,\n    statusFilters: [] as PaymentStatusFilter[],\n    typeFilters: [] as PaymentTypeFilter[],\n    amountMinFilter: null,\n    amountMaxFilter: null,\n    searchTerm: \"\",\n    activeDateRange: null,\n  };\n\n  let queues: QueueMap;\n  let onError: jest.Mock;\n\n  const enqueue = (table: keyof QueueMap, builder: QueryBuilder) => {\n    queues[table].push(builder);\n    return builder;\n  };\n\n  beforeEach(() => {\n    queues = {\n      payments: [],\n      projects: [],\n      leads: [],\n    };\n    onError = jest.fn();\n    supabaseFromMock.mockReset();\n    supabaseFromMock.mockImplementation((table: string) => {\n      const key = table as keyof QueueMap;\n      const queue = queues[key];\n      if (!queue?.length) {\n        throw new Error(`No mock registered for table ${table}`);\n      }\n      return queue.shift()!;\n    });\n  });\n\n  afterEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it(\"fetches payments, hydrates related entities, and appends subsequent pages\", async () => {\n    const tablePayments: Payment[] = [\n      {\n        id: \"payment-b\",\n        amount: 220,\n        date_paid: \"2024-04-10T00:00:00Z\",\n        status: \"paid\",\n        description: \"Second\",\n        type: \"extra\",\n        project_id: \"project-b\",\n        created_at: \"2024-04-01T00:00:00Z\",\n        projects: null,\n      },\n      {\n        id: \"payment-a\",\n        amount: 120,\n        date_paid: \"2024-04-08T00:00:00Z\",\n        status: \"due\",\n        description: \"First\",\n        type: \"base_price\",\n        project_id: \"project-a\",\n        created_at: \"2024-03-01T00:00:00Z\",\n        projects: null,\n      },\n    ];\n\n    const metricsPayments: Payment[] = [\n      {\n        id: \"metric-1\",\n        amount: 220,\n        date_paid: \"2024-04-10T00:00:00Z\",\n        status: \"paid\",\n        description: null,\n        type: \"extra\",\n        project_id: \"project-b\",\n        created_at: \"2024-04-01T00:00:00Z\",\n        projects: null,\n      },\n    ];\n\n    const projectsResult = [\n      {\n        id: \"project-a\",\n        name: \"Alpha Project\",\n        base_price: 100,\n        lead_id: \"lead-a\",\n        status_id: null,\n        previous_status_id: null,\n        project_type_id: null,\n        description: null,\n        updated_at: \"2024-03-05T00:00:00Z\",\n        created_at: \"2024-02-01T00:00:00Z\",\n        user_id: \"user-a\",\n      },\n      {\n        id: \"project-b\",\n        name: \"Beta Project\",\n        base_price: 200,\n        lead_id: \"lead-b\",\n        status_id: null,\n        previous_status_id: null,\n        project_type_id: null,\n        description: null,\n        updated_at: \"2024-04-09T00:00:00Z\",\n        created_at: \"2024-02-15T00:00:00Z\",\n        user_id: \"user-b\",\n      },\n    ];\n\n    const leadsResult = [\n      { id: \"lead-a\", name: \"Alice\" },\n      { id: \"lead-b\", name: \"Bob\" },\n    ];\n\n    const tableBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({ data: tablePayments, error: null, count: 2 })\n    );\n    const metricsBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({ data: metricsPayments, error: null })\n    );\n    const hydrationProjectsBuilder = enqueue(\n      \"projects\",\n      createQueryBuilder({ data: projectsResult, error: null })\n    );\n    const hydrationLeadsBuilder = enqueue(\n      \"leads\",\n      createQueryBuilder({ data: leadsResult, error: null })\n    );\n\n    const { result, rerender } = renderHook(\n      (props: typeof baseProps & { onError: (error: Error) => void }) =>\n        usePaymentsData(props),\n      {\n        initialProps: { ...baseProps, onError },\n      }\n    );\n\n    await waitFor(() => expect(result.current.initialLoading).toBe(false));\n    await waitFor(() => expect(result.current.tableLoading).toBe(false));\n\n    expect(result.current.totalCount).toBe(2);\n    expect(result.current.metricsPayments).toEqual(metricsPayments);\n    expect(result.current.paginatedPayments.map((payment) => payment.projects?.name)).toEqual([\n      \"Alpha Project\",\n      \"Beta Project\",\n    ]);\n    expect(result.current.paginatedPayments[0]?.projects?.leads?.name).toBe(\"Alice\");\n    expect(result.current.paginatedPayments[1]?.projects?.leads?.name).toBe(\"Bob\");\n\n    expect(tableBuilder.select).toHaveBeenCalledWith(\"*\", { count: \"exact\" });\n    expect(tableBuilder.range).toHaveBeenCalledWith(0, 1);\n    expect(tableBuilder.order).toHaveBeenCalledWith(\"created_at\", { ascending: false });\n    expect(metricsBuilder.select).toHaveBeenCalledWith(\n      \"id, amount, status, type, date_paid, created_at, project_id\"\n    );\n    expect(hydrationProjectsBuilder.select).toHaveBeenCalledWith(PROJECT_SELECT_FIELDS);\n    expect(hydrationProjectsBuilder.in).toHaveBeenCalledWith(\"id\", [\n      \"project-b\",\n      \"project-a\",\n    ]);\n    expect(hydrationLeadsBuilder.select).toHaveBeenCalledWith(\"id, name\");\n    expect(hydrationLeadsBuilder.in).toHaveBeenCalledWith(\"id\", [\"lead-a\", \"lead-b\"]);\n\n    const nextPayments: Payment[] = [\n      {\n        id: \"payment-c\",\n        amount: 320,\n        date_paid: \"2024-04-12T00:00:00Z\",\n        status: \"paid\",\n        description: \"Third\",\n        type: \"manual\",\n        project_id: \"project-c\",\n        created_at: \"2024-04-11T00:00:00Z\",\n        projects: null,\n      },\n    ];\n\n    const nextMetrics: Payment[] = [\n      {\n        id: \"metric-2\",\n        amount: 320,\n        date_paid: \"2024-04-12T00:00:00Z\",\n        status: \"paid\",\n        description: null,\n        type: \"manual\",\n        project_id: \"project-c\",\n        created_at: \"2024-04-11T00:00:00Z\",\n        projects: null,\n      },\n    ];\n\n    const nextTableBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({ data: nextPayments, error: null, count: 3 })\n    );\n    const nextMetricsBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({ data: nextMetrics, error: null })\n    );\n    enqueue(\n      \"projects\",\n      createQueryBuilder({\n        data: [\n          {\n            id: \"project-c\",\n            name: \"Delta Project\",\n            base_price: 300,\n            lead_id: \"lead-c\",\n            status_id: null,\n            previous_status_id: null,\n            project_type_id: null,\n            description: null,\n            updated_at: \"2024-04-12T00:00:00Z\",\n            created_at: \"2024-04-10T00:00:00Z\",\n            user_id: \"user-c\",\n          },\n        ],\n        error: null,\n      })\n    );\n    enqueue(\n      \"leads\",\n      createQueryBuilder({ data: [{ id: \"lead-c\", name: \"Charlie\" }], error: null })\n    );\n\n    rerender({ ...baseProps, page: 2, onError });\n\n    await waitFor(() => expect(result.current.tableLoading).toBe(false));\n    await waitFor(() => expect(result.current.paginatedPayments).toHaveLength(1));\n\n    expect(result.current.paginatedPayments[0]?.projects?.name).toBe(\"Delta Project\");\n    expect(result.current.paginatedPayments[0]?.projects?.leads?.name).toBe(\"Charlie\");\n    expect(result.current.totalCount).toBe(3);\n    expect(result.current.metricsPayments).toEqual(nextMetrics);\n    expect(nextMetricsBuilder.select).toHaveBeenCalledWith(\n      \"id, amount, status, type, date_paid, created_at, project_id\"\n    );\n    expect(nextTableBuilder.range).toHaveBeenCalledWith(2, 3);\n    expect(queues.payments).toHaveLength(0);\n  });\n\n  it(\"applies search, type, and amount filters when fetching data\", async () => {\n    const searchProjectsBuilder = enqueue(\n      \"projects\",\n      createQueryBuilder({\n        data: [\n          {\n            id: \"project-30\",\n            name: \"Omega\",\n            base_price: 100,\n            lead_id: \"lead-30\",\n            status_id: null,\n            previous_status_id: null,\n            project_type_id: null,\n            description: null,\n            updated_at: \"2024-03-01T00:00:00Z\",\n            created_at: \"2024-02-01T00:00:00Z\",\n            user_id: \"user-30\",\n          },\n          {\n            id: \"project-40\",\n            name: \"Sigma\",\n            base_price: 120,\n            lead_id: \"lead-40\",\n            status_id: null,\n            previous_status_id: null,\n            project_type_id: null,\n            description: null,\n            updated_at: \"2024-03-02T00:00:00Z\",\n            created_at: \"2024-02-02T00:00:00Z\",\n            user_id: \"user-40\",\n          },\n        ],\n        error: null,\n      })\n    );\n    const searchLeadsBuilder = enqueue(\n      \"leads\",\n      createQueryBuilder({\n        data: [\n          { id: \"lead-30\", name: \"Olive\" },\n          { id: \"lead-40\", name: \"Orion\" },\n        ],\n        error: null,\n      })\n    );\n    const projectsForLeadsBuilder = enqueue(\n      \"projects\",\n      createQueryBuilder({\n        data: [\n          {\n            id: \"project-50\",\n            name: \"Tau\",\n            base_price: 200,\n            lead_id: \"lead-50\",\n            status_id: null,\n            previous_status_id: null,\n            project_type_id: null,\n            description: null,\n            updated_at: \"2024-03-03T00:00:00Z\",\n            created_at: \"2024-02-03T00:00:00Z\",\n            user_id: \"user-50\",\n          },\n        ],\n        error: null,\n      })\n    );\n    const hydrationSearchLeadsBuilder = enqueue(\n      \"leads\",\n      createQueryBuilder({\n        data: [{ id: \"lead-50\", name: \"Tessa\" }],\n        error: null,\n      })\n    );\n\n    const tableBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({\n        data: [\n          {\n            id: \"payment-newer\",\n            amount: 400,\n            date_paid: \"2024-05-05T00:00:00Z\",\n            status: \"paid\",\n            description: \"Newest\",\n            type: \"extra\",\n            project_id: \"project-40\",\n            created_at: \"2024-05-01T00:00:00Z\",\n            projects: null,\n          },\n          {\n            id: \"payment-older\",\n            amount: 80,\n            date_paid: \"2024-04-01T00:00:00Z\",\n            status: \"paid\",\n            description: \"Older\",\n            type: \"extra\",\n            project_id: \"project-30\",\n            created_at: \"2024-03-01T00:00:00Z\",\n            projects: null,\n          },\n        ],\n        error: null,\n        count: 2,\n      })\n    );\n\n    const metricsBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({\n        data: [\n          {\n            id: \"payment-metric\",\n            amount: 400,\n            date_paid: \"2024-05-05T00:00:00Z\",\n            status: \"paid\",\n            description: null,\n            type: \"extra\",\n            project_id: \"project-40\",\n            created_at: \"2024-05-01T00:00:00Z\",\n            projects: null,\n          },\n        ],\n        error: null,\n      })\n    );\n\n    const { result } = renderHook(\n      (props: typeof baseProps & { onError: (error: Error) => void }) =>\n        usePaymentsData(props),\n      {\n        initialProps: {\n          ...baseProps,\n          pageSize: 25,\n          sortField: \"date_paid\",\n          sortDirection: \"desc\",\n          statusFilters: [\"paid\"],\n          typeFilters: [\"extra\"],\n          amountMinFilter: 50,\n          amountMaxFilter: 500,\n          searchTerm: 'Pro \"Alpha\"',\n          onError,\n        },\n      }\n    );\n\n    await waitFor(() => expect(result.current.initialLoading).toBe(false));\n    await waitFor(() => expect(result.current.tableLoading).toBe(false));\n\n    expect(searchProjectsBuilder.select).toHaveBeenCalledWith(PROJECT_SELECT_FIELDS);\n    expect(searchProjectsBuilder.ilike).toHaveBeenCalledWith(\"name\", \"%Pro \\\"Alpha\\\"%\");\n    expect(searchLeadsBuilder.select).toHaveBeenCalledWith(\"id, name\");\n    expect(searchLeadsBuilder.ilike).toHaveBeenCalledWith(\"name\", \"%Pro \\\"Alpha\\\"%\");\n    expect(projectsForLeadsBuilder.select).toHaveBeenCalledWith(PROJECT_SELECT_FIELDS);\n    expect(projectsForLeadsBuilder.in).toHaveBeenCalledWith(\"lead_id\", [\"lead-30\", \"lead-40\"]);\n    expect(hydrationSearchLeadsBuilder.select).toHaveBeenCalledWith(\"id, name\");\n    expect(hydrationSearchLeadsBuilder.in).toHaveBeenCalledWith(\"id\", [\"lead-50\"]);\n\n    expect(tableBuilder.select).toHaveBeenCalledWith(\"*\", { count: \"exact\" });\n    expect(tableBuilder.ilike).toHaveBeenCalledWith(\"status\", \"paid\");\n    expect(tableBuilder.in).toHaveBeenCalledWith(\"type\", [\"extra\"]);\n    expect(tableBuilder.gte).toHaveBeenCalledWith(\"amount\", 50);\n    expect(tableBuilder.lte).toHaveBeenCalledWith(\"amount\", 500);\n    expect(tableBuilder.or).toHaveBeenCalledWith(\n      expect.stringContaining(\"project_id.in.(project-30,project-40,project-50)\")\n    );\n    expect(tableBuilder.or).toHaveBeenCalledWith(\n      expect.stringContaining('description.ilike.\"%Pro \"\"Alpha\"\"%\"')\n    );\n    expect(tableBuilder.order).toHaveBeenNthCalledWith(1, \"date_paid\", {\n      ascending: false,\n      nullsLast: true,\n    });\n    expect(tableBuilder.order).toHaveBeenNthCalledWith(2, \"created_at\", {\n      ascending: false,\n    });\n    expect(tableBuilder.range).toHaveBeenCalledWith(0, 24);\n\n    expect(metricsBuilder.select).toHaveBeenCalledWith(\n      \"id, amount, status, type, date_paid, created_at, project_id\"\n    );\n    expect(metricsBuilder.ilike).toHaveBeenCalledWith(\"status\", \"paid\");\n    expect(metricsBuilder.in).toHaveBeenCalledWith(\"type\", [\"extra\"]);\n    expect(metricsBuilder.gte).toHaveBeenCalledWith(\"amount\", 50);\n    expect(metricsBuilder.lte).toHaveBeenCalledWith(\"amount\", 500);\n    expect(metricsBuilder.or).toHaveBeenCalledWith(\n      expect.stringContaining(\"project_id.in.(project-30,project-40,project-50)\")\n    );\n\n    await waitFor(() => expect(result.current.paginatedPayments).toHaveLength(2));\n    expect(result.current.paginatedPayments[0]?.id).toBe(\"payment-newer\");\n    expect(result.current.totalCount).toBe(2);\n  });\n\n  it(\"surfaces Supabase errors through the provided handler\", async () => {\n    const failingBuilder = enqueue(\n      \"payments\",\n      createQueryBuilder({\n        data: null,\n        error: new Error(\"payments fetch failed\"),\n      })\n    );\n\n    const { result } = renderHook(\n      (props: typeof baseProps & { onError: (error: Error) => void }) =>\n        usePaymentsData(props),\n      {\n        initialProps: { ...baseProps, onError },\n      }\n    );\n\n    await waitFor(() => expect(onError).toHaveBeenCalled());\n\n    expect(onError).toHaveBeenCalledWith(expect.objectContaining({ message: \"payments fetch failed\" }));\n    expect(result.current.initialLoading).toBe(false);\n    expect(result.current.tableLoading).toBe(false);\n    expect(result.current.paginatedPayments).toHaveLength(0);\n    expect(failingBuilder.range).toHaveBeenCalledWith(0, 1);\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/hooks/__tests__/usePaymentsFilters.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/hooks/__tests__/usePaymentsTableColumns.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/hooks/usePaymentsData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/hooks/usePaymentsFilters.tsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useMemo has a missing dependency: 'amountDirty'. Either include it or remove the dependency array.","line":350,"column":5,"nodeType":"ArrayExpression","endLine":364,"endColumn":6,"suggestions":[{"desc":"Update the dependencies array to be: [amountDirty, amountMaxDraft, amountMinDraft, filtersState.status, filtersState.type, handleAmountMaxDraftChange, handleAmountMinDraftChange, handleApplyAmountFilters, handleStatusChange, handleTypeChange, statusFilterOptions, t, typeFilterOptions]","fix":{"range":[11222,11561],"text":"[amountDirty, amountMaxDraft, amountMinDraft, filtersState.status, filtersState.type, handleAmountMaxDraftChange, handleAmountMinDraftChange, handleApplyAmountFilters, handleStatusChange, handleTypeChange, statusFilterOptions, t, typeFilterOptions]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useMemo, useState, useEffect } from \"react\";\nimport { useTranslation } from \"react-i18next\";\nimport { Button } from \"@/components/ui/button\";\nimport { Check } from \"lucide-react\";\nimport { Input } from \"@/components/ui/input\";\nimport { ToggleGroup, ToggleGroupItem } from \"@/components/ui/toggle-group\";\nimport type { AdvancedDataTableFiltersConfig } from \"@/components/data-table\";\nimport {\n  SEARCH_MIN_CHARS,\n  STATUS_FILTER_OPTIONS,\n  TYPE_FILTER_OPTIONS,\n} from \"../constants\";\nimport type {\n  PaymentStatusFilter,\n  PaymentTypeFilter,\n} from \"../types\";\n\nexport type PaymentsFiltersState = {\n  status: PaymentStatusFilter[];\n  type: PaymentTypeFilter[];\n  amountMin: number | null;\n  amountMax: number | null;\n  search: string;\n};\n\nexport type PaymentsFiltersChangeReason = \"apply\" | \"reset\" | \"search\";\n\ninterface UsePaymentsFiltersOptions {\n  onStateChange?: (\n    next: PaymentsFiltersState,\n    meta: { reason: PaymentsFiltersChangeReason }\n  ) => void;\n  initialState?: PaymentsFiltersState;\n}\n\ninterface UsePaymentsFiltersResult {\n  state: PaymentsFiltersState;\n  filtersConfig: AdvancedDataTableFiltersConfig;\n  searchValue: string;\n  onSearchChange: (value: string) => void;\n  onSearchClear: () => void;\n  activeFilterCount: number;\n}\n\nconst defaultState: PaymentsFiltersState = {\n  status: [],\n  type: [],\n  amountMin: null,\n  amountMax: null,\n  search: \"\",\n};\n\nconst arraysMatch = (a: string[], b: string[]) => {\n  if (a.length !== b.length) return false;\n  const sortedA = [...a].sort();\n  const sortedB = [...b].sort();\n  return sortedA.every((value, index) => value === sortedB[index]);\n};\n\nexport function usePaymentsFilters({\n  onStateChange,\n  initialState = defaultState,\n}: UsePaymentsFiltersOptions = {}): UsePaymentsFiltersResult {\n  const { t } = useTranslation(\"pages\");\n\n  const normalizedInitialState = useMemo(\n    () => ({ ...defaultState, ...initialState }),\n    [initialState]\n  );\n\n  const [filtersState, setFiltersState] = useState<PaymentsFiltersState>(\n    normalizedInitialState\n  );\n  const [searchDraft, setSearchDraft] = useState<string>(\n    normalizedInitialState.search\n  );\n  const [amountMinDraft, setAmountMinDraft] = useState<string>(\n    normalizedInitialState.amountMin != null\n      ? String(normalizedInitialState.amountMin)\n      : \"\"\n  );\n  const [amountMaxDraft, setAmountMaxDraft] = useState<string>(\n    normalizedInitialState.amountMax != null\n      ? String(normalizedInitialState.amountMax)\n      : \"\"\n  );\n\n  useEffect(() => {\n    setFiltersState(normalizedInitialState);\n    setSearchDraft(normalizedInitialState.search);\n    setAmountMinDraft(\n      normalizedInitialState.amountMin != null\n        ? String(normalizedInitialState.amountMin)\n        : \"\"\n    );\n    setAmountMaxDraft(\n      normalizedInitialState.amountMax != null\n        ? String(normalizedInitialState.amountMax)\n        : \"\"\n    );\n  }, [normalizedInitialState]);\n\n  const parseAmountInputValue = useCallback((value: string): number | null => {\n    const trimmed = value.trim();\n    if (trimmed === \"\") return null;\n    const parsed = Number(trimmed);\n    return Number.isFinite(parsed) ? parsed : null;\n  }, []);\n\n  useEffect(() => {\n    setAmountMinDraft(\n      filtersState.amountMin != null ? String(filtersState.amountMin) : \"\"\n    );\n  }, [filtersState.amountMin]);\n\n  useEffect(() => {\n    setAmountMaxDraft(\n      filtersState.amountMax != null ? String(filtersState.amountMax) : \"\"\n    );\n  }, [filtersState.amountMax]);\n\n  const updateState = useCallback(\n    (\n      updater: (prev: PaymentsFiltersState) => PaymentsFiltersState,\n      reason: PaymentsFiltersChangeReason = \"apply\"\n    ) => {\n      setFiltersState((prev) => {\n        const next = updater(prev);\n        const unchanged =\n          arraysMatch(prev.status, next.status) &&\n          arraysMatch(prev.type, next.type) &&\n          prev.amountMin === next.amountMin &&\n          prev.amountMax === next.amountMax &&\n          prev.search === next.search;\n        if (unchanged) {\n          return prev;\n        }\n        onStateChange?.(next, { reason });\n        return next;\n      });\n    },\n    [onStateChange]\n  );\n\n  const activeFilterCount = useMemo(() => {\n    const hasStatus =\n      filtersState.status.length > 0 &&\n      filtersState.status.length < STATUS_FILTER_OPTIONS.length;\n    const hasType =\n      filtersState.type.length > 0 &&\n      filtersState.type.length < TYPE_FILTER_OPTIONS.length;\n    const hasMin = filtersState.amountMin !== null;\n    const hasMax = filtersState.amountMax !== null;\n    return [hasStatus, hasType, hasMin, hasMax].filter(Boolean).length;\n  }, [filtersState]);\n\n  const handleResetFilters = useCallback(() => {\n    const resetState: PaymentsFiltersState = {\n      ...normalizedInitialState,\n      search: \"\",\n    };\n    setFiltersState(resetState);\n    setSearchDraft(\"\");\n    setAmountMinDraft(\n      resetState.amountMin != null ? String(resetState.amountMin) : \"\"\n    );\n    setAmountMaxDraft(\n      resetState.amountMax != null ? String(resetState.amountMax) : \"\"\n    );\n    onStateChange?.(resetState, { reason: \"reset\" });\n  }, [normalizedInitialState, onStateChange]);\n\n  const handleStatusChange = useCallback(\n    (values: PaymentStatusFilter[]) => {\n      updateState((prev) => ({ ...prev, status: values }));\n    },\n    [updateState]\n  );\n\n  const handleTypeChange = useCallback(\n    (values: PaymentTypeFilter[]) => {\n      updateState((prev) => ({ ...prev, type: values }));\n    },\n    [updateState]\n  );\n\n  const handleAmountMinDraftChange = useCallback((value: string) => {\n    setAmountMinDraft(value);\n  }, []);\n\n  const handleAmountMaxDraftChange = useCallback((value: string) => {\n    setAmountMaxDraft(value);\n  }, []);\n\n  const handleApplyAmountFilters = useCallback(() => {\n    const nextMin = parseAmountInputValue(amountMinDraft);\n    const nextMax = parseAmountInputValue(amountMaxDraft);\n    updateState(\n      (prev) => ({ ...prev, amountMin: nextMin, amountMax: nextMax })\n    );\n  }, [amountMaxDraft, amountMinDraft, parseAmountInputValue, updateState]);\n\n  const amountDirty = useMemo(() => {\n    const parsedMin = parseAmountInputValue(amountMinDraft);\n    const parsedMax = parseAmountInputValue(amountMaxDraft);\n    return (\n      parsedMin !== filtersState.amountMin || parsedMax !== filtersState.amountMax\n    );\n  }, [\n    amountMaxDraft,\n    amountMinDraft,\n    filtersState.amountMax,\n    filtersState.amountMin,\n    parseAmountInputValue,\n  ]);\n\n  const handleSearchDraftChange = useCallback(\n    (value: string) => {\n      setSearchDraft(value);\n      const trimmed = value.trim();\n      if (trimmed.length >= SEARCH_MIN_CHARS || trimmed.length === 0) {\n        updateState((prev) => ({ ...prev, search: trimmed }), \"search\");\n      }\n    },\n    [updateState]\n  );\n\n  const handleClearSearchDraft = useCallback(() => {\n    setSearchDraft(\"\");\n    updateState((prev) => ({ ...prev, search: \"\" }), \"search\");\n  }, [updateState]);\n\n  const statusFilterOptions = useMemo(\n    () =>\n      STATUS_FILTER_OPTIONS.map((value) => ({\n        value,\n        label: value === \"paid\" ? t(\"payments.status.paid\") : t(\"payments.status.due\"),\n      })),\n    [t]\n  );\n\n  const typeFilterOptions = useMemo(\n    () =>\n      TYPE_FILTER_OPTIONS.map((value) => ({\n        value,\n        label:\n          value === \"base_price\"\n            ? t(\"payments.type.base\")\n            : value === \"extra\"\n              ? t(\"payments.type.extra\")\n              : t(\"payments.type.manual\"),\n      })),\n    [t]\n  );\n\n  const toggleItemClasses =\n    \"rounded-full border border-border/60 bg-background px-3 py-1 text-sm font-medium transition-colors hover:border-border hover:bg-muted/20 data-[state=on]:bg-primary/10 data-[state=on]:text-primary data-[state=on]:border-primary/40\";\n\n  const filtersContent = useMemo(\n    () => (\n      <div className=\"space-y-6\">\n        <div className=\"space-y-2\">\n          <p className=\"text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n            {t(\"payments.filters.statusHeading\")}\n          </p>\n          <ToggleGroup\n            type=\"multiple\"\n            value={filtersState.status}\n            onValueChange={(values) => handleStatusChange(values as PaymentStatusFilter[])}\n            className=\"flex flex-wrap justify-start gap-2\"\n            size=\"sm\"\n          >\n            {statusFilterOptions.map((option) => (\n              <ToggleGroupItem key={option.value} value={option.value} className={toggleItemClasses}>\n                {option.label}\n              </ToggleGroupItem>\n            ))}\n          </ToggleGroup>\n        </div>\n        <div className=\"space-y-2\">\n          <p className=\"text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n            {t(\"payments.filters.typeHeading\")}\n          </p>\n          <ToggleGroup\n            type=\"multiple\"\n            value={filtersState.type}\n            onValueChange={(values) => handleTypeChange(values as PaymentTypeFilter[])}\n            className=\"flex flex-wrap justify-start gap-2\"\n            size=\"sm\"\n          >\n            {typeFilterOptions.map((option) => (\n              <ToggleGroupItem key={option.value} value={option.value} className={toggleItemClasses}>\n                {option.label}\n              </ToggleGroupItem>\n            ))}\n          </ToggleGroup>\n        </div>\n        <div className=\"space-y-2\">\n          <p className=\"text-xs font-semibold uppercase tracking-wide text-muted-foreground\">\n            {t(\"payments.filters.amountHeading\")}\n          </p>\n          <div className=\"flex items-center gap-2\">\n            <div className=\"grid flex-1 gap-2 sm:grid-cols-2\">\n              <Input\n                type=\"number\"\n                inputMode=\"decimal\"\n                step=\"0.01\"\n                min=\"0\"\n                value={amountMinDraft}\n                onChange={(event) => handleAmountMinDraftChange(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === \"Enter\") {\n                    event.preventDefault();\n                    handleApplyAmountFilters();\n                  }\n                }}\n              placeholder={t(\"payments.filters.amountMinPlaceholder\")}\n              className=\"h-9 rounded-full\"\n              />\n              <Input\n                type=\"number\"\n                inputMode=\"decimal\"\n                step=\"0.01\"\n                min=\"0\"\n                value={amountMaxDraft}\n                onChange={(event) => handleAmountMaxDraftChange(event.target.value)}\n                onKeyDown={(event) => {\n                  if (event.key === \"Enter\") {\n                    event.preventDefault();\n                    handleApplyAmountFilters();\n                  }\n                }}\n              placeholder={t(\"payments.filters.amountMaxPlaceholder\")}\n              className=\"h-9 rounded-full\"\n              />\n            </div>\n            <Button\n              type=\"button\"\n              size=\"icon\"\n              className=\"h-9 w-9 shrink-0\"\n              onClick={handleApplyAmountFilters}\n              disabled={!amountDirty}\n            >\n              <Check className=\"h-4 w-4\" />\n            </Button>\n          </div>\n        </div>\n      </div>\n    ),\n    [\n      amountMaxDraft,\n      amountMinDraft,\n      filtersState.status,\n      filtersState.type,\n      handleAmountMaxDraftChange,\n      handleAmountMinDraftChange,\n      handleApplyAmountFilters,\n      handleStatusChange,\n      handleTypeChange,\n      statusFilterOptions,\n      t,\n      toggleItemClasses,\n      typeFilterOptions,\n    ]\n  );\n\n  const filtersConfig: AdvancedDataTableFiltersConfig = useMemo(\n    () => ({\n      title: t(\"payments.filterPanel.title\"),\n      triggerLabel: t(\"payments.filterPanel.title\"),\n      content: filtersContent,\n      activeCount: activeFilterCount,\n      onReset: activeFilterCount ? handleResetFilters : undefined,\n      // Keep the filter rail closed by default; it will auto-open when\n      // there are active filters due to AdvancedDataTable logic.\n      collapsedByDefault: true,\n    }),\n    [activeFilterCount, filtersContent, handleResetFilters, t]\n  );\n\n  return {\n    state: filtersState,\n    filtersConfig,\n    searchValue: searchDraft,\n    onSearchChange: handleSearchDraftChange,\n    onSearchClear: handleClearSearchDraft,\n    activeFilterCount,\n  };\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/hooks/usePaymentsTableColumns.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/payments/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/projects/hooks/__tests__/useProjectsFilters.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/projects/hooks/useProjectsData.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/projects/hooks/useProjectsFilters.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/projects/types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Account_old.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Billing.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":137,"column":21,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":137,"endColumn":24,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[5945,5948],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[5945,5948],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useCallback, useEffect, useMemo, useState } from \"react\";\nimport SettingsPageWrapper from \"@/components/settings/SettingsPageWrapper\";\nimport { TaxBillingSection, TaxProfileFormState, TaxProfileFormErrors } from \"@/components/settings/TaxBillingSection\";\nimport { useOrganizationSettings } from \"@/hooks/useOrganizationSettings\";\nimport { DEFAULT_ORGANIZATION_TAX_PROFILE, OrganizationTaxProfile } from \"@/lib/organizationSettingsCache\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { useTranslation } from \"react-i18next\";\n\nconst clampVatRate = (value: number) => {\n  if (!Number.isFinite(value)) return 0;\n  return Math.min(99.99, Math.max(0, value));\n};\n\nconst profileToFormState = (profile: OrganizationTaxProfile): TaxProfileFormState => ({\n  legalEntityType: profile.legalEntityType ?? \"individual\",\n  companyName: profile.companyName ?? \"\",\n  taxOffice: profile.taxOffice ?? \"\",\n  taxNumber: profile.taxNumber ?? \"\",\n  billingAddress: profile.billingAddress ?? \"\",\n  defaultVatRate:\n    profile.defaultVatRate != null && Number.isFinite(profile.defaultVatRate)\n      ? String(profile.defaultVatRate)\n      : String(DEFAULT_ORGANIZATION_TAX_PROFILE.defaultVatRate),\n  defaultVatMode: profile.defaultVatMode ?? \"exclusive\",\n  pricesIncludeVat: profile.pricesIncludeVat ?? false,\n});\n\nconst normalizeProfile = (profile: OrganizationTaxProfile): OrganizationTaxProfile => {\n  const numericVatRate = Number(profile.defaultVatRate);\n\n  return {\n    ...DEFAULT_ORGANIZATION_TAX_PROFILE,\n    ...profile,\n    legalEntityType: profile.legalEntityType === \"company\" ? \"company\" : \"individual\",\n    defaultVatMode: profile.defaultVatMode === \"inclusive\" ? \"inclusive\" : \"exclusive\",\n    defaultVatRate: clampVatRate(Number.isFinite(numericVatRate) ? numericVatRate : DEFAULT_ORGANIZATION_TAX_PROFILE.defaultVatRate),\n    pricesIncludeVat: Boolean(profile.pricesIncludeVat),\n    companyName: typeof profile.companyName === \"string\" ? profile.companyName.trim() || null : null,\n    taxOffice: typeof profile.taxOffice === \"string\" ? profile.taxOffice.trim() || null : null,\n    taxNumber: typeof profile.taxNumber === \"string\" ? profile.taxNumber.trim() || null : null,\n    billingAddress: typeof profile.billingAddress === \"string\" ? profile.billingAddress.trim() || null : null,\n  };\n};\n\nconst formToProfile = (form: TaxProfileFormState): OrganizationTaxProfile => {\n  const parsedRate = parseFloat(form.defaultVatRate.replace(\",\", \".\"));\n  return normalizeProfile({\n    legalEntityType: form.legalEntityType,\n    companyName: form.companyName.trim() || null,\n    taxOffice: form.taxOffice.trim() || null,\n    taxNumber: form.taxNumber.trim() || null,\n    billingAddress: form.billingAddress.trim() || null,\n    defaultVatRate: Number.isFinite(parsedRate) ? parsedRate : DEFAULT_ORGANIZATION_TAX_PROFILE.defaultVatRate,\n    defaultVatMode: form.defaultVatMode,\n    pricesIncludeVat: form.pricesIncludeVat,\n  });\n};\n\nconst isEqualProfile = (a: OrganizationTaxProfile, b: OrganizationTaxProfile) =>\n  JSON.stringify(normalizeProfile(a)) === JSON.stringify(normalizeProfile(b));\n\nexport default function Billing() {\n  const { t } = useTranslation([\"pages\", \"forms\", \"common\"]);\n  const { toast } = useToast();\n  const { settings, loading, updateSettings } = useOrganizationSettings();\n\n  const normalizedProfile = useMemo(() => {\n    const source = settings?.taxProfile as OrganizationTaxProfile | null;\n    const merged = normalizeProfile({\n      ...DEFAULT_ORGANIZATION_TAX_PROFILE,\n      ...(source ?? {}),\n      companyName: (source?.companyName ?? settings?.photography_business_name ?? null) || null,\n    });\n    return merged;\n  }, [settings]);\n\n  const [formState, setFormState] = useState<TaxProfileFormState>(() => profileToFormState(normalizedProfile));\n  const [errors, setErrors] = useState<TaxProfileFormErrors>({});\n  const [saving, setSaving] = useState(false);\n\n  useEffect(() => {\n    setFormState(profileToFormState(normalizedProfile));\n    setErrors({});\n  }, [normalizedProfile]);\n\n  const handleChange = useCallback((updates: Partial<TaxProfileFormState>) => {\n    setFormState((prev) => ({\n      ...prev,\n      ...updates,\n    }));\n  }, []);\n\n  const validate = useCallback((): boolean => {\n    const nextErrors: TaxProfileFormErrors = {};\n\n    if (formState.legalEntityType === \"company\" && !formState.companyName.trim()) {\n      nextErrors.companyName = t(\"taxBilling.validation.companyNameRequired\", { ns: \"forms\" });\n    }\n\n    const vatRateValue = parseFloat(formState.defaultVatRate.replace(\",\", \".\"));\n    if (formState.defaultVatRate.trim() === \"\" || Number.isNaN(vatRateValue)) {\n      nextErrors.defaultVatRate = t(\"taxBilling.validation.vatRateInvalid\", { ns: \"forms\" });\n    } else if (vatRateValue < 0 || vatRateValue > 99.99) {\n      nextErrors.defaultVatRate = t(\"taxBilling.validation.vatRateRange\", { ns: \"forms\" });\n    }\n\n    setErrors(nextErrors);\n    return Object.keys(nextErrors).length === 0;\n  }, [formState, t]);\n\n  const draftProfile = useMemo(() => formToProfile(formState), [formState]);\n  const isDirty = useMemo(() => !isEqualProfile(draftProfile, normalizedProfile), [draftProfile, normalizedProfile]);\n\n  const handleReset = useCallback(() => {\n    setFormState(profileToFormState(normalizedProfile));\n    setErrors({});\n  }, [normalizedProfile]);\n\n  const handleSave = useCallback(async () => {\n    if (!validate()) return;\n    setSaving(true);\n    try {\n      const result = await updateSettings({ taxProfile: draftProfile });\n      if (result.success) {\n        toast({\n          title: t(\"toast.success\", { ns: \"common\" }),\n          description: t(\"taxBilling.notifications.saved\", { ns: \"forms\" }),\n        });\n        setErrors({});\n      } else {\n        toast({\n          title: t(\"toast.error\", { ns: \"common\" }),\n          description: t(\"taxBilling.notifications.saveFailed\", { ns: \"forms\" }),\n          variant: \"destructive\",\n        });\n      }\n    } catch (error: any) {\n      toast({\n        title: t(\"toast.error\", { ns: \"common\" }),\n        description: error?.message ?? t(\"taxBilling.notifications.saveFailed\", { ns: \"forms\" }),\n        variant: \"destructive\",\n      });\n    } finally {\n      setSaving(false);\n    }\n  }, [draftProfile, toast, t, updateSettings, validate]);\n\n  return (\n    <SettingsPageWrapper>\n      <div className=\"space-y-6\">\n        <TaxBillingSection\n          profile={formState}\n          errors={errors}\n          dirty={isDirty}\n          loading={loading}\n          saving={saving}\n          onChange={handleChange}\n          onSave={handleSave}\n          onReset={handleReset}\n        />\n      </div>\n    </SettingsPageWrapper>\n  );\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Contracts.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/DangerZone.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/General.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Leads.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Notifications.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Profile.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Projects.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/Services.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Account_old.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Billing.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Contracts.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[472,475],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[472,475],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { ReactNode } from \"react\";\nimport { render, screen } from \"@/utils/testUtils\";\nimport Contracts from \"../Contracts\";\nconst mockHeader = jest.fn();\n\njest.mock(\"@/components/settings/SettingsPageWrapper\", () => ({\n  __esModule: true,\n  default: ({ children }: { children: ReactNode }) => (\n    <div data-testid=\"settings-page-wrapper\">{children}</div>\n  ),\n}));\n\njest.mock(\"@/components/settings/SettingsHeader\", () => ({\n  __esModule: true,\n  default: (props: any) => {\n    mockHeader(props);\n    return null;\n  },\n}));\n\njest.mock(\"react-i18next\", () => ({\n  useTranslation: () => ({\n    t: (key: string) => key,\n  }),\n}));\n\ndescribe(\"Contracts settings page\", () => {\n  beforeEach(() => {\n    mockHeader.mockClear();\n  });\n\n  it(\"renders the contracts content\", () => {\n    render(<Contracts />);\n\n    expect(screen.getByTestId(\"settings-page-wrapper\")).toBeInTheDocument();\n    expect(screen.getByText(\"settings.contracts.comingSoon\")).toBeInTheDocument();\n  });\n\n  it(\"does not render the legacy header\", () => {\n    render(<Contracts />);\n    expect(mockHeader).not.toHaveBeenCalled();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/DangerZone.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/General.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Leads.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":15,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":15,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[464,467],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[464,467],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { ReactNode } from \"react\";\nimport { render, screen } from \"@/utils/testUtils\";\nimport Leads from \"../Leads\";\nconst mockHeader = jest.fn();\n\njest.mock(\"@/components/settings/SettingsPageWrapper\", () => ({\n  __esModule: true,\n  default: ({ children }: { children: ReactNode }) => (\n    <div data-testid=\"settings-page-wrapper\">{children}</div>\n  ),\n}));\n\njest.mock(\"@/components/settings/SettingsHeader\", () => ({\n  __esModule: true,\n  default: (props: any) => {\n    mockHeader(props);\n    return null;\n  },\n}));\n\njest.mock(\"@/components/LeadStatusesSection\", () => ({\n  __esModule: true,\n  default: () => <section data-testid=\"lead-statuses-section\">lead statuses</section>,\n}));\n\njest.mock(\"@/components/LeadFieldsSection\", () => ({\n  __esModule: true,\n  LeadFieldsSection: () => <section data-testid=\"lead-fields-section\">lead fields</section>,\n}));\n\njest.mock(\"react-i18next\", () => ({\n  useTranslation: () => ({\n    t: (key: string) => key,\n  }),\n}));\n\ndescribe(\"Leads settings page\", () => {\n  beforeEach(() => {\n    mockHeader.mockClear();\n  });\n\n  it(\"renders both lead settings sections\", () => {\n    render(<Leads />);\n\n    expect(screen.getByTestId(\"lead-statuses-section\")).toBeInTheDocument();\n    expect(screen.getByTestId(\"lead-fields-section\")).toBeInTheDocument();\n  });\n\n  it(\"does not render the legacy header\", () => {\n    render(<Leads />);\n    expect(mockHeader).not.toHaveBeenCalled();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Notifications.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Profile.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Projects.test.tsx","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":14,"column":20,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":14,"endColumn":23,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[356,359],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[356,359],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from \"react\";\nimport { render, screen } from \"@/utils/testUtils\";\nimport Projects from \"../Projects\";\nconst mockSettingsHeader = jest.fn();\n\njest.mock(\"react-i18next\", () => ({\n  useTranslation: () => ({\n    t: (key: string) => key,\n  }),\n}));\n\njest.mock(\"@/components/settings/SettingsHeader\", () => ({\n  __esModule: true,\n  default: (props: any) => {\n    mockSettingsHeader(props);\n    return null;\n  },\n}));\n\njest.mock(\"@/components/settings/SettingsPageWrapper\", () => ({\n  __esModule: true,\n  default: ({ children }: { children: React.ReactNode }) => (\n    <div data-testid=\"settings-page-wrapper\">{children}</div>\n  ),\n}));\n\njest.mock(\"@/components/ProjectStatusesSection\", () => ({\n  __esModule: true,\n  default: () => <div data-testid=\"project-statuses-section\" />,\n}));\n\njest.mock(\"@/components/ProjectTypesSection\", () => ({\n  __esModule: true,\n  default: () => <div data-testid=\"project-types-section\" />,\n}));\n\njest.mock(\"@/components/SessionStatusesSection\", () => ({\n  __esModule: true,\n  default: () => <div data-testid=\"session-statuses-section\" />,\n}));\n\ndescribe(\"Projects settings page\", () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it(\"renders all project-related settings sections\", () => {\n    render(<Projects />);\n\n    expect(screen.getByTestId(\"settings-page-wrapper\")).toBeInTheDocument();\n    expect(screen.getByTestId(\"project-statuses-section\")).toBeInTheDocument();\n    expect(screen.getByTestId(\"project-types-section\")).toBeInTheDocument();\n    expect(screen.getByTestId(\"session-statuses-section\")).toBeInTheDocument();\n\n    expect(mockSettingsHeader).not.toHaveBeenCalled();\n  });\n});\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/pages/settings/__tests__/Services.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/BaseEntityService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/LeadDetailService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/LeadService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/ProjectService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/SessionService.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/__tests__/BaseEntityService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/__tests__/LeadDetailService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/__tests__/LeadService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/__tests__/ProjectService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/services/__tests__/SessionService.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/setupTests.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/theme/settingsTokens.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/theme/tokens.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/types/leadFields.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/types/serviceLineItems.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/types/template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/types/templateBuilder.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/types/workflow.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/types/xlsx.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/authUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/authUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/entityUtils.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/entityUtils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/onboardingCleanup.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/onboardingCleanup.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/onboardingValidation.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/onboardingValidation.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/performance.test.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/performance.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/utils/testUtils.tsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":1,"message":"This rule can't verify that `export *` only exports components.","line":37,"column":1,"nodeType":"ExportAllDeclaration","messageId":"exportAll","endLine":37,"endColumn":40}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React from 'react';\nimport { render, RenderOptions } from '@testing-library/react';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { BrowserRouter } from 'react-router-dom';\nimport { ThemeProvider } from 'next-themes';\n\nconst createProvidersWrapper = () => {\n  const queryClient = new QueryClient({\n    defaultOptions: {\n      queries: {\n        retry: false,\n      },\n    },\n  });\n\n  return function ProvidersWrapper({ children }: { children: React.ReactNode }) {\n    return (\n      <QueryClientProvider client={queryClient}>\n        <BrowserRouter>\n          <ThemeProvider attribute=\"class\" defaultTheme=\"system\" enableSystem>\n            {children}\n          </ThemeProvider>\n        </BrowserRouter>\n      </QueryClientProvider>\n    );\n  };\n};\n\nconst customRender = (\n  ui: React.ReactElement,\n  options?: Omit<RenderOptions, 'wrapper'>\n) => {\n  const Wrapper = createProvidersWrapper();\n  return render(ui, { wrapper: Wrapper, ...options });\n};\n\nexport * from '@testing-library/react';\nexport { customRender as render };\n\n// Mock Supabase client for testing\nexport const mockSupabaseClient = {\n  from: jest.fn(() => ({\n    select: jest.fn().mockReturnThis(),\n    insert: jest.fn().mockReturnThis(),\n    update: jest.fn().mockReturnThis(),\n    delete: jest.fn().mockReturnThis(),\n    eq: jest.fn().mockReturnThis(),\n    in: jest.fn().mockReturnThis(),\n    order: jest.fn().mockReturnThis(),\n    limit: jest.fn().mockReturnThis(),\n    single: jest.fn(),\n  })),\n  auth: {\n    getUser: jest.fn(),\n    signIn: jest.fn(),\n    signOut: jest.fn(),\n  },\n  rpc: jest.fn(),\n};\n\n// Performance testing utilities\nexport const measureRenderTime = (component: React.ReactElement) => {\n  const start = performance.now();\n  const result = render(component);\n  const end = performance.now();\n  \n  return {\n    ...result,\n    renderTime: end - start\n  };\n};\n\n// Accessibility testing helpers\nexport const setupAxeMatchers = () => {\n  // This would integrate with @axe-core/react in a real implementation\n  // For now, we'll just export a placeholder\n  return {\n    toHaveNoViolations: () => true\n  };\n};\n\n// Component testing utilities\nexport const createMockProps = <T extends object>(overrides: Partial<T> = {}): T => {\n  const defaultProps = {\n    onClick: jest.fn(),\n    onSubmit: jest.fn(),\n    onChange: jest.fn(),\n    loading: false,\n    disabled: false,\n    ...overrides\n  };\n  \n  return defaultProps as T;\n};\n\n// Mock data generators\nexport const generateMockProject = (overrides = {}) => ({\n  id: 'project-1',\n  name: 'Test Project',\n  description: 'Test Description',\n  status_id: 'status-1',\n  lead_id: 'lead-1',\n  user_id: 'user-1',\n  created_at: new Date().toISOString(),\n  updated_at: new Date().toISOString(),\n  lead: {\n    id: 'lead-1',\n    name: 'Test Client',\n    status: 'active',\n    email: 'test@example.com',\n    phone: '+1234567890'\n  },\n  project_type: {\n    id: 'type-1',\n    name: 'Wedding'\n  },\n  session_count: 0,\n  todo_count: 0,\n  completed_todo_count: 0,\n  ...overrides\n});\n\nexport const generateMockLead = (overrides = {}) => ({\n  id: 'lead-1',\n  name: 'Test Lead',\n  email: 'test@example.com',\n  phone: '+1234567890',\n  status: 'active',\n  status_id: 'status-1',\n  user_id: 'user-1',\n  created_at: new Date().toISOString(),\n  updated_at: new Date().toISOString(),\n  ...overrides\n});\n\n// Performance test helpers\nexport const expectPerformantRender = (renderTime: number, threshold: number = 50) => {\n  if (renderTime >= threshold) {\n    throw new Error(`Render time ${renderTime}ms exceeded threshold ${threshold}ms`);\n  }\n};\n\n// Async test utilities\nexport const waitForLoadingToFinish = () => {\n  return new Promise(resolve => setTimeout(resolve, 0));\n};\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/src/vite-env.d.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/_shared/email-i18n.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/_shared/error-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/_shared/resend-utils.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/get-users-email/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/notification-processor/_templates/enhanced-daily-summary-empty.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/notification-processor/_templates/enhanced-daily-summary-modern.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/notification-processor/_templates/enhanced-email-base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/notification-processor/_templates/immediate-notifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/notification-processor/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/process-session-reminders/index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":50,"column":59,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":50,"endColumn":62,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[1516,1519],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[1516,1519],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { serve } from \"https://deno.land/std@0.190.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.39.3\";\nimport {\n  getErrorMessage,\n  getErrorStack,\n} from \"../_shared/error-utils.ts\";\n\nexport const corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n};\n\nexport const handler = async (req: Request): Promise<Response> => {\n  console.log('Session reminders processor started');\n\n  if (req.method === 'OPTIONS') {\n    return new Response(null, { headers: corsHeaders });\n  }\n\n  const adminSupabase = createClient(\n    Deno.env.get('SUPABASE_URL') ?? '',\n    Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? ''\n  );\n\n  try {\n    const processedReminders = await processScheduledReminders(adminSupabase);\n\n    return new Response(JSON.stringify({\n      success: true,\n      processed_reminders: processedReminders,\n      processed_at: new Date().toISOString()\n    }), {\n      status: 200,\n      headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n    });\n\n  } catch (error: unknown) {\n    console.error('Error processing session reminders:', error);\n    return new Response(JSON.stringify({\n      error: getErrorMessage(error),\n      stack: getErrorStack(error),\n      timestamp: new Date().toISOString()\n    }), {\n      status: 500,\n      headers: { ...corsHeaders, 'Content-Type': 'application/json' },\n    });\n  }\n};\n\nexport async function processScheduledReminders(supabase: any) {\n  console.log('Processing scheduled session reminders');\n\n  // Get reminders that are due to be sent (exact timing, no early processing buffer)\n  const now = new Date();\n\n  console.log(`Processing reminders scheduled at or before: ${now.toISOString()}`);\n\n  const { data: dueReminders, error: fetchError } = await supabase\n    .from('scheduled_session_reminders')\n    .select(`\n      *,\n      sessions!fk_scheduled_session_reminders_session_id (\n        id,\n        session_date,\n        session_time,\n        session_type_id,\n        session_types:session_type_id (\n          id,\n          name,\n          duration_minutes\n        ),\n        location,\n        notes,\n        organization_id,\n        leads!inner (\n          id,\n          name,\n          email,\n          phone,\n          organization_id\n        )\n      ),\n      workflows!fk_scheduled_session_reminders_workflow_id (\n        id,\n        name,\n        organization_id\n      )\n    `)\n    .eq('status', 'pending')\n    .lte('scheduled_for', now.toISOString())\n    .order('scheduled_for');\n\n  if (fetchError) {\n    console.error('Error fetching due reminders:', fetchError);\n    throw fetchError;\n  }\n\n  if (!dueReminders || dueReminders.length === 0) {\n    console.log('No reminders due for processing');\n    return { processed: 0, triggered: 0, failed: 0 };\n  }\n\n  console.log(`Found ${dueReminders.length} reminders due for processing`);\n\n  let processed = 0;\n  let triggered = 0;\n  let failed = 0;\n\n  // Process each reminder\n  for (const reminder of dueReminders) {\n    try {\n      console.log(`Processing reminder ${reminder.id} for session ${reminder.session_id}, type: ${reminder.reminder_type}`);\n      \n      // Verify session data before processing\n      if (!reminder.sessions || !reminder.sessions.leads) {\n        console.error(`Invalid session or lead data for reminder ${reminder.id}`);\n        await supabase\n          .from('scheduled_session_reminders')\n          .update({ \n            status: 'failed',\n            error_message: 'Invalid session or lead data',\n            processed_at: new Date().toISOString()\n          })\n          .eq('id', reminder.id);\n        failed++;\n        processed++;\n        continue;\n      }\n\n      console.log(\n        `Session data: ${reminder.sessions.session_date} ${reminder.sessions.session_time}, Lead: ${reminder.sessions.leads.name}`,\n      );\n\n      // Mark reminder as being processed first to prevent duplicate processing\n      const { error: updateError } = await supabase\n        .from('scheduled_session_reminders')\n        .update({ \n          status: 'sent',\n          processed_at: new Date().toISOString()\n        })\n        .eq('id', reminder.id)\n        .eq('status', 'pending'); // Only update if still pending\n\n      if (updateError) {\n        console.error(`Error updating reminder ${reminder.id}:`, updateError);\n        failed++;\n        processed++;\n        continue;\n      }\n\n      // Trigger the workflow executor for this session reminder with explicit session validation\n      console.log(`Triggering workflow for session ${reminder.session_id} (${reminder.sessions.session_date} ${reminder.sessions.session_time})`);\n      console.log(`Processing reminder type: ${reminder.reminder_type} scheduled for: ${reminder.scheduled_for}`);\n      console.log(`Current time: ${now.toISOString()}, Reminder due: ${reminder.scheduled_for}`);\n      \n      const { error: triggerError } = await supabase.functions.invoke('workflow-executor', {\n        body: {\n          action: 'trigger',\n          trigger_type: 'session_reminder',\n          trigger_entity_type: 'session',\n          trigger_entity_id: reminder.session_id, // This MUST match the session in the reminder\n          organization_id: reminder.organization_id,\n          trigger_data: {\n            reminder_type: reminder.reminder_type,\n            // Pass the exact session data we retrieved to ensure consistency\n            session_data: {\n              id: reminder.sessions.id,\n              session_date: reminder.sessions.session_date,\n              session_time: reminder.sessions.session_time,\n              location: reminder.sessions.location,\n              notes: reminder.sessions.notes,\n              session_type_id: reminder.sessions.session_type_id,\n              session_type_name: reminder.sessions.session_types?.name ?? null,\n              session_type_duration_minutes: reminder.sessions.session_types?.duration_minutes ?? null\n            },\n            lead_data: {\n              id: reminder.sessions.leads.id,\n              name: reminder.sessions.leads.name,\n              email: reminder.sessions.leads.email,\n              phone: reminder.sessions.leads.phone\n            },\n            scheduled_reminder_id: reminder.id,\n            workflow_id: reminder.workflow_id,\n            // Add debug info to ensure correct session is used\n            debug_session_validation: {\n              expected_session_id: reminder.session_id,\n              actual_session_date: reminder.sessions.session_date,\n              actual_session_time: reminder.sessions.session_time,\n              lead_name: reminder.sessions.leads.name,\n              reminder_type: reminder.reminder_type,\n              scheduled_for: reminder.scheduled_for\n            }\n          }\n        }\n      });\n\n      if (triggerError) {\n        const triggerErrorMessage = getErrorMessage(triggerError);\n        console.error(`Error triggering workflow for reminder ${reminder.id}:`, triggerError);\n        \n        // Mark reminder as failed and record error\n        await supabase\n          .from('scheduled_session_reminders')\n          .update({ \n            status: 'failed',\n            error_message: triggerErrorMessage,\n            processed_at: new Date().toISOString()\n          })\n          .eq('id', reminder.id);\n        \n        failed++;\n      } else {\n        console.log(`Successfully triggered workflow for reminder ${reminder.id}`);\n        triggered++;\n      }\n\n      processed++;\n\n    } catch (error) {\n      console.error(`Error processing reminder ${reminder.id}:`, error);\n      \n      // Mark reminder as failed\n      try {\n        await supabase\n          .from('scheduled_session_reminders')\n          .update({ \n            status: 'failed',\n            error_message: getErrorMessage(error),\n            processed_at: new Date().toISOString()\n          })\n          .eq('id', reminder.id);\n      } catch (updateError) {\n        console.error(`Failed to update reminder ${reminder.id} status:`, updateError);\n      }\n      \n      failed++;\n      processed++;\n    }\n  }\n\n  // Clean up old reminders\n  try {\n    const { data: cleanupResult, error: cleanupError } = await supabase.rpc('cleanup_old_session_reminders');\n    if (cleanupError) {\n      console.error('Error during cleanup:', cleanupError);\n    } else {\n      console.log(`Cleaned up ${cleanupResult || 0} old reminders`);\n    }\n  } catch (cleanupError) {\n    console.error('Cleanup failed:', cleanupError);\n  }\n\n  console.log(`Processed ${processed} reminders: ${triggered} triggered, ${failed} failed`);\n  \n  return { processed, triggered, failed };\n}\n\nserve(handler);\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/schedule-daily-notifications/index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":11,"column":24,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":11,"endColumn":27,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[414,417],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[414,417],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { serve } from \"https://deno.land/std@0.190.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.50.0\";\nimport { getErrorMessage } from \"../_shared/error-utils.ts\";\n\nconst corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey, content-type',\n};\n\ninterface SupabaseClientLike {\n  from(table: string): any;\n  functions: {\n    invoke(name: string, options: { body: Record<string, unknown> }): Promise<{ data?: unknown; error?: Error | null }>;\n  };\n}\n\ninterface HandlerDependencies {\n  createClient?: () => SupabaseClientLike;\n  getNow?: () => Date;\n}\n\nfunction createSupabaseClient(): SupabaseClientLike {\n  return createClient(\n    Deno.env.get('SUPABASE_URL') ?? '',\n    Deno.env.get('SUPABASE_SERVICE_ROLE_KEY') ?? '',\n  ) as unknown as SupabaseClientLike;\n}\n\nexport const handler = async (\n  req: Request,\n  deps: HandlerDependencies = {},\n): Promise<Response> => {\n  if (req.method === 'OPTIONS') {\n    return new Response(null, { headers: corsHeaders });\n  }\n\n  console.log('Daily notification scheduler started');\n\n  const createClientFn = deps.createClient ?? createSupabaseClient;\n  const getNow = deps.getNow ?? (() => new Date());\n\n  try {\n    const supabase = createClientFn();\n\n    const now = getNow();\n    const currentTime = `${now.getUTCHours().toString().padStart(2, '0')}:${now.getUTCMinutes().toString().padStart(2, '0')}`;\n\n    console.log(`Current time: ${currentTime}`);\n\n    const { data: userSettings, error: userError } = await supabase\n      .from('user_settings')\n      .select(`\n        user_id,\n        active_organization_id,\n        notification_scheduled_time\n      `)\n      .eq('notification_global_enabled', true)\n      .eq('notification_daily_summary_enabled', true)\n      .eq('notification_scheduled_time', currentTime)\n      .not('active_organization_id', 'is', null);\n\n    if (userError) {\n      console.error('Error fetching user settings:', userError);\n      throw userError;\n    }\n\n    console.log(`Found ${userSettings?.length || 0} user settings to process`);\n\n    if (!userSettings || userSettings.length === 0) {\n      return new Response(JSON.stringify({\n        success: true,\n        message: `No users scheduled for ${currentTime}`,\n        processed: 0,\n      }), {\n        status: 200,\n        headers: { 'Content-Type': 'application/json', ...corsHeaders },\n      });\n    }\n\n    const userSettingsList = (userSettings ?? []) as Array<{\n      user_id: string;\n      active_organization_id: string;\n      notification_scheduled_time: string;\n    }>;\n\n    const orgIds = [...new Set(userSettingsList.map((u) => u.active_organization_id))];\n    const { data: orgs, error: orgDetailsError } = await supabase\n      .from('organizations')\n      .select('id, owner_id, name')\n      .in('id', orgIds);\n\n    if (orgDetailsError) {\n      console.error('Error fetching organization details:', orgDetailsError);\n      throw orgDetailsError;\n    }\n\n    console.log(`Found ${orgs?.length || 0} organizations to process`);\n\n    const today = now.toISOString().split('T')[0];\n    const scheduledFor = now.toISOString();\n    const notifications: Array<Record<string, unknown>> = [];\n\n    const orgsList = (orgs ?? []) as Array<{ id: string; owner_id: string; name: string }>;\n\n    for (const userSetting of userSettingsList) {\n      const org = orgsList.find((o) => o.id === userSetting.active_organization_id);\n      if (!org) {\n        console.log(`Organization ${userSetting.active_organization_id} not found`);\n        continue;\n      }\n\n      const { data: existingNotification } = await supabase\n        .from('notifications')\n        .select('id')\n        .eq('organization_id', org.id)\n        .eq('user_id', userSetting.user_id)\n        .eq('notification_type', 'daily-summary')\n        .gte('created_at', `${today}T00:00:00Z`)\n        .lt('created_at', `${today}T23:59:59Z`)\n        .maybeSingle();\n\n      if (existingNotification) {\n        console.log(`Daily summary already exists for user ${userSetting.user_id} in organization ${org.id}`);\n        continue;\n      }\n\n      notifications.push({\n        organization_id: org.id,\n        user_id: userSetting.user_id,\n        notification_type: 'daily-summary',\n        delivery_method: 'scheduled',\n        scheduled_for: scheduledFor,\n        metadata: {\n          date: today,\n          organization_name: org.name,\n        },\n        status: 'pending',\n      });\n    }\n\n    if (notifications.length > 0) {\n      const { error: insertError } = await supabase\n        .from('notifications')\n        .insert(notifications);\n\n      if (insertError) {\n        console.error('Error inserting notifications:', insertError);\n        throw insertError;\n      }\n\n      console.log(`Created ${notifications.length} daily summary notifications`);\n\n      try {\n        const { error: processorError } = await supabase.functions.invoke('notification-processor', {\n          body: { action: 'process-pending' },\n        });\n\n        if (processorError) {\n          console.error('Error triggering notification processor:', processorError);\n        } else {\n          console.log('Successfully triggered notification processor');\n        }\n      } catch (processorError) {\n        console.error('Failed to trigger notification processor:', processorError);\n      }\n    }\n\n    return new Response(JSON.stringify({\n      success: true,\n      processed: notifications.length,\n      users: userSettingsList.map((u) => u.user_id),\n    }), {\n      status: 200,\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\n    });\n  } catch (error: unknown) {\n    console.error('Error in schedule-daily-notifications:', error);\n    return new Response(JSON.stringify({\n      error: getErrorMessage(error),\n      success: false,\n    }), {\n      status: 500,\n      headers: { 'Content-Type': 'application/json', ...corsHeaders },\n    });\n  }\n};\n\nif (import.meta.main) {\n  serve((req: Request) => handler(req));\n}\n\nexport { corsHeaders };\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/daily-summary-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/delivery-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/email-base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-daily-summary-empty.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-daily-summary-modern.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-daily-summary-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-email-base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-milestone-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-overdue-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-session-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/enhanced-task-nudge-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/immediate-notifications.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/overdue-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/session-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/simplified-daily-summary-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/simplified-weekly-recap-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/task-nudge-template.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/_templates/weekly-recap-template.ts","messages":[{"ruleId":"prefer-const","severity":2,"message":"'insights' is never reassigned. Use 'const' instead.","line":186,"column":7,"nodeType":"Identifier","messageId":"useConst","endLine":186,"endColumn":15,"fix":{"range":[8144,8162],"text":"const insights = [];"}}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":1,"fixableWarningCount":0,"source":"import { createEmailTemplate, EmailTemplateData, Lead, Project, Session, formatDate, formatDateTime } from './enhanced-email-base.ts';\n\nexport interface WeeklyStats {\n  leadsAdded: number;\n  leadsConverted: number;\n  leadsLost: number;\n  projectsCreated: number;\n  projectsCompleted: number;\n  sessionsCompleted: number;\n  sessionsScheduled: number;\n  totalRevenue: number;\n  recentLeads: Lead[];\n  recentProjects: Project[];\n  upcomingSessions: Session[];\n}\n\nexport function generateWeeklyRecapEmail(stats: WeeklyStats, templateData: EmailTemplateData): string {\n  const weekStart = new Date();\n  weekStart.setDate(weekStart.getDate() - 7);\n  const weekStartFormatted = formatDate(weekStart.toISOString(), templateData.dateFormat);\n  const todayFormatted = formatDate(new Date().toISOString(), templateData.dateFormat);\n\n  let content = `\n    <div class=\"summary-stats\">\n      <div class=\"stat-item\">\n        <span class=\"stat-number\">${stats.leadsAdded}</span>\n        <div class=\"stat-label\">New Leads</div>\n      </div>\n      <div class=\"stat-item\">\n        <span class=\"stat-number\">${stats.projectsCreated}</span>\n        <div class=\"stat-label\">New Projects</div>\n      </div>\n      <div class=\"stat-item\">\n        <span class=\"stat-number\">${stats.sessionsCompleted}</span>\n        <div class=\"stat-label\">Sessions Completed</div>\n      </div>\n      <div class=\"stat-item\">\n        <span class=\"stat-number\">$${stats.totalRevenue.toLocaleString()}</span>\n        <div class=\"stat-label\">Revenue Generated</div>\n      </div>\n    </div>\n    \n    <p>Here's your weekly photography business recap from <strong>${weekStartFormatted}</strong> to <strong>${todayFormatted}</strong>:</p>\n  `;\n\n  // Lead Performance\n  content += `\n    <h3 class=\"section-title\">📈 Lead Performance This Week</h3>\n    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 20px;\">\n      <div style=\"background-color: #F0FDF4; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #22C55E;\">${stats.leadsAdded}</div>\n        <div style=\"font-size: 14px; color: #059669;\">New Leads Added</div>\n      </div>\n      <div style=\"background-color: #EFF6FF; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #3B82F6;\">${stats.leadsConverted}</div>\n        <div style=\"font-size: 14px; color: #1D4ED8;\">Leads Converted</div>\n      </div>\n      <div style=\"background-color: #FEF2F2; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #EF4444;\">${stats.leadsLost}</div>\n        <div style=\"font-size: 14px; color: #DC2626;\">Leads Lost</div>\n      </div>\n    </div>\n  `;\n\n  // Conversion Rate\n  const conversionRate = stats.leadsAdded > 0 ? ((stats.leadsConverted / stats.leadsAdded) * 100).toFixed(1) : '0';\n  content += `\n    <div style=\"background-color: #FFFBEB; padding: 16px; border-radius: 8px; margin-bottom: 20px;\">\n      <div style=\"font-size: 18px; font-weight: 600; color: #92400E; margin-bottom: 8px;\">\n        📊 Conversion Rate: ${conversionRate}%\n      </div>\n      <div style=\"font-size: 14px; color: #B45309;\">\n        ${stats.leadsConverted} out of ${stats.leadsAdded} new leads converted to projects this week.\n      </div>\n    </div>\n  `;\n\n  // Recent Leads\n  if (stats.recentLeads.length > 0) {\n    content += `\n      <h3 class=\"section-title\">🎯 Recent Leads (${stats.recentLeads.length})</h3>\n    `;\n\n    stats.recentLeads.slice(0, 5).forEach(lead => {\n      content += `\n        <div class=\"item-card\">\n          <div class=\"item-title\">\n            <span>${lead.name}</span>\n            <span class=\"upcoming-badge\">${lead.status || 'New'}</span>\n          </div>\n          ${lead.email ? `<div class=\"item-meta\">📧 ${lead.email}</div>` : ''}\n          ${lead.phone ? `<div class=\"item-meta\">📞 ${lead.phone}</div>` : ''}\n          <div style=\"margin-top: 12px;\">\n            ${templateData.baseUrl ? `<a href=\"${templateData.baseUrl}/leads/${lead.id}\" class=\"item-action\">View Lead</a>` : ''}\n          </div>\n        </div>\n      `;\n    });\n  }\n\n  // Project Updates\n  content += `\n    <h3 class=\"section-title\">🎨 Project Updates</h3>\n    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 20px;\">\n      <div style=\"background-color: #F0F9FF; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #0EA5E9;\">${stats.projectsCreated}</div>\n        <div style=\"font-size: 14px; color: #0284C7;\">New Projects</div>\n      </div>\n      <div style=\"background-color: #F0FDF4; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #22C55E;\">${stats.projectsCompleted}</div>\n        <div style=\"font-size: 14px; color: #059669;\">Projects Completed</div>\n      </div>\n    </div>\n  `;\n\n  // Session Activity\n  content += `\n    <h3 class=\"section-title\">📸 Session Activity</h3>\n    <div style=\"display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 16px; margin-bottom: 20px;\">\n      <div style=\"background-color: #F3E8FF; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #9333EA;\">${stats.sessionsCompleted}</div>\n        <div style=\"font-size: 14px; color: #7C3AED;\">Sessions Completed</div>\n      </div>\n      <div style=\"background-color: #FEF3C7; padding: 16px; border-radius: 8px; text-align: center;\">\n        <div style=\"font-size: 24px; font-weight: bold; color: #F59E0B;\">${stats.sessionsScheduled}</div>\n        <div style=\"font-size: 14px; color: #D97706;\">Sessions Scheduled</div>\n      </div>\n    </div>\n  `;\n\n  // Upcoming Sessions Preview\n  if (stats.upcomingSessions.length > 0) {\n    content += `\n      <h3 class=\"section-title\">📅 Next Week's Sessions Preview (${stats.upcomingSessions.length})</h3>\n    `;\n\n    stats.upcomingSessions.slice(0, 3).forEach(session => {\n      const sessionTime = formatDateTime(session.session_date, session.session_time, templateData);\n      content += `\n        <div class=\"item-card\">\n          <div class=\"item-title\">\n            <span>Photography Session</span>\n            <span class=\"upcoming-badge\">Upcoming</span>\n          </div>\n          <div class=\"item-meta\">📅 ${sessionTime}</div>\n          ${session.leads ? `<div class=\"item-meta\">👤 Client: ${session.leads.name}</div>` : ''}\n          ${session.projects ? `<div class=\"item-relationship\">Project: ${session.projects.name}</div>` : ''}\n        </div>\n      `;\n    });\n\n    if (stats.upcomingSessions.length > 3) {\n      content += `\n        <p style=\"font-style: italic; color: #6B7280;\">\n          ... and ${stats.upcomingSessions.length - 3} more sessions next week\n        </p>\n      `;\n    }\n  }\n\n  // Revenue Summary\n  if (stats.totalRevenue > 0) {\n    content += `\n      <div style=\"background-color: #F0FDF4; padding: 20px; border-radius: 8px; margin: 24px 0; border-left: 4px solid #22C55E;\">\n        <div style=\"font-size: 20px; font-weight: 600; color: #059669; margin-bottom: 8px;\">\n          💰 Revenue This Week: $${stats.totalRevenue.toLocaleString()}\n        </div>\n        <div style=\"font-size: 14px; color: #065F46;\">\n          Great work! Your photography business generated $${stats.totalRevenue.toLocaleString()} in revenue this week.\n        </div>\n      </div>\n    `;\n  }\n\n  // Action Items and Goals\n  content += `\n    <div class=\"inline-buttons\">\n      ${templateData.baseUrl ? `<a href=\"${templateData.baseUrl}/dashboard\" class=\"cta-button\">Dashboard</a>` : ''}\n      ${templateData.baseUrl ? `<a href=\"${templateData.baseUrl}/leads\" class=\"cta-button\">Manage Leads</a>` : ''}\n      ${templateData.baseUrl ? `<a href=\"${templateData.baseUrl}/projects\" class=\"cta-button\">View Projects</a>` : ''}\n      ${templateData.baseUrl ? `<a href=\"${templateData.baseUrl}/analytics\" class=\"cta-button\">Analytics</a>` : ''}\n    </div>\n  `;\n\n  // Weekly Insights\n  let insights = [];\n  if (stats.leadsAdded > stats.leadsConverted && stats.leadsConverted > 0) {\n    insights.push(\"Consider following up with unconverted leads - they might just need a little more nurturing.\");\n  }\n  if (stats.sessionsCompleted > 0) {\n    insights.push(\"Great job completing sessions this week! Don't forget to follow up with delivery timelines.\");\n  }\n  if (stats.projectsCreated > stats.projectsCompleted) {\n    insights.push(\"You have new projects in the pipeline - make sure to plan your workflow efficiently.\");\n  }\n  if (parseFloat(conversionRate) > 20) {\n    insights.push(\"Excellent conversion rate! Your lead qualification process is working well.\");\n  }\n\n  if (insights.length > 0) {\n    content += `\n      <div style=\"margin-top: 24px; padding: 20px; background-color: #EFF6FF; border-radius: 8px; border-left: 4px solid #3B82F6;\">\n        <div style=\"font-size: 16px; font-weight: 600; color: #1E40AF; margin-bottom: 12px;\">\n          💡 Weekly Insights\n        </div>\n        <ul style=\"margin: 0; padding-left: 20px; color: #1E3A8A;\">\n          ${insights.map(insight => `<li style=\"margin-bottom: 8px;\">${insight}</li>`).join('')}\n        </ul>\n      </div>\n    `;\n  }\n\n  // Motivational close\n  const motivationalMessages = [\n    \"Keep up the amazing work! Your dedication to your craft shows in these results. 🌟\",\n    \"Another successful week in the books! Your photography business is thriving. 📸\",\n    \"Progress is progress, no matter how small. Every week brings new opportunities! 🚀\",\n    \"Your passion for photography is building a successful business. Keep going! 💪\",\n    \"Each client you serve and each photo you take is building your legacy. Amazing work! ✨\"\n  ];\n  const randomMessage = motivationalMessages[Math.floor(Math.random() * motivationalMessages.length)];\n\n  content += `\n    <div style=\"margin-top: 24px; padding: 16px; background-color: #F8FAFC; border-radius: 8px; text-align: center;\">\n      <p style=\"margin: 0; font-style: italic; color: #475569; font-size: 16px;\">\n        ${randomMessage}\n      </p>\n    </div>\n  `;\n\n  return createEmailTemplate(\n    `Weekly Business Recap - ${weekStartFormatted} to ${todayFormatted}`,\n    content,\n    templateData\n  );\n}","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-reminder-notifications/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/send-template-email/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/session-types-delete/index.ts","messages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":24,"column":45,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":24,"endColumn":48,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[807,810],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[807,810],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { serve } from \"https://deno.land/std@0.224.0/http/server.ts\";\nimport { createClient } from \"https://esm.sh/@supabase/supabase-js@2.53.0\";\n\nconst corsHeaders = {\n  \"Access-Control-Allow-Origin\": \"*\",\n  \"Access-Control-Allow-Headers\": \"authorization, x-client-info, apikey, content-type\",\n};\n\nconst supabaseUrl = Deno.env.get(\"SUPABASE_URL\");\nconst supabaseServiceKey = Deno.env.get(\"SUPABASE_SERVICE_ROLE_KEY\");\n\nif (!supabaseUrl || !supabaseServiceKey) {\n  console.error(\"Missing Supabase environment configuration for session-types-delete function.\");\n}\n\nexport const SESSION_TYPE_IN_USE_CODE = \"SESSION_TYPE_IN_USE\";\n\nexport interface DeleteSessionTypeResult {\n  status: number;\n  message?: string;\n}\n\nexport async function deleteSessionTypeWithClient(\n  client: ReturnType<typeof createClient> | any,\n  sessionTypeId: string | undefined\n): Promise<DeleteSessionTypeResult> {\n  if (!sessionTypeId || typeof sessionTypeId !== \"string\" || sessionTypeId.trim().length === 0) {\n    return { status: 400, message: \"invalid_session_type_id\" };\n  }\n\n  const { count, error: countError } = await client\n    .from(\"sessions\")\n    .select(\"id\", { count: \"exact\", head: true })\n    .eq(\"session_type_id\", sessionTypeId);\n\n  if (countError) {\n    const message = countError instanceof Error ? countError.message : String(countError);\n    return { status: 500, message };\n  }\n\n  if ((count ?? 0) > 0) {\n    return { status: 409, message: SESSION_TYPE_IN_USE_CODE };\n  }\n\n  const { error: deleteError } = await client\n    .from(\"session_types\")\n    .delete()\n    .eq(\"id\", sessionTypeId);\n\n  if (deleteError) {\n    const message = deleteError instanceof Error ? deleteError.message : String(deleteError);\n    return { status: 500, message };\n  }\n\n  return { status: 200 };\n}\n\nconst handler = async (req: Request): Promise<Response> => {\n  if (req.method === \"OPTIONS\") {\n    return new Response(\"ok\", { headers: corsHeaders });\n  }\n\n  try {\n    const { session_type_id: sessionTypeId } = await req.json();\n\n    const supabase = createClient(supabaseUrl!, supabaseServiceKey!, {\n      auth: { persistSession: false },\n    });\n\n    const result = await deleteSessionTypeWithClient(supabase, sessionTypeId);\n\n    if (result.status !== 200) {\n      return new Response(\n        JSON.stringify({ error: { message: result.message } }),\n        { status: result.status, headers: { \"Content-Type\": \"application/json\", ...corsHeaders } }\n      );\n    }\n\n    return new Response(JSON.stringify({ success: true }), {\n      status: 200,\n      headers: { \"Content-Type\": \"application/json\", ...corsHeaders },\n    });\n  } catch (error) {\n    console.error(\"session-types-delete error\", error);\n    const message = error instanceof Error ? error.message : String(error);\n    return new Response(\n      JSON.stringify({ error: { message } }),\n      { status: 500, headers: { \"Content-Type\": \"application/json\", ...corsHeaders } }\n    );\n  }\n};\n\nif (import.meta.main) {\n  serve(handler);\n}\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/simple-daily-notifications/_templates/enhanced-daily-summary-empty.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/simple-daily-notifications/_templates/enhanced-daily-summary-modern.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/simple-daily-notifications/_templates/enhanced-email-base.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/simple-daily-notifications/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/test-callback/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/email-i18n.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/get-users-email.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/harness_smoke.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/notification-processor.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/process-session-reminders.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/schedule-daily-notifications.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/send-reminder-notifications.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/send-template-email.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/session-types-delete.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/simple-daily-notifications.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/test-callback.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/tests/workflow-executor.test.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/supabase/functions/workflow-executor/index.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/tailwind.config.ts","messages":[{"ruleId":"@typescript-eslint/no-require-imports","severity":2,"message":"A `require()` style import is forbidden.","line":151,"column":12,"nodeType":"CallExpression","messageId":"noRequireImports","endLine":151,"endColumn":42}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import type { Config } from \"tailwindcss\";\n\nexport default {\n\tdarkMode: [\"class\"],\n\tcontent: [\n\t\t\"./pages/**/*.{ts,tsx}\",\n\t\t\"./components/**/*.{ts,tsx}\",\n\t\t\"./app/**/*.{ts,tsx}\",\n\t\t\"./src/**/*.{ts,tsx}\",\n\t],\n\tprefix: \"\",\n\ttheme: {\n\t\tcontainer: {\n\t\t\tcenter: true,\n\t\t\tpadding: '2rem',\n\t\t\tscreens: {\n\t\t\t\t'2xl': '1400px'\n\t\t\t}\n\t\t},\n\t\textend: {\n\t\t\tfontFamily: {\n\t\t\t\tsans: [\"Inter\", \"ui-sans-serif\", \"system-ui\", \"sans-serif\"],\n\t\t\t},\n\t\t\tcolors: {\n\t\t\t\tborder: 'hsl(var(--border))',\n\t\t\t\tinput: 'hsl(var(--input))',\n\t\t\t\tring: 'hsl(var(--ring))',\n\t\t\t\tbackground: 'hsl(var(--background))',\n\t\t\t\tforeground: 'hsl(var(--foreground))',\n\t\t\t\tprimary: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--primary))',\n\t\t\t\t\tforeground: 'hsl(var(--primary-foreground))'\n\t\t\t\t},\n\t\t\t\tsecondary: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--secondary))',\n\t\t\t\t\tforeground: 'hsl(var(--secondary-foreground))'\n\t\t\t\t},\n\t\t\t\tdestructive: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--destructive))',\n\t\t\t\t\tforeground: 'hsl(var(--destructive-foreground))'\n\t\t\t\t},\n\t\t\t\tmuted: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--muted))',\n\t\t\t\t\tforeground: 'hsl(var(--muted-foreground))'\n\t\t\t\t},\n\t\t\t\taccent: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--accent))',\n\t\t\t\t\tforeground: 'hsl(var(--accent-foreground))'\n\t\t\t\t},\n\t\t\t\tpopover: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--popover))',\n\t\t\t\t\tforeground: 'hsl(var(--popover-foreground))'\n\t\t\t\t},\n\t\t\t\tcard: {\n\t\t\t\t\tDEFAULT: 'hsl(var(--card))',\n\t\t\t\t\tforeground: 'hsl(var(--card-foreground))'\n\t\t\t\t},\n        sidebar: {\n          DEFAULT: 'hsl(var(--sidebar-background))',\n          foreground: 'hsl(var(--sidebar-foreground))',\n          primary: 'hsl(var(--sidebar-primary))',\n          'primary-foreground': 'hsl(var(--sidebar-primary-foreground))',\n          accent: 'hsl(var(--sidebar-accent))',\n          'accent-foreground': 'hsl(var(--sidebar-accent-foreground))',\n          active: 'hsl(var(--sidebar-active))',\n          'active-foreground': 'hsl(var(--sidebar-active-foreground))',\n          'active-icon': 'hsl(var(--sidebar-active-icon))',\n          border: 'hsl(var(--sidebar-border))',\n          ring: 'hsl(var(--sidebar-ring))'\n        },\n\t\t\t\t'status-new': {\n\t\t\t\t\tbg: 'hsl(var(--status-new-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-new-text))'\n\t\t\t\t},\n\t\t\t\t'status-contacted': {\n\t\t\t\t\tbg: 'hsl(var(--status-contacted-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-contacted-text))'\n\t\t\t\t},\n\t\t\t\t'status-qualified': {\n\t\t\t\t\tbg: 'hsl(var(--status-qualified-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-qualified-text))'\n\t\t\t\t},\n\t\t\t\t'status-proposal-sent': {\n\t\t\t\t\tbg: 'hsl(var(--status-proposal-sent-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-proposal-sent-text))'\n\t\t\t\t},\n\t\t\t\t'status-booked': {\n\t\t\t\t\tbg: 'hsl(var(--status-booked-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-booked-text))'\n\t\t\t\t},\n\t\t\t\t'status-lost': {\n\t\t\t\t\tbg: 'hsl(var(--status-lost-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-lost-text))'\n\t\t\t\t},\n\t\t\t\t'status-completed': {\n\t\t\t\t\tbg: 'hsl(var(--status-completed-bg))',\n\t\t\t\t\ttext: 'hsl(var(--status-completed-text))'\n\t\t\t\t}\n\t\t\t},\n\t\t\tborderRadius: {\n\t\t\t\tlg: 'var(--radius)',\n\t\t\t\tmd: 'calc(var(--radius) - 2px)',\n\t\t\t\tsm: 'calc(var(--radius) - 4px)'\n\t\t\t},\n\t\t\tkeyframes: {\n\t\t\t\t'accordion-down': {\n\t\t\t\t\tfrom: {\n\t\t\t\t\t\theight: '0'\n\t\t\t\t\t},\n\t\t\t\t\tto: {\n\t\t\t\t\t\theight: 'var(--radix-accordion-content-height)'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'accordion-up': {\n\t\t\t\t\tfrom: {\n\t\t\t\t\t\theight: 'var(--radix-accordion-content-height)'\n\t\t\t\t\t},\n\t\t\t\t\tto: {\n\t\t\t\t\t\theight: '0'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'slide-in-bottom': {\n\t\t\t\t\t'0%': {\n\t\t\t\t\t\ttransform: 'translateY(100%)',\n\t\t\t\t\t\topacity: '0'\n\t\t\t\t\t},\n\t\t\t\t\t'100%': {\n\t\t\t\t\t\ttransform: 'translateY(0)',\n\t\t\t\t\t\topacity: '1'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t'slide-up': {\n\t\t\t\t\t'0%': {\n\t\t\t\t\t\ttransform: 'translateY(100%)',\n\t\t\t\t\t\topacity: '0'\n\t\t\t\t\t}, \n\t\t\t\t\t'100%': {\n\t\t\t\t\t\ttransform: 'translateY(0)',\n\t\t\t\t\t\topacity: '1'\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tanimation: {\n\t\t\t\t'accordion-down': 'accordion-down 0.2s ease-out',\n\t\t\t\t'accordion-up': 'accordion-up 0.2s ease-out',\n\t\t\t\t'slide-in-bottom': 'slide-in-bottom 0.3s ease-out',\n\t\t\t\t'slide-up': 'slide-up 0.4s ease-out'\n\t\t\t}\n\t\t}\n\t},\n\tplugins: [require(\"tailwindcss-animate\")],\n} satisfies Config;\n","usedDeprecatedRules":[]},{"filePath":"/Users/taytemiz/Desktop/Lumiso/vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]